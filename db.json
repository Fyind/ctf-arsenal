{"meta":{"version":1,"warehouse":"5.0.1"},"models":{"Asset":[{"_id":"node_modules/hexo-theme-shokax/source/assets/404.png","path":"assets/404.png","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-shokax/source/assets/algolia_logo.svg","path":"assets/algolia_logo.svg","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-shokax/source/assets/apple-touch-icon.png","path":"assets/apple-touch-icon.png","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-shokax/source/assets/failure.ico","path":"assets/failure.ico","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-shokax/source/assets/favicon.ico","path":"assets/favicon.ico","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-shokax/source/assets/logo.svg","path":"assets/logo.svg","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-shokax/source/assets/play_disc.png","path":"assets/play_disc.png","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-shokax/source/assets/search.png","path":"assets/search.png","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-shokax/source/assets/play_needle.png","path":"assets/play_needle.png","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-shokax/source/css/mermaid.styl","path":"css/mermaid.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-shokax/source/css/optimize.styl","path":"css/optimize.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-shokax/source/css/app.styl","path":"css/app.styl","modified":0,"renderable":1}],"Cache":[{"_id":"source/_posts/CTF知识点.md","hash":"7107583a46af0f8828b24343cd45ef8aa5a8331f","modified":1738689144645},{"_id":"source/_posts/E-CTF比赛-Write-Up-md.md","hash":"7250a18450ca567c2797e95695a44992980a73c6","modified":1738689759160},{"_id":"source/_posts/hello-world.md","hash":"acad91ace80b80295b11a9b7ad4c29a2dcfdd8fb","modified":1738689144645},{"_id":"source/_posts/x3ctf2025 Write Up.md","hash":"e1cce30ff7d86d86caa3ef82a234a8a02d8782eb","modified":1738689144645},{"_id":"source/_posts/哈希长度与碰撞情况.md","hash":"010ca0b9d34678028bee3098460dde78e7b8bcdb","modified":1738689144646},{"_id":"source/_posts/逆向工程/31f160e7596c17139883c26175af9d24.webp","hash":"85a0932ef00c81b2848c8f926ecc33ff71b75c22","modified":1738689144646},{"_id":"source/_posts/逆向工程.md","hash":"9cc7a011bd233abb3540ec9b5967c07f4320ee37","modified":1738689144646},{"_id":"source/_posts/逆向工程/a3a1c2a23cadd179ee2a5d6c81e3adb2.webp","hash":"4574006136eb16325658f72f1ae2a151e408f457","modified":1738689144647},{"_id":"source/_posts/逆向工程/image-20240811135822371.png","hash":"74ea5f823a29259a429c7541fe7129ba1719690c","modified":1738689144649},{"_id":"source/_posts/逆向工程/image-20240811144327614.png","hash":"93259618ea6f7cf435d33f1083316cd4de910cf2","modified":1738689144650},{"_id":"source/_posts/逆向工程/image-20240811140259142.png","hash":"4c8c3fc575d56bc8eadeb0a294005b582e638362","modified":1738689144649},{"_id":"source/_posts/逆向工程/image-20240929112232598.png","hash":"1bb20fce44de70023deed3c7af700ec365bb8a30","modified":1738689144651},{"_id":"source/_posts/逆向工程/image-20240929130135608.png","hash":"f1993837c609e3fdb7868bbb0c066c7d2bade824","modified":1738689144654},{"_id":"source/_posts/逆向工程/image-20240930190521829.png","hash":"e6a1213dff1b730e63e2eeef56ed3710fc14038e","modified":1738689144654},{"_id":"source/_posts/逆向工程/image-20240929113449816.png","hash":"cd62f0b8c2096da003d9410ed52288316b7ae68e","modified":1738689144652},{"_id":"source/_posts/逆向工程/c45b801d423975f7a189ebf3b9e8db1.png","hash":"baf099447b1cf588baff424989f5fd976b1f95aa","modified":1738689144647},{"_id":"source/_posts/逆向工程/image-20240811072446821.png","hash":"a0e3a443d55bf124dee216188615dfee518b8662","modified":1738689144649},{"_id":"source/_posts/逆向工程/image-20240929110715802.png","hash":"03ba91e99ea637f3726bbefb6e594bb0a773a1c3","modified":1738689144651},{"_id":"source/_posts/逆向工程/image-20240929110409063.png","hash":"ba54c35559482d80df88a15612dec90f9f7f80ab","modified":1738689144650},{"_id":"source/_posts/逆向工程/image-20240930191508047.png","hash":"f5a222e2ff1655159059d9b15b091e9d6bad8a11","modified":1738689144655},{"_id":"source/_posts/逆向工程/image-20240929115846957.png","hash":"1da2983c581f21800d8599d239d9f55d29f25eb1","modified":1738689144653},{"_id":"source/_posts/逆向工程/image-20240929125830292.png","hash":"0d6f8ed882355f5705d6c74d7d05e5d8907cc8b1","modified":1738689144654},{"_id":"node_modules/hexo-theme-shokax/.gitattribute","hash":"adcfd68174d69ed48b07c8f097cb3bc255bdb171","modified":1738689668494},{"_id":"node_modules/hexo-theme-shokax/LICENSE","hash":"1a960338f6de74d2cc21a396f082d5e3d38ce484","modified":1738689668518},{"_id":"node_modules/hexo-theme-shokax/CODE_OF_CONDUCT.md","hash":"9a161bc78bd0980922a85c8fbd528a2dca59c708","modified":1738689668625},{"_id":"node_modules/hexo-theme-shokax/README.md","hash":"78420616241923178f26680f429a1062db93add7","modified":1738689668637},{"_id":"node_modules/hexo-theme-shokax/README_en.MD","hash":"10b8cc963b0a2f4fa50eb1f40650141ebd593af6","modified":1738689668627},{"_id":"node_modules/hexo-theme-shokax/LICENSE-shoka","hash":"c31a20c3f55e01d16667dfe9cae313e01e70cf85","modified":1738689668527},{"_id":"node_modules/hexo-theme-shokax/_config.yml","hash":"540b45786b7f8a55c01859b82e2b9277b0ae53dc","modified":1738689668885},{"_id":"node_modules/hexo-theme-shokax/UsageRestrictions.md","hash":"3985a7e07a01d3bff329c8c6977ccb6ed9a28320","modified":1738689668639},{"_id":"node_modules/hexo-theme-shokax/layout/archive.pug","hash":"0b62c66f9974c7d057600efbc6ac2a2565d955d3","modified":1738689668671},{"_id":"node_modules/hexo-theme-shokax/eslint.config.mjs","hash":"c6c62031de017b00ff650dc95a1c271d61a06921","modified":1738689668644},{"_id":"node_modules/hexo-theme-shokax/_images.yml","hash":"8ebdf56a9fc759d7a2369ec7700fc17bb4314238","modified":1738689668886},{"_id":"node_modules/hexo-theme-shokax/layout/category.pug","hash":"df7e165be7e71b4fbcfc691865385a6347507ef6","modified":1738689668676},{"_id":"node_modules/hexo-theme-shokax/layout/page.pug","hash":"06589ea73415f964a8bb3803ed06ab41abb20e6c","modified":1738689668700},{"_id":"node_modules/hexo-theme-shokax/layout/index.pug","hash":"d782b5432c123404d8a291c674cbf18280eefd3d","modified":1738689668691},{"_id":"node_modules/hexo-theme-shokax/layout/post.pug","hash":"5d17580f57a77067f2a53e609e7a4b1607ab56c9","modified":1738689668703},{"_id":"node_modules/hexo-theme-shokax/layout/tag.pug","hash":"9b5f9b5b52fb8702a0c6703581c2c3a1d6be5f2f","modified":1738689668713},{"_id":"node_modules/hexo-theme-shokax/languages/README.md","hash":"121a3ffd4db36ca68a52214b292110e589c068de","modified":1738689668635},{"_id":"node_modules/hexo-theme-shokax/languages/default.yml","hash":"9107d4b03be45561a407981dd08f49816963e365","modified":1738689668888},{"_id":"node_modules/hexo-theme-shokax/languages/en.yml","hash":"341f4d94bf4e3ada7cc225f5d5e63cabf69db8d0","modified":1738689668889},{"_id":"node_modules/hexo-theme-shokax/languages/ja.yml","hash":"d60dbcc68dcb63e493afbef091cb02c37d92cb00","modified":1738689668889},{"_id":"node_modules/hexo-theme-shokax/languages/zh-CN.yml","hash":"24e54af0fc4bd9ceb136fe81ef42c2c69510d5a5","modified":1738689668892},{"_id":"node_modules/hexo-theme-shokax/languages/zh-HK.yml","hash":"a1889b19223bfa9f54e345ea11f571fb723fb9df","modified":1738689668893},{"_id":"node_modules/hexo-theme-shokax/languages/zh-TW.yml","hash":"28c498edb991bfa13cabdd855743c35e4d7dbbd4","modified":1738689668894},{"_id":"node_modules/hexo-theme-shokax/scripts/libtypes.d.js","hash":"6cd6f295cfbc4d184d509e44d279fc54f694f812","modified":1738689668596},{"_id":"node_modules/hexo-theme-shokax/scripts/utils.js","hash":"90da3a0d98f8e11a6638b8fe99ee6e0d73e2b00d","modified":1738689668621},{"_id":"node_modules/hexo-theme-shokax/toolbox/compiler.mjs","hash":"22bda16a5e9b35e791fe4c40510431d5e033843a","modified":1738689668642},{"_id":"node_modules/hexo-theme-shokax/layout/_alternate/atom.ejs","hash":"a6fb8e680260be4c7008a64b9ddfb0dd65970e6f","modified":1738689668535},{"_id":"node_modules/hexo-theme-shokax/toolbox/hoistdep.mjs","hash":"17ea4c0f84a91d16b5882ea0ae51249dd1af05d7","modified":1738689668645},{"_id":"node_modules/hexo-theme-shokax/layout/_alternate/json.ejs","hash":"de4dbeb77ddfccd15158c68c904bae37edbe68dd","modified":1738689668539},{"_id":"node_modules/hexo-theme-shokax/toolbox/lib.mjs","hash":"885f6d14122d9a8dcc46434c93f7f656df6a9326","modified":1738689668647},{"_id":"node_modules/hexo-theme-shokax/layout/_alternate/rss.ejs","hash":"5ad1cf37054905116251223c0e1260cab389dde8","modified":1738689668544},{"_id":"node_modules/hexo-theme-shokax/layout/_mixin/breadcrumb.pug","hash":"e08b873a353ee96bd40db95447b9d2e04694c19c","modified":1738689668674},{"_id":"node_modules/hexo-theme-shokax/layout/_mixin/card.pug","hash":"e94c692d7fe9048abaf8b8dacb495955761eac95","modified":1738689668675},{"_id":"node_modules/hexo-theme-shokax/layout/_mixin/comment.pug","hash":"5611fb15343ba526050529e1a2e74c9d2a94888d","modified":1738689668678},{"_id":"node_modules/hexo-theme-shokax/layout/_mixin/postmeta.pug","hash":"842eb5140615f6f1450fcedfa2eceba333482005","modified":1738689668703},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/footer.pug","hash":"abb867ea6ab045ee09b2a70cc597569f88c5758a","modified":1738689668684},{"_id":"node_modules/hexo-theme-shokax/layout/_mixin/segment.pug","hash":"1e1296c00a5d0c0aafdf97fe7e60239e0a8d1052","modified":1738689668708},{"_id":"node_modules/hexo-theme-shokax/package.json","hash":"4d1aca83faaa6549b94abdddd4eb19c3f0776c48","modified":1738689668623},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/header.pug","hash":"5815e85131ee568bef7acb9307956f71e7bbc7b7","modified":1738689668690},{"_id":"node_modules/hexo-theme-shokax/layout/_mixin/widgets.pug","hash":"efa7457a89b6e4231876ee2864b9f6e32b52ce52","modified":1738689668714},{"_id":"node_modules/hexo-theme-shokax/layout/_mixin/sidebar.pug","hash":"07bfd811ebfed109ea5b5821f2f8fc74e6f5bc20","modified":1738689668711},{"_id":"node_modules/hexo-theme-shokax/scripts/filters/locals.js","hash":"0c4051c258719149e3d615aa72e07055f0d670b6","modified":1738689668604},{"_id":"node_modules/hexo-theme-shokax/scripts/filters/post.js","hash":"f92e3c0bbd95b6e0796c84e9b30e29db542ad19e","modified":1738689707536},{"_id":"node_modules/hexo-theme-shokax/scripts/generaters/archive.js","hash":"12ec1e7448575df98608899047b134172fe8e1c9","modified":1738689668561},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/layout.pug","hash":"f81eb4035666ec816db6b3de3950cb15eecc1fc3","modified":1738689668693},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/pagination.pug","hash":"a9d828027fced2ff24eebeddfd2b04c403041ee1","modified":1738689668701},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/loading.pug","hash":"a23fc6e2fa273dd97a5284abf101a3fa6383027f","modified":1738689668694},{"_id":"node_modules/hexo-theme-shokax/scripts/generaters/images.js","hash":"1c0f9a449d4f8a5df3261d5602582fae1dfd6525","modified":1738689668583},{"_id":"node_modules/hexo-theme-shokax/scripts/generaters/config.js","hash":"015225b6cc34f95675bc05e83d14f59aa369e151","modified":1738689668578},{"_id":"node_modules/hexo-theme-shokax/scripts/generaters/pages.js","hash":"4f4dfa56251eb7d0feacbefe7543a9197a3c6b2f","modified":1738689668610},{"_id":"node_modules/hexo-theme-shokax/scripts/helpers/engine.js","hash":"a7c5e445b9adc819241d7ee929cb8dd782f44496","modified":1738689668581},{"_id":"node_modules/hexo-theme-shokax/scripts/generaters/index.js","hash":"acef3f2e1e7ec3a6e247ba10d64d3cd259f77f2e","modified":1738689668585},{"_id":"node_modules/hexo-theme-shokax/scripts/helpers/asset.js","hash":"579ded0b200b3ef8d9133c2c25994485fa6c6454","modified":1738689668570},{"_id":"node_modules/hexo-theme-shokax/scripts/generaters/script.js","hash":"58df20178082f9855d6942be4c98f179c405186a","modified":1738689668615},{"_id":"node_modules/hexo-theme-shokax/scripts/helpers/list_categories.js","hash":"ba3eeba0c30fe44f237e2e4d7ee41d3066a73298","modified":1738689668600},{"_id":"node_modules/hexo-theme-shokax/scripts/helpers/symbols_count_time.js","hash":"2c887ef3a311dfe7e0d6505e56ee46d73cd9668c","modified":1738689668620},{"_id":"node_modules/hexo-theme-shokax/scripts/helpers/summary_ai.js","hash":"744668f808a22dad01592c770d9630f64c05856c","modified":1738689668617},{"_id":"node_modules/hexo-theme-shokax/scripts/plugin/index.js","hash":"e36a1f44c4c614c48c0cfa315dae03caeb01909b","modified":1738689668588},{"_id":"node_modules/hexo-theme-shokax/scripts/tags/links.js","hash":"ecdf27eb484ea5607fa711b68fc9cb70b844f681","modified":1738689668599},{"_id":"node_modules/hexo-theme-shokax/scripts/tags/media.js","hash":"78fb015bcc470d2f37d69dc42f0d4ed8e43ddec5","modified":1738689668606},{"_id":"node_modules/hexo-theme-shokax/source/assets/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1738689668844},{"_id":"node_modules/hexo-theme-shokax/source/assets/404.png","hash":"b7b18f6689d0a14041d87bab6c4e4ce567249d01","modified":1738689668657},{"_id":"node_modules/hexo-theme-shokax/scripts/plugin/check.js","hash":"f69c5af9cfcb0ca8b3d92e22c0eb4753a180d30c","modified":1738689668575},{"_id":"node_modules/hexo-theme-shokax/source/assets/apple-touch-icon.png","hash":"d4e5d65ff663cb71f43515e68d757cbae1ceb3ec","modified":1738689668662},{"_id":"node_modules/hexo-theme-shokax/source/assets/favicon.ico","hash":"8ae48d9e33b7593cd005aae88b755aa9ce129f0e","modified":1738689668556},{"_id":"node_modules/hexo-theme-shokax/source/assets/failure.ico","hash":"5eec5c163400d8ece74286da49130da1ead3f6f6","modified":1738689668551},{"_id":"node_modules/hexo-theme-shokax/source/assets/logo.svg","hash":"48014a7148fde766848eb4701c8df421a17cb74b","modified":1738689668845},{"_id":"node_modules/hexo-theme-shokax/source/assets/play_disc.png","hash":"3cfa8dd2e12424c52d1f5e34e9502e446fecde9c","modified":1738689668664},{"_id":"node_modules/hexo-theme-shokax/source/css/_colors.styl","hash":"a97005fbb942d9a6457d88db6c48e4b5a7f712d9","modified":1738689668716},{"_id":"node_modules/hexo-theme-shokax/source/css/_iconfont.styl","hash":"625f01fbd835890e98f5faa45a2de6747e1dee51","modified":1738689668717},{"_id":"node_modules/hexo-theme-shokax/source/assets/play_needle.png","hash":"e0998828ab50ce37617f9f4d46b74648206ac852","modified":1738689668665},{"_id":"node_modules/hexo-theme-shokax/source/assets/search.png","hash":"08c4f6a7a92eff3548aec94b267a23a25e6bd215","modified":1738689668669},{"_id":"node_modules/hexo-theme-shokax/source/css/_mixins.styl","hash":"e3625fccd4f2c56bcdcded26bde3faeb562b2e4c","modified":1738689668718},{"_id":"node_modules/hexo-theme-shokax/source/css/_variables.styl","hash":"6f560b2108ba82507cc03605122bc5bfe679ff00","modified":1738689668719},{"_id":"node_modules/hexo-theme-shokax/source/css/mermaid.styl","hash":"7720ca8fc84b975d95fd11d7971f125aa3062a23","modified":1738689668768},{"_id":"node_modules/hexo-theme-shokax/source/css/optimize.styl","hash":"b026fbdce6f5353eea1f967ea66e90db0dd8d16e","modified":1738689668775},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/head/head.pug","hash":"a7839e61648f3a2080e24726fc8089a4bc1a6ff4","modified":1738689668689},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/head/head_com.pug","hash":"64741be7e14c1bffa5884a3a0fc59ff23c681e7b","modified":1738689668687},{"_id":"node_modules/hexo-theme-shokax/source/css/app.styl","hash":"0eb099a815d33777be4c1ddb667d2d839e03e0a8","modified":1738689668722},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/head/pwa.pug","hash":"e28dc93f3a7de34855191202689daf6c416e567c","modified":1738689668705},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/post/footer.pug","hash":"1f317296b0d5cbe2fe75a43bbe1bc018bcffd6cd","modified":1738689668685},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/post/post.pug","hash":"f8fb3595df42c54e68ff088e57ce4c683f06aaf5","modified":1738689668702},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/post/nav.pug","hash":"e4cb6ded6c58361dae88f3b9ec4264b49678c445","modified":1738689668696},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/post/reward.pug","hash":"2a851ba271d6333bc9a22681e4e73586ca4a83a3","modified":1738689668707},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/sidebar/menu.pug","hash":"bb644e46a2d7a28d6068cb03d10eaf1523300c6a","modified":1738689668695},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/sidebar/overview.pug","hash":"94a3486e07a07e6cf89d0c2229f69e372f38dbb6","modified":1738689668699},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/post/copyright.pug","hash":"920da1f462698b1f3920aaee3d294deaaff60dc5","modified":1738689668679},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/third-party/baidu-analytics.pug","hash":"cabc346c366491225a5f56aedb7c8e7ee796aba1","modified":1738689668672},{"_id":"node_modules/hexo-theme-shokax/scripts/plugin/lib/injects-point.js","hash":"41103b6c06a1cfac93ef11ab9d108d2f7c6e37a7","modified":1738689668591},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/third-party/google-analytics.pug","hash":"c243ade48130addad967113d95df1ea16811d134","modified":1738689668686},{"_id":"node_modules/hexo-theme-shokax/layout/_partials/third-party/clarity.pug","hash":"0cce9276ad62dc51a7402a65dc2d665c120daf20","modified":1738689668677},{"_id":"node_modules/hexo-theme-shokax/scripts/plugin/lib/injects.js","hash":"6c4b0ac30ad9e9fc6b4c78e4aa0396dc07a4665b","modified":1738689668593},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/player.ts","hash":"8ba83066a6541bd011c1e704b81078833f3a0988","modified":1738689668866},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/scaffolding/animate.styl","hash":"f3ffeef9c0f71005ccaf2f6035f4297ddce977b6","modified":1738689668721},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/scaffolding/base.styl","hash":"b5640f3aac46e7a432f5803835664ef37192a3db","modified":1738689668725},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/components.styl","hash":"1abcd0854142d1415af647c3d6b5d33de505d00d","modified":1738689668739},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/scaffolding/buttons.styl","hash":"aab14e7fe7c466576b3d70c741d2526364d07874","modified":1738689668730},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/scaffolding/divider.styl","hash":"c2dfeadb72a7c898a455e163f11ee17c6b3941bb","modified":1738689668740},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/scaffolding/iconfont.styl","hash":"45d1f2d09e3769ffe8d371a314d345b70b00015a","modified":1738689668752},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/scaffolding/pagination.styl","hash":"7632764beb8d937ec6a4dcf08a9b5e9a2d904845","modified":1738689668782},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/scaffolding/normalize.styl","hash":"c423809c871d3cd51a931bce1d8f6cd7adebae1d","modified":1738689668771},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/scaffolding/ribbon.styl","hash":"3ccaed5ca1497c0b6eeaaafb777db9c67ce2121e","modified":1738689668798},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/scaffolding/scrollbar.styl","hash":"0b65e121550b1c816e021f23a54f161a30ab29a2","modified":1738689668810},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/mobile.styl","hash":"3dd4a95737f28d93f18b5c1fdd4ab9675871e89b","modified":1738689668770},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/scaffolding/tip.styl","hash":"0247e72526f99d92b2d44c15aa626742873caa3c","modified":1738689668839},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/scaffolding/tables.styl","hash":"64e746ba8498b407cb122ea8f0c0f82108388e12","modified":1738689668827},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/scaffolding/toggles.styl","hash":"939e93f1b5aa44023fc7bb71dfca55601c0a9af3","modified":1738689668840},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/outline.styl","hash":"3dc04b7a55c4f0102d64f9ad0834e1155b3240de","modified":1738689668777},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/scaffolding/scaffolding.styl","hash":"2a54e8ddf6cf14fec00b010d5ced577670bd8027","modified":1738689668806},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/components/cloudflare.ts","hash":"2ccc757ef36e6cccb57e2fe4913f595b41cd6e38","modified":1738689668849},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/globals/globalVars.ts","hash":"39e7429f30ea4d44b84e6288694b8574ee6b7b88","modified":1738689668860},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/components/comments.ts","hash":"14aa3bb928f53b559eec53a7b999aa6e126ac0b5","modified":1738689668851},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/components/sidebar.ts","hash":"07a410ab6804c7d2483c52f7e192a1ddb4c2b92e","modified":1738689668875},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/globals/themeColor.ts","hash":"74f7edecbb68ab971253d1ebd7176a2898ef8fe0","modified":1738689668881},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/components/tcomments.ts","hash":"74e98cff7bb86afeef5e4bf036bdc2a3dc24d8a3","modified":1738689668880},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/pjax/domInit.ts","hash":"e23c5d28cd00efd5060caeafb8b05312b3624b40","modified":1738689668856},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/globals/handles.ts","hash":"3ea85dae88170f83d051ba8143a23e4257867850","modified":1738689668861},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/pjax/refresh.ts","hash":"0490734d0b40327c6082b421dc72ba7453a1dc13","modified":1738689668871},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/globals/thirdparty.ts","hash":"b17a7cfdc4af9dafabf6df9c7f6d6b14b25916a0","modified":1738689668882},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/pjax/siteInit.ts","hash":"ba0e9ff5010774ff0a070df0397c407f9d24d184","modified":1738689668877},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/globals/tools.ts","hash":"bc2bfc99d9e29ceba932793b8150cfcfd1c88837","modified":1738689668882},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/library/anime.ts","hash":"527d27d3b6c0e4aa9bf8f9efa79f6372e9daff19","modified":1738689668847},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/library/dom.ts","hash":"22b978fbddc601af5b554758b75465a143588f1d","modified":1738689668854},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/library/proto.ts","hash":"a79b182d1cf767b50e98265eda7e322e958a0827","modified":1738689668870},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/library/declare.d.ts","hash":"c047432d23312700f7044b31a3819e64c2d0838c","modified":1738689668854},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/library/loadFile.ts","hash":"63021f67460c2b62e48806ecd5e4365a3636b8e5","modified":1738689668863},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/library/scriptPjax.ts","hash":"5c6b5addca0b080e824aea99208c113ca0a44a15","modified":1738689668873},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/page/fancybox.ts","hash":"79730b8c9b4a6a6ce81305e2276ca6530c8a1a87","modified":1738689668857},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/page/common.ts","hash":"73f7cdd3824851849620d0a15fa3b6f983cf8e68","modified":1738689668853},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/library/vue.ts","hash":"730ec234879e77ff1e2bb912cd8a6ea0f60459d1","modified":1738689668883},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/page/post.ts","hash":"067b4553afae2a061d7203507456c8072eea64e9","modified":1738689668869},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/page/search.ts","hash":"b620e0c2e70506a4517c37bfeddb89e3bd369630","modified":1738689668874},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/library/storage.ts","hash":"b1f08ededd7f09da3c14741cffe24223a957df75","modified":1738689668878},{"_id":"node_modules/hexo-theme-shokax/source/js/_app/page/tab.ts","hash":"ffe629ecf20ebf4302cd0306b14408f8579249a9","modified":1738689668879},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/post/breadcrumb.styl","hash":"8ad2d737bb08f6497e2f1971abb5b3c2d8d80aee","modified":1738689668729},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/post/footer.styl","hash":"1a3c59e40bdeef1edc6de64aa722fad4011fd0d8","modified":1738689668743},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/post/copyright.styl","hash":"c5f9fd384e5682eea88258a2307b4bc8875cfb5c","modified":1738689668739},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/post/nav.styl","hash":"fe1a4e5301cddace3104eda8f17dfeea3afc7df8","modified":1738689668771},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/post/header.styl","hash":"0309d9d3a2c7a511faf2b0881932b4bac7144e25","modified":1738689668748},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/post/expand.styl","hash":"f4782d4738914da81d845b776f298064c73523c3","modified":1738689668741},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/post/post.styl","hash":"0861df864b8afb32fb8160d25e5c9d63adccbf3c","modified":1738689668789},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/post/reward.styl","hash":"3a4f5c15bee5da47bc914550439d26c80549df13","modified":1738689668797},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/post/tags.styl","hash":"b286514d99e222af34d2263d3e87e68d57958bcf","modified":1738689668833},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/tags/collapse.styl","hash":"aae4f6d940ce0c52595bda79c4f7b5231ec9e35f","modified":1738689668738},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/post/rtl.styl","hash":"d909dcbc0e61358a5804161470ac9064049f1a36","modified":1738689668803},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/tags/container.styl","hash":"6b157b774e634c0c031bab392031df0996f0a62c","modified":1738689668739},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/tags/label.styl","hash":"f7976cbdc69b577264f1737f1d2bd8996ed72a46","modified":1738689668754},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/tags/links.styl","hash":"d90e56e9b21b15af5b78f824b033e52b13383fec","modified":1738689668755},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/tags/note.styl","hash":"f358448cfe80b9641492dacc1e5c9027f6a6165f","modified":1738689668773},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/tags/list.styl","hash":"47e91f89615c1a9744358140314739b4074c315b","modified":1738689668757},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/tags/player.styl","hash":"099cc07173552d5bd71002bcafcdcf04706a9a40","modified":1738689668786},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/third-party/loading.styl","hash":"551c60b7597160aaebe9f7b0c2efc5b1f5aad124","modified":1738689668759},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/third-party/pace.styl","hash":"15371614ff30edb87768bce771aecc6fc99f17a4","modified":1738689668778},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/third-party/search.styl","hash":"3e08bda491be537df401a9c616697e508c56c1d6","modified":1738689668812},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/third-party/theme.styl","hash":"8db8b71c85ca3622a2b0580144a61ffdcd23b818","modified":1738689668836},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/tags/quiz.styl","hash":"da9af203397894b4010fb4a8ace58bba6b9891a3","modified":1738689668792},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/third-party/third-party.styl","hash":"b496991b13c1c48972addf19f0a5ba9ab6887f8a","modified":1738689668838},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/third-party/widgets.styl","hash":"cdbd2b2d8d76216de2753c44eee3f134a81332c0","modified":1738689668843},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/highlight/highlight.styl","hash":"2b99053eb1acb3005b7cb15bddfa6015f4651a0d","modified":1738689668751},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/highlight/operation.styl","hash":"a231b09682dedd2c5aae41995d2e7292ffc2cf9b","modified":1738689668774},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/header/brand.styl","hash":"907482ef812c0c6bfe0aa97bda5b615e5d866364","modified":1738689668728},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/header/header.styl","hash":"add1fac280fb8dd2158799ca125f762f4a4b7996","modified":1738689668749},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/tags/tags.styl","hash":"b397ce0eb2bec9dcc2e6f7f770ea351eba0b3403","modified":1738689668835},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/header/image.styl","hash":"f6d7b4cf4fd8e49cd75fc04c562817ce9b9f64a1","modified":1738689668753},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/tags/tabs.styl","hash":"b92cdc89b17e38bc47f69ea6e16205ffa0cd5653","modified":1738689668831},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/header/menu.styl","hash":"b7afe5c76314d61fc69b62dbeb4717058484b0d9","modified":1738689668761},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/header/nav.styl","hash":"f83888a890fc4ebdf466e085f629d7da12c1edca","modified":1738689668771},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/pages/collapse.styl","hash":"6706bdf8e3124cd786e628602bb8078cfe302a4b","modified":1738689668735},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/header/right.styl","hash":"eace1eeb80bb6af6a87735d5adf0b1a9c4cc8ada","modified":1738689668801},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/header/tool.styl","hash":"4c90c6c5daee084b8741c106012618fe9f7dbd23","modified":1738689668841},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/header/waves.styl","hash":"ad33fe4e05e8c2c21972422f560c74de5ba9a6f2","modified":1738689668842},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/pages/home.styl","hash":"966540c96c6e18574614b0124e3ebce8e11dc615","modified":1738689668752},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/sidebar/author.styl","hash":"213ef686a2ccdb93c69a30cb453afcc6a1b4ac18","modified":1738689668724},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/sidebar/dimmer.styl","hash":"373baf0c5e50363e7c60c53ccfed32ef565c38c7","modified":1738689668740},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/pages/tag-cloud.styl","hash":"a890a98b78270e32990604dcd34e8f5cd5aca036","modified":1738689668832},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/sidebar/menu.styl","hash":"52f318a35ffe38657fbe23e5ef3f7433bf11dadc","modified":1738689668763},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/pages/pages.styl","hash":"59dd554d4c2c8c45f6b7bb348f85bc563122c80c","modified":1738689668780},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/sidebar/quick.styl","hash":"51460acc4321c8f7c7b4e4ce37cb3b4c1c03591f","modified":1738689668790},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/sidebar/sidebar.styl","hash":"f420911773d02c7dbe32f7ab9bd79e2d4d65275e","modified":1738689668817},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/sidebar/related.styl","hash":"71496a1be370db66843e2661e5594a6a1898c3c6","modified":1738689668795},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/sidebar/social.styl","hash":"4854aec659aac752b60836eef4aeae0e1312ff82","modified":1738689668819},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/footer/footer.styl","hash":"f557495345ae0a538ec5661daa7fc20be27c33b3","modified":1738689668746},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/sidebar/tab.styl","hash":"b5cdc568942810a6ba70ee5a5048188303f8b956","modified":1738689668826},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/third-party/mermaid/class.styl","hash":"e942b2308a788865b451fbc2cf1718dcdf93299e","modified":1738689668732},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/sidebar/state.styl","hash":"e54b26894d3c63032b9be7d7e0f63feb3bd3a20a","modified":1738689668822},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/outline/sidebar/toc.styl","hash":"e431443ddfc83aa39dd28e3ce645529694a3e266","modified":1738689668839},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/third-party/mermaid/gantt.styl","hash":"61c66a462b78a836226a2d8debb945aa5b3b3429","modified":1738689668746},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/third-party/mermaid/flowchart.styl","hash":"85f5d3f3da9d86fcf9999f3af1e1b837d55206af","modified":1738689668743},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/third-party/mermaid/pie.styl","hash":"8da616dcd22b4f2619d817b0cf4986d0aa66954d","modified":1738689668783},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/third-party/mermaid/state.styl","hash":"5c03ccd22355e159169c341616b2e157516825a3","modified":1738689668821},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/third-party/mermaid/sequence.styl","hash":"8630ac2eb00713109d885143b9d0776d1e8a6e1c","modified":1738689668815},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/third-party/mermaid/mermaid.styl","hash":"4dc498f13fb656711d5e2acc9b6d48cbdd747609","modified":1738689668766},{"_id":"node_modules/hexo-theme-shokax/source/css/_common/components/third-party/mermaid/git.styl","hash":"19b6b3c75dac1426d75c81fa1bf0da7482fcde96","modified":1738689668747},{"_id":"public/tag/ctf文章/rss.xml","hash":"e1073da30262543a19f5516bbcb628708caed682","modified":1738689797659},{"_id":"public/rss.xml","hash":"d3ae840c897655bf9b03c17da1e8cb76be799bbc","modified":1738689797659},{"_id":"public/tag/ctf文章/atom.xml","hash":"0945d528621f9019c41d8c115e6757f2de329c93","modified":1738689797659},{"_id":"public/tag/ctf文章/feed.json","hash":"ffd83abb153e896f6012b2ab3e9d57f0bb27c029","modified":1738689797659},{"_id":"public/atom.xml","hash":"7de6d79c5646ea8fbcd13df244dd9fc6a1c2b882","modified":1738689797659},{"_id":"public/feed.json","hash":"d9f62755f268a93260cb32b3ffa62379f49d1de1","modified":1738689797659},{"_id":"public/js/chunk-3QGRG5LW.js","hash":"971d67fdfc6cca29eac72e5fb203435e34197b1e","modified":1738689797659},{"_id":"public/js/chunk-HLXPYW5A.js","hash":"4a0cf131dd5a5384d33e53808d9b514833f48773","modified":1738689797659},{"_id":"public/js/chunk-3QGRG5LW.js.LEGAL.txt","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1738689797659},{"_id":"public/js/chunk-TBM3W6J5.js","hash":"7b24bd55c0fa21a0de01cabbc677eef6a9f10cb6","modified":1738689797659},{"_id":"public/js/chunk-HLXPYW5A.js.LEGAL.txt","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1738689797659},{"_id":"public/js/chunk-TBM3W6J5.js.LEGAL.txt","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1738689797659},{"_id":"public/js/copy-tex-H35FYUA3.js","hash":"cd29b40cec83118e7a86a30b07ed032630059f2d","modified":1738689797659},{"_id":"public/js/copy-tex-H35FYUA3.js.LEGAL.txt","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1738689797659},{"_id":"public/js/index.esm-YLWCV4AU.js.LEGAL.txt","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1738689797659},{"_id":"public/js/post-LY7JSYLG.js","hash":"fe6af964c855cda43d66697581e021f9650c0d6d","modified":1738689797659},{"_id":"public/js/index.esm-YLWCV4AU.js","hash":"678396b5dca03038f6fd5d0866bf3f9ede3a65b8","modified":1738689797659},{"_id":"public/js/post-LY7JSYLG.js.LEGAL.txt","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1738689797659},{"_id":"public/js/quicklink-PPM66HVF.js.LEGAL.txt","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1738689797659},{"_id":"public/js/quicklink-PPM66HVF.js","hash":"91a7bcbb34879f7e5dbec23576f36dff3a0f768b","modified":1738689797659},{"_id":"public/js/siteInit.js","hash":"fbd42fb68a1017757910729ce1f26773514272f7","modified":1738689797659},{"_id":"public/js/siteInit.js.LEGAL.txt","hash":"81076ae2fc7273708ff25a888ede5b2496d3292d","modified":1738689797659},{"_id":"public/E-CTF比赛-Write-Up-md/index.html","hash":"bb22250e1af90601e1849262b26bf25a9898be0b","modified":1738689797659},{"_id":"public/hello-world/index.html","hash":"c2a6ebc676dc976aaeb8f000646287db63a75458","modified":1738689797659},{"_id":"public/逆向工程/index.html","hash":"0660bf4717fd0c9a4623fcd8d512e256604d13cc","modified":1738689797659},{"_id":"public/哈希长度与碰撞情况/index.html","hash":"3faec90538455e6095542fa06629531cab7561e7","modified":1738689797659},{"_id":"public/x3ctf2025 Write Up/index.html","hash":"2e2f39a740cf040fabb3fc9d816dc77aade1fb4c","modified":1738689797659},{"_id":"public/CTF知识点/index.html","hash":"d87a1a1b84f18009d59c36e5dcafc48e6c8a3ff3","modified":1738689797659},{"_id":"public/archives/index.html","hash":"d9c569961471482cdcb2dcfc3855af03c89e53c2","modified":1738689797659},{"_id":"public/archives/2024/index.html","hash":"9a9d86f3698f2b2f0fb0af5765e222ba09f67628","modified":1738689797659},{"_id":"public/archives/2025/index.html","hash":"b6e360669f72c18781492a54e9476e0b29ef5254","modified":1738689797659},{"_id":"public/archives/2025/02/index.html","hash":"5f1928c1b725a9ae3d76078f524b88abb5938a16","modified":1738689797659},{"_id":"public/tags/CTF文章/index.html","hash":"82ab8ff68751f74ab0d331f7e9a9361848540696","modified":1738689797659},{"_id":"public/categories/index.html","hash":"f5df6c2b8cb322bc4fe992fc8550a136e35f828d","modified":1738689797659},{"_id":"public/index.html","hash":"71ad2a9ef144ace6ae8564db738734cbb0f4583e","modified":1738689797659},{"_id":"public/tags/index.html","hash":"9098981b4e123d507e3255d7cda052df10895631","modified":1738689797659},{"_id":"public/archives/2024/05/index.html","hash":"830eb154f2719d46253da92a914cf6208f37c71c","modified":1738689797659},{"_id":"public/assets/404.png","hash":"b7b18f6689d0a14041d87bab6c4e4ce567249d01","modified":1738689797659},{"_id":"public/assets/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1738689797659},{"_id":"public/assets/apple-touch-icon.png","hash":"d4e5d65ff663cb71f43515e68d757cbae1ceb3ec","modified":1738689797659},{"_id":"public/assets/failure.ico","hash":"5eec5c163400d8ece74286da49130da1ead3f6f6","modified":1738689797659},{"_id":"public/assets/logo.svg","hash":"48014a7148fde766848eb4701c8df421a17cb74b","modified":1738689797659},{"_id":"public/assets/play_disc.png","hash":"3cfa8dd2e12424c52d1f5e34e9502e446fecde9c","modified":1738689797659},{"_id":"public/assets/play_needle.png","hash":"e0998828ab50ce37617f9f4d46b74648206ac852","modified":1738689797659},{"_id":"public/逆向工程/31f160e7596c17139883c26175af9d24.webp","hash":"85a0932ef00c81b2848c8f926ecc33ff71b75c22","modified":1738689797659},{"_id":"public/assets/favicon.ico","hash":"8ae48d9e33b7593cd005aae88b755aa9ce129f0e","modified":1738689797659},{"_id":"public/逆向工程/a3a1c2a23cadd179ee2a5d6c81e3adb2.webp","hash":"4574006136eb16325658f72f1ae2a151e408f457","modified":1738689797659},{"_id":"public/逆向工程/image-20240811140259142.png","hash":"4c8c3fc575d56bc8eadeb0a294005b582e638362","modified":1738689797659},{"_id":"public/assets/search.png","hash":"08c4f6a7a92eff3548aec94b267a23a25e6bd215","modified":1738689797659},{"_id":"public/逆向工程/image-20240811135822371.png","hash":"74ea5f823a29259a429c7541fe7129ba1719690c","modified":1738689797659},{"_id":"public/逆向工程/image-20240811144327614.png","hash":"93259618ea6f7cf435d33f1083316cd4de910cf2","modified":1738689797659},{"_id":"public/逆向工程/image-20240929112232598.png","hash":"1bb20fce44de70023deed3c7af700ec365bb8a30","modified":1738689797659},{"_id":"public/逆向工程/image-20240929113449816.png","hash":"cd62f0b8c2096da003d9410ed52288316b7ae68e","modified":1738689797659},{"_id":"public/逆向工程/image-20240929130135608.png","hash":"f1993837c609e3fdb7868bbb0c066c7d2bade824","modified":1738689797659},{"_id":"public/逆向工程/image-20240930190521829.png","hash":"e6a1213dff1b730e63e2eeef56ed3710fc14038e","modified":1738689797659},{"_id":"public/逆向工程/c45b801d423975f7a189ebf3b9e8db1.png","hash":"baf099447b1cf588baff424989f5fd976b1f95aa","modified":1738689797659},{"_id":"public/逆向工程/image-20240811072446821.png","hash":"a0e3a443d55bf124dee216188615dfee518b8662","modified":1738689797659},{"_id":"public/逆向工程/image-20240929110409063.png","hash":"ba54c35559482d80df88a15612dec90f9f7f80ab","modified":1738689797659},{"_id":"public/逆向工程/image-20240929110715802.png","hash":"03ba91e99ea637f3726bbefb6e594bb0a773a1c3","modified":1738689797659},{"_id":"public/css/optimize.css","hash":"cf89e994c7c45744539ae72a81afa781d0031b8b","modified":1738689797659},{"_id":"public/css/app.css","hash":"c4b74a8ef86002bcfbf45f367e60997ae71bf471","modified":1738689797659},{"_id":"public/css/mermaid.css","hash":"3fe1b97a64b969d4d7a470a4929cb432afefd1bd","modified":1738689797659},{"_id":"public/逆向工程/image-20240930191508047.png","hash":"f5a222e2ff1655159059d9b15b091e9d6bad8a11","modified":1738689797659},{"_id":"public/逆向工程/image-20240929125830292.png","hash":"0d6f8ed882355f5705d6c74d7d05e5d8907cc8b1","modified":1738689797659},{"_id":"public/逆向工程/image-20240929115846957.png","hash":"1da2983c581f21800d8599d239d9f55d29f25eb1","modified":1738689797659}],"Category":[],"Data":[],"Page":[],"Post":[{"title":"CTF知识点","date":"2024-05-14T22:06:29.000Z","_content":"\n### 知识点\n\nhttps://ctf101.org/web-exploitation/overview/\n\nhttps://www.youtube.com/watch?v=5C-OtW7C5oU&t=30s\n\n\n\n\n\nhttps://book.hacktricks.xyz/network-services-pentesting/pentesting-web/flask\n\n### 练习网站\n\nbuuctf\n\nhttps://adworld.xctf.org.cn/\n\nhttps://ctflearn.com/challenge/1/browse\n\nhttps://www.root-me.org/?lang=en\n\nhttps://picoctf.org/\n\n1. tryhackme.com\n2. hackthebox.eu\n3. overthewire.org\n4. Root-me.org\n5. Ringzer0team.com\n6. Hack.me\n7. ctftime.org\n8. picoctf.com\n9. ctf365.com\n10. ctf101.org\n\n### 虚拟机\n\n打开或关闭功能, 打开 Hyper V, 然后重启\n\n下载 kali的Hyper V的Hyper V镜像. 然后双击bat安装. 然后就能打开了,点击连接就有gui\n\n## 文件\n\n### 图片文件处理\n\n打开图片\n\n``` shell\neog xxx.jpg\n```\n\n#### hexdump\n\nhex中查找 string\n\n* pdf里面找隐藏\n\n``` shell\nstrings xxx.jpg | grep CTFlearn \nstrings -n 10 xxx.jpg  # >= 10 长度的字符串\n```\n\nhexdump\n\n``` shell\nhexdump -C Pho.jpg | less\n```\n\npython\n\n``` python\nfile = open(\"TheMessage.txt\", \"r\").read()\nres = \"\"\nfor ch in file:\n\tif ord(ch) == 32:\n\t\tres += \"0\"\n\telse:\n\t\tres += \"1\"\nprint(res)\n```\n\n\n\n### binwalk\n\n``` shell\nbinwalk --dd=.* xx.jpeg # 查看所有隐藏的二进制, DD 可以顺便解压\nbinwalk -e xx.jpg # 提取文件\nfile * # 查看当前目录所有文件类型\nexiftool xx.jpg # 查看更多信息，有file里面没有显示完全的\n```\n\n#### stegehide\n\n``` shell\nsteghide extract -sf xx.jpg\n```\n\n### 二维码\n\n显示二维码\n\n``` shell\nsudo apt install zbar-tools\nzbarimg xx.png\n```\n\npython\n\n``` python\nimport cv2\nimg = cv2.imread(\"qr.png\")\ndet = cv2.QRCodeDetector()\ndata, box, b = det.detectAndDecode(img)\nprint(data)\n```\n\n\n\n## python \n\n### string\n\n所有可打印字符\n\n``` python\nstring.printable\n```\n\n### 提取flag\n\n``` python\nimport re\ndef extract_flag_from_string(string):\n    match = re.search(r'flag\\{[^}]+}', string)\n    return match.group(0) if match else None\n```\n\n### Crypto\n\n``` python\npip install pycryptodome\n```\n\n#### 计算两个byte的xor\n\n``` python\ndef xor(data, key):\n    return bytearray([x ^ y for x,y in zip(data,key)])\n```\n\n### urlencode\n\n``` python\nimport urllib.parse\n# 字典格式的数\ndata = {'name': '张三', 'age': 25}\n# 使用 urlencode 进行编码\nencoded_data = urllib.parse.urlencode(data)\nprint(encoded_data)\n```\n\n\n\n\n\n## Git\n\n查看历史log\n\n``` shell\ngit log\n```\n\n查看commit改变了什么\n\n``` shell\ngit show\n```\n\n## Linux\n\n#### 解压\n\n``` shell\nunzip x.zip\nunrar x x.rar\n```\n\n### 查看ls\n\n打印所有文件夹内容\n\n``` shell\nls -la *\n```\n\n查找\n\n``` shell\nfind / -name *.txt\n```\n\n\n\n\n\n# 密码学\n\nonline的工具\n\nhttps://gchq.github.io/CyberChef/\n\nhttps://www.dcode.fr/en\n\n加密\n\nhttps://www.boxentriq.com/code-breaking/cipher-identifier\n\n### 2进制到hex\n\n``` python\nx = str(hex(int(bc, 2)))[2:]\n```\n\n#### hex转换\n\n``` python\nfrom binascii import unhexlify\nhexstr = \"41 42 43 54 46 7B 34 35 43 31 31 5F 31 35 5F 55 35 33 46 55 4C 7D\"\nhexs = \"\".join(hexstr.split(\" \"))\nprint(unhexlify(hexs.encode()))\n```\n\n#### 输入bytes\n\n``` cpp\ns = \"f\\nk\\fw&O.@\\x11x\\rZ;U\\x11p\\x19F\\x1Fv\\\"M\"\na = bytearray(s.encode())\n```\n\n#### 字符串转换字符数组\n\n``` python\nchar_array = list(\"your_string\")\nstring = ''.join(char_array)\n```\n\n#### 交换大小写\n\n``` python\n\"asb\".swapcase()\n```\n\n`c.isalpha()`：判断 `c` 是否是字母。\n\n`c.isupper()`：判断 `c` 是否是大写字母。\n\n`c.islower()`：判断 `c` 是否是小写字母\n\n### base64\n\nshell\n\n``` shell\nbase64 -d xxx\necho \"c3ludCB2ZiA6IGEwX29icWxfczBldHJnX2RlX3BicXI=\" | base64 -d\n```\n\npython\n\n``` python\nfrom base64 import decodebytes\ns = decodebytes(\"Q1RGe0ZsYWdneVdhZ2d5UmFnZ3l9\".encode())\nprint(s)\n```\n\ncyberchef的label和jump可以实现循环解密\n\n原理：\n\n**将二进制数据转换为 6 位块：**\n\n- 每个字节有 8 位，3 个字节一共是 24 位。\n- 将这 24 位拆分为 4 个 6 位的块。\n\n**将 6 位的数据映射到 Base64 字符表：**\n\n- `A-Za-z0-9+/`\n\n如果输入数据的字节数不是 3 的倍数，编码过程会用 `=` 字符进行填充，使输出数据的长度是 4 字节的倍数。\n\n在后面每次填一个byte(0) 直到是3的倍数，然后base64加密，最后把由加入新0产生的A换成=就好了\n\n``` python\ndef b64en(s, table=\"default\"):\n    if table == \"default\":\n        table = \"\"\n        for i in range(26):\n            table += chr(i + ord('A'))\n        for i in range(26):\n            table += chr(i + ord('a'))\n        for i in range(10):\n            table += chr(i + ord('0'))\n        table += \"+/\"\n    s = s.encode()\n    lens = len(s)\n    s = int.from_bytes(s)\n    s = bin(s)[2:]\n  \n    while len(s) < lens*8:\n        s = \"0\" + s\n    needed = 0\n    while len(s) % 3 != 0:\n        s += \"00000000\"\n        needed += 1\n\n    s = list(map(int,list(s)))\n    i = 0\n    ans = []\n    while i < len(s):\n        x = 0\n        for j in range(6):\n            x = (x<<1) + s[i+j]\n        ans.append(table[x])\n        i += 6\n    for j in range(needed):\n        ans.pop()\n    for j in range(needed):\n        ans += \"=\"\n    return \"\".join(ans)\n\ndef b64de(s, table=\"default\"):\n    if table == \"default\":\n        table = \"\"\n        for i in range(26):\n            table += chr(i + ord('A'))\n        for i in range(26):\n            table += chr(i + ord('a'))\n        for i in range(10):\n            table += chr(i + ord('0'))\n        table += \"+/\"\n    s = list(s)\n    needed = 0\n    while s[-1] == \"=\":\n        s.pop()\n        needed += 1\n    for i in range(needed):\n        s += table[0]\n    a = \"\"\n    for i in range(len(s)):\n        x = table.index(s[i])\n        \n        toa = \"\"\n        for j in range(6):\n            if x>>j&1:\n                toa = \"1\" + toa\n            else:\n                toa = \"0\" + toa\n        \n        a += toa\n\n    a = list(map(int,list(a)))\n    for i in range(needed):\n        for j in range(8):\n            a.pop()\n    i = 0\n    ans = []\n    while i < len(a):\n        x = 0\n        for j in range(8):\n            x = (x<<1) + a[i+j]\n        ans.append(chr(x))\n        i += 8\n\n    ans = ''.join(ans)\n    return ans\n```\n\n\n\n#### DTMF 声调\n\nhttps://dtmf.netlify.app/\n\n## 不同种类的密码\n\n#### Vigenere Cipher\n\n一种凯撒密码\n\nkey 是 `OCU` 那么第一个字符被移动了 O (14)次，第二个字符被移动了 `C` (2) 次\n\n#### CAESAR Cipher\n\n在线暴力破解\n\nhttps://www.dcode.fr/caesar-cipher\n\n#### keyboard shift\n\n`BUH'tdy,|Bim5y~Bdt76yQ` 长这样, 有可能下划线不被解密\n\nhttps://www.dcode.fr/keyboard-shift-cipher\n\n#### bacon cipher\n\n\n\n#### 与佛论禅\n\nhttps://www.keyfc.net/bbs/tools/tudoucode.aspx\n\n密语是`佛曰：` 开头的\n\n#### rot13\n\nhttps://www.rot13.de/index.php\n\n\n\n### enigma cryptogarphy\n\nhttps://cryptii.com/pipes/enigma-machine\n\n#### Playfair cipher\n\n通常有一个表格表示密钥\n$$\n\\begin{array}{lllll}\nQ & W & E & R & T \\\\\nY & U & I & O & P \\\\\nA & S & D & F & G \\\\\nH & K & L & Z & X \\\\\nC & V & B & N & M\n\\end{array}\n$$\nhttps://www.boxentriq.com/code-breaking/playfair-cipher\n\n### brute force\n\n暴力key的长度，然后暴力，使得xor后的string有 `flag` \n\n\n\n#### sha1\n\n这个里面的 `0x8004u`就是sha1加密的标志\n\nhttp://www.ttmd5.com/hash.php?type=5\n\n#### Md5\n\n这个里面的 `0x8003u`就是sha1加密的标志\n\nhttps://hashes.com/en/decrypt/hash\n\nhttps://md5.gromweb.com/?md5=b74dec4f39d35b6a2e6c48e637c8aedb\n\nhttps://www.somd5.com/\n\n可以直接google MD5值, 看有没有解密\n\n\n\n### Discrete logarithm\n\n如果 $p-1$ 的质数分解比较小，那么可以解出来\n\nhttps://github.com/idekctf/idekctf-2024/blob/main/crypto/goldenticket/debug/solve.py\n\nsage 有一个函数 `discrete_log_lambda` 可以对一个区间计算答案，复杂度是 $O(\\sqrt{len})$ 级别, 之后再用CRT合并出大答案\n\n``` py\ndef PH_partial(h, g, p, fact_phi):\n    \"\"\"Returns (x, m), where\n    - x is the dlog of h in base g, mod m\n    - m = lcm(pi^ei) for (pi, ei) in fact_phi\n    \"\"\"\n    res = []\n    mod = []\n    F = GF(p)\n\n    phi = p-1\n    for pi, ei in fact_phi:\n        gi = pow(g, phi//(pi**ei), p)\n        hi = pow(h, phi//(pi**ei), p)\n        xi = discrete_log_lambda(F(hi), F(gi), bounds = (0, pi**ei))\n        res.append(int(xi))\n        mod.append(int(pi**ei))\n\n    x, m = CRT(res, mod), lcm(mod)\n    assert pow(g, x * phi//m, p) == pow(h, phi//m, p)\n    return x, m\n```\n\n\n\n\n\n# Web\n\n#### 信息收集\n\n从HTTP头中的Server字段可以了解用了什么服务器\n\n敏感目录：\n\n* `.git`\n* `svn`\n* `idea`\n\n工具\n\n* dirsearch\n* ffuf\n\n### SQL 注入\n\n#### 数字型注入\n\n`?id=1` 和 `?id=2-1` 是一样的\n\n\n\n## PWN\n\n#### pwn tool \n\n``` shell\npip install pwmtools\n```\n\n#### recv\n\n``` python\ncon.recvuntil(\"ready? Y/N : \".encode()).decode()\ncon.recvline_startswith(\"Computer\".encode()).decode() # 一直到有一个符合的\ncon.recv(1024)\n```\n\n#### send\n\n``` python\ncon.sendline(b'Y')\n```\n\n\n\n#### 连接\n\n``` python\nimport pwn\ncon = pwn.remote(\"thekidofarcrania.com\", 10001)\ns = con.recvuntil(\"ready? Y/N : \")\n```\n\n\n\n### Post Request\n\n#### curl\n\n``` shell\ncurl -X POST -d \"username=admin&password=71urlkufpsdnlkadsf\" http://165.227.106.113/post.php\n```\n\n\n\n### Burpsuite\n\ninstall\n\n``` shell\nsudo apt install burpsuite\n```\n\n打开之后点Proxy, 然后点 intercept on, 然后open browser 打开连接就可以获得对应的请求\n\n#### header\n\n可以右键发送到repeater里面\n\n然后在里面改header\n\n\n\n#### referer\n\n表示从哪里来的\n\n``` html\nReferer:awesomesauce.com\n```\n\n\n\n#### python插件\n\nRepeater里面右键，extension，里面可以复制为python的request\n\n\n\n### 开发者工具\n\n#### Storage\n\n可以看到存储的信息\n\n\n\n## 网站\n\n### `robots.txt`\n\n去网站的 https://ctflearn.com/robots.txt 可以看到不允许的网页\n\n#### wikipedia\n\nhttps://en.wikipedia.org/ \n\n用diff可以看到修改的信息\n\n#### 备份文件名\n\n`.git .svn .swp .svn .~ .bak .bash_history`\n\n### dirsearch\n\n可以看网页的目录\n\nhttps://github.com/maurosoria/dirsearch\n\n\n\n#### 更改网页源代码\n\n可以把disable的按钮改成可以按下去\n\n用hackbar可以发送post请求\n\n\n\n#### 查找网站的隐藏连接\n\n#### gobuster\n\n#### 查找历史网页状态\n\nwayback machinehttps://web.archive.org/\n\n## PHP\n\n#### 判断相等\n\n`==, >` 是弱类型判断，会先转换类型再判断，所以 `a=123abc` 会变成 `123`\n\n#### 反序列化\n\n序列化：把对象转成字符串存储。反序列化：把字符串转成对象\n\n`__wakeup()` 是在序列化的时候执行的\n\n``` php+HTML\n<?php \nclass xctf{\npublic $flag = '111';\npublic function __wakeup(){\nexit('bad requests');\n}\n}\n$a = new xctf();\n$c = serialize($a);\necho $c\n?> \n```\n\n输出是 ` O:4:\"xctf\":1:{s:4:\"flag\";s:3:\"111\";} ` 现在要绕过这个exit方法,改成2就行\n\n#### THINK PHP RCE\n\nRCE是remote code execution，在github上搜索think php5 可以找到漏洞\n\n### 文件上传\n\n\n\nhttps://www.cnblogs.com/xhds/p/12218471.html\n\n# misc\n\n#### 在线工具\n\nhttps://www.ilovepdf.com/zh-cn , https://pdf2doc.com/ PDF转换\n\nhttps://georgeom.net/StegOnline/checklist checklist steg\n\n### 隐写术\n\n#### 文件附加\n\n#### PNG\n\n开头是\n\n``` text\n89 50 4E 47 0D 0A 1A 0A\n```\n\nIEND 是\n\n``` text\n00 00 00 00 49 45 4E AE 42 60 82\n```\n\n查看metadata在linux上:\n\n``` shell\nexiftool xxx.png\n```\n\n#### JPEG\n\n* 头 `FF D8 FF`\n* 尾 `FF D9`\n\n#### GIF \n\n拆分图片工具：stegsolve分离图片（先open再analyse-frame browser）\n\n* `47 49 46 38`\n* `00 3B`\n\n#### ZIP \n\n* `50 4B 03 04`\n* `50 4B`\n\n#### RAR\n\n* `52 61 72 21`\n\n#### WAVE\n\n* `57 41 56 45`\n\n#### AVI\n\n* `41 56 49 20`\n\n### LSB\n\nLeast significant bit 在图片的最低有效位上写入信息\n\nStegsolve , zsteg 工具可以识别\n\n``` shell\nsudo apt install zsteg\nzsteg cats.png\nzsteg xx.bmp -b 1 -a yx -v\n```\n\npython脚本\n\n``` python\nfrom bitarray import bitarray\nimport cv2\n\ndef LSBtoBytes(path, index=0):\n    # index 0,1,2 = r,g,b\n    im = cv2.imread(path)\n    data = []\n    for row in im:\n        for col in row:\n            data.append(col[index] & 1)\n    return bitarray(data).tobytes()\n\ndef LSBtoImg(path, index=0):\n    im = cv2.imread(path)\n    for i,row in enumerate(im):\n        for j,col in enumerate(row):\n            if col[index] & 1 == 1:\n                im[i][j] = [255,255,255]\n            else:\n                im[i][j] = [0,0,0]\n    # cv2.imwrite(\"out.png\",im)\n    return im\n```\n\nLSB可能RG， GB之类的组合使用\n\n#### 隐写思路\n\n* 图片结构改变： 结尾加东西，`zsteg`\n\n  提取文件： `zsteg -e \"b1,rgb,lsb,xy\" xx.png > flag.png`\n\n  Chunks 改变 : 用 `pngcheck` 检查\n\n* LSB 隐写： 对应工具\n\n### 盲水印\n\n在不同与域上隐藏信息，在图片傅里叶变换后。把信息添加到“噪声”中，再逆变换回去就不会对原图片产生大变化\n\n工具: `BlindWaterMark`\n\n#### 现成的隐写工具\n\n* Jphide: JPG\n\n* Outguess: JPG\n\n  ``` shell\n  outguess -k \"key\" -r file.jpg out.txt # decode\n  ```\n\n* Steghide: support for JPEG, BMP, WAV and AU files\n\n* F5-steganography: BMP, GIF, or JPEG\n\n* invisible secrets\n\n* wbs43open\n\n* stegosuite\n\n* cloacked-pixel\n\n* Slient-Eye\n\n 暴力工具\n\n`DominicBreuker/stego-toolkit`\n\n### 压缩文件\n\n#### ZIP 文件\n\n* 数据区 (504B0304)\n  * 解压要的版本\n  * flags\n  * 压缩算法\n  * 文件修改时间\n  * CRC32\n  * 压缩前与后大小\n  * 文件名长度和内容\n  * 文件数据\n* 核心目录区 (504B0102)\n* 核心目录结束区 (504B0506)\n\n\n\n#### PDF 文件\n\n可能藏在图片后面，转word或者全选可以看\n\n\n\n#### RAR 文件\n\n`RAR <=4` 的签名 `5261172211A0700`\n\n`RAR5` 的签名 `526172211A070100`\n\n#### 暴力破解工具\n\nwindows: ARCHPR\n\nLinux: fcrackzip, RarCrack\n\n也可以通过爆破CRC32来获得\n\n`zip-crc-cracker` ，`crc32` \n\n#### 伪加密\n\nZIP里面有个通用标记位\n\n距离 `504B0102` 偏移 8 byte, 本身占 2 byte，最低位标识是否被加密。只要改回0就可以正常打开\n\nRAR里面也有\n\nHeadFlags 从低位起第3bit是，但是要重新计算CRC(`HEAD_CRC`)\n\n#### ZIP 明文攻击\n\n知道内容一些字节可以用，要先确认把呢不能\n\n可以用 `ARCHPR` , 非完整明文 `bkcrack`\n\n\n\n### 音频隐写\n\n#### 工具\n\n* audacity 查看音频\n\n\n\n\n\n### 流量分析\n\nWireshark\n\n统计里面，协议分级可以看流量包的比例\n\n会话里面会有地址\n\n过滤器\n\n``` shell\nip.src == xxx.xx.xx.xx\n```\n\n也可以右键作为过滤器应用\n\n#### HTTP\n\n明文传输的\n\n#### HTTPS\n\n添加TLS，要导入密钥才能看到内容\n\n#### FTP\n\n20，21 端口\n\n#### DNS\n\n解析网址\n\n### USB流量分析\n\n通过USB协议传输，从一个地址发送到host\n\n键盘是8字节，鼠标是4字节\n\n* 第一个字节是按键按下\n  * `00` 没有按下，`01` 按左键，`02` 按右键\n* 第二个字节是左右偏移\n  * 正是向右移动 `n` 个像素位\n* 第三个字节是上下偏移\n  * 正是向上移动\n\n键盘流量\n\n* Byte1：控制信息\n  * `[Right gui,Right alt,Right shift,Right control,Left Gui,Left Alt,left shift,Left Control]`\n* byte3：击键信息\n\n### wireshark\n\n提取流量数据\n\n``` python\nimport pyshark\nimport pyshark.packet\nfrom binascii import unhexlify\n\ncapture = pyshark.FileCapture('justapcap.pcap')\nhexstr = \"\"\ncnt = 0\nfor packet in capture:\n    s = str(packet)\n    cur = s.split(\"Name:\")[-1].split(\".\")[0].split(\"1m \")[1]\n    hexstr += cur\nhexstr = hexstr.split(\"exam\")[0]\n\nwith open(\"a.png\",\"wb\") as f:\n    f.write(unhexlify(hexstr))\n```\n\n### 内存取证\n\n#### volatility\n\n``` shell\nsudo snap install volatility-phocean\n```\n\n#### 确定信息\n\n``` shell\nvol.py -f memory imageinfo\n```\n\npsxview 查看内存\n\n``` shell\nvol.py -f memory --profile=Win7SPx86 psxview\n```\n\npslist 查看运行的进程\n\n``` shell\nvolatility -f mem.mem --profile=Win10x64_1231 pslist\n```\n\n\n\nfilescan 是打开的文件对象\n\ndumpfile \n\n``` shell\nvol.py -f memory --profile=Win7SPx86 prodump -p 1384 --dump-dir ./dump/\n\nfile dump/executable.i384.exe\n```\n\nPEB 会保存PEB信息\n\n``` shell\nvol.py -f memory --profile=Win7SPx86 cmdline\n```\n\n是命令行信息\n\nsockets\n\nhivelist, hivescan 是注册表\n\nhashdump获取用户密码的hash， mimikatz 插件可以还原hash\n\n#### volatitlity 3\n\n确定信息\n\n``` shell\nvol -f x.mem windows.info\n```\n\n\n\n### 磁盘取证\n\n#### 文件系统\n\nwindows: FAT16, FAT32, NTFS\n\nLinux: Ext2, Ext3, Ext4\n\n#### Fat16/32\n\n16bit 来表示一个簇\n\nDBR扇区\n\n![image-20240819191436093](CTF知识点/image-20240819191436093.png)\n\n#### NTFS\n\n性能优秀，安全性高，可恢复性，文件压缩\n\n\n\n# OSINT\n\n时光机 web archive\n\n\n\n\n\n# 区块链blockchain\n\nIDE：REMIX\n\n#### windows 安装nc\n\n去nmap官网下载就行\n\n\n\n### msg.sender\n\n当一个外部账户（例如，用户的钱包地址）调用合约中的函数时，`msg.sender` 会是该外部账户的地址。\n\n如果一个合约调用另一个合约的函数，那么 `msg.sender` 将是调用方合约的地址，而不是最终的外部账户。\n\n例如，如果合约 A 调用合约 B 的函数，合约 B 中的 `msg.sender` 会是合约 A 的地址，而不是最初发起调用的外部账户。\n\n当一个函数从合约内部调用另一个合约的函数时，`msg.sender` 仍然是直接发起调用的那个地址。如果函数调用链中有多个合约调用，`msg.sender` 始终代表的是当前执行上下文中的调用者。\n\n### storage\n\n在 Solidity 中，`storage` 是用于存储智能合约中状态变量的数据位置。它是智能合约中非常重要的一部分，用来持久化存储数据，也就是存储在以太坊区块链上的数据。与其他数据存储位置（如 `memory` 和 `stack`）不同，`storage` 中的数据是持久的，意味着它们在交易执行后会一直存在，直到被更新或删除。每个合约都有自己的 `storage` 空间。\n\n#### 1. **`storage` 的特点**\n\n- **持久性**：`storage` 中的数据在合约的生命周期内是持久的，意味着它们会被保存在区块链中。即使合约函数执行完成后，数据仍然保留，并且在下一次函数调用时可以访问。\n- **费用**：在 Solidity 中，将数据写入 `storage` 是昂贵的操作，因为这需要改变区块链状态并消耗 `gas`。相对而言，从 `storage` 中读取数据的费用要比写入便宜一些。\n- **每个合约的 `storage` 空间独立**：每个智能合约都有自己的 `storage` 空间，且 `storage` 中的数据可以通过合约的状态变量来访问\n\n#### slot\n\nSolidity 会将每个状态变量存储在固定的槽（slot）中。每个状态变量占据一定的存储槽，状态变量的存储位置由其在合约中声明的顺序决定。这些槽位在区块链上是固定的\n\n\n\n### 合约交互python\n\n先要安装solc, 然后pip安装`web3`,`py-solc-x`下面是基本配置\n\n``` python\nw3 = Web3(Web3.HTTPProvider('http://94.237.59.45:52415'))\n\n\ndef create_abi(name):\n    temp_file = solcx.compile_files(f'{name}.sol')\n    abi = temp_file[f'{name}.sol:{name}']['abi']\n    return abi\n\nsetup_abi = create_abi('Setup')\nfNFT_abi = create_abi('FrontierNFT')\nfMarket_abi = create_abi('FrontierMarketplace')\n\nif w3.is_connected():\n    print(\"Connected to Ethereum network\")\nelse:\n    print(\"Failed to connect\")\n\nprivate_key = \"1249bb2c45202146bbe401b6b29848c5f0345e418434eeedaade8dd8bdbb437a\"\nmy_address = \"0x41b34Fe0b213FF5300D648F875F84B0F016295cc\"\nfmarket_address = \"0x899c356B0489472c99EF4A46b3893B62Fd73F349\"\nsetup_address = \"0xD984cF86bfEbb01E62f0729c2Dd5562a852038f4\"\n```\n\n#### 调用函数\n\n不创建新节点\n\n``` python\nsetup = w3.eth.contract(address=setup_address, abi=setup_abi)\n\nprint(setup.functions.isSolved().call())\nprint(setup.functions.paramfunc(param).call()) # 有参数的写法\n```\n\n读取值，可以把值当成函数\n\n#### 查询block chain\n\n``` python\nlatest_block = w3.eth.get_block('latest')\n# block_number = 10000000  #\n# latest_block = w3.eth.get_block(0)\n# print(block['number']) \n\nprint(\"Latest Block Info:\")\nprint(f\"Block Number: {latest_block['number']}\")\nprint(f\"Block Hash: {latest_block['hash'].hex()}\")\nprint(f\"Parent Hash: {latest_block['parentHash'].hex()}\")\nprint(f\"Timestamp: {latest_block['timestamp']}\")\nprint(f\"Miner: {latest_block['miner']}\")\nprint(f\"Gas Used: {latest_block['gasUsed']}\")\nprint(f\"Gas Limit: {latest_block['gasLimit']}\")\nprint(f\"Transactions Count: {len(latest_block['transactions'])}\")\n\n```\n\n##### 查询balance\n\n``` python\n# 查询该地址的余额（返回值是以 wei 为单位）\nbalance_wei = web3.eth.get_balance(address)\n# 将 wei 转换为 ether\nbalance_ether = web3.from_wei(balance_wei, 'ether')\n```\n\n\n\n#### 查询transactions\n\n``` python\n# 查询某个区块范围内的交易\nblock_start = 10000000  # 起始区块\nblock_end = 10001000    # 结束区块\n\n# 获取区块范围内的交易\nfor block_number in range(block_start, block_end + 1):\n    block = web3.eth.getBlock(block_number, full_transactions=True)\n\n    # 遍历区块中的所有交易\n    for tx in block.transactions:\n        # 如果交易是发送到合约地址\n        if tx.to == contract_address:\n            # 解析交易的input数据，检查是否是函数调用\n            input_data = tx.input\n            print(f\"Transaction Hash: {tx.hash.hex()}\")\n\n            # 使用ABI来解码交易数据\n            decoded_input = contract.decode_function_input(input_data)\n            function_name = decoded_input[0].fn.__name__\n            print(f\"Called function: {function_name}\")\n            print(f\"Function Arguments: {decoded_input[1]}\")\n            \n# 遍历\nfor tx_hash in latest_block['transactions']:\n    tx = w3.eth.get_transaction(tx_hash)\n    print(f\"from: {tx['from']}\")\n\n    # \n    if tx['to'] is None:\n        print(f\"Transaction {tx_hash.hex()} is a contract deployment.\")\n    else:\n        print(f\"Transaction {tx_hash.hex()} is a contract function call to {tx['to']}.\")\n\n    # \n    receipt = w3.eth.get_transaction_receipt(tx_hash)\n\n    # \n    if receipt['contractAddress']:\n        print(f\"Contract deployed at address {receipt['contractAddress']}\")\n    else:\n        print(\"No contract deployed in this transaction.\")\n\n    # print(f\"Transaction Input Data: {tx['input']}\")\n    \n    # decoded_input = setup.decode_function_input(tx['input'])\n```\n\n##### 交易信息\n\n``` python\n# 打印交易的详细信息\nfor tx_hash in transactions:\n    transaction = web3.eth.get_transaction(tx_hash)\n    print(f\"Transaction Hash: {tx_hash.hex()}\")\n    print(f\"From: {transaction['from']}\")\n    print(f\"To: {transaction['to']}\")\n    print(f\"Value: {web3.fromWei(transaction['value'], 'ether')} ETH\")\n    print(f\"Gas: {transaction['gas']}\")\n    print(f\"Gas Price: {web3.fromWei(transaction['gasPrice'], 'gwei')} Gwei\")\n    print(\"-\" * 40)\n```\n\n\n\n#### 查询事件\n\n``` python\nevent_filter = setup.events.DeployedTarget.create_filter(from_block=1, to_block=1) #DeployedTarget是函数名字\nevents = event_filter.get_all_entries()\n\n# print event\nfor event in events:\n    print(f\"Event: {event.event}\")\n    print(f\"Arguments: {event.args}\")\n```\n\n#### 发送transaction\n\n``` python\n# send transactions\ntx = forgotten.functions.discover(hashed).build_transaction(\n    {\n        'from': my_address,\n        \"gasPrice\": w3.eth.gas_price,  # two ******* hours it took to figure out this was needed.\n        'nonce': w3.eth.get_transaction_count(\"0xEB4B81DE5738a22d24631ABD62f62cEECC268e71\"),\n    }\n)\n\n# needs to be signed as we are executing/writing not just reading\ntx_create = w3.eth.account.sign_transaction(tx, private_key)\ntx_hash = w3.eth.send_raw_transaction(tx_create.raw_transaction)\ntx_receipt = w3.eth.wait_for_transaction_receipt(tx_hash)\nprint(f'Tx successful with hash: { tx_receipt.transactionHash.hex() }')\n```\n\n#### 计算keccak哈希\n\n``` python\nhashed = w3.solidity_keccak(\n    ['uint256', 'uint256', 'address'], \n    [1, 1734258030, \"0x3E698Aba19B29C3fB625966A9631e6cf5C79505e\"]  \n)\n\nprint(f\"Keccak256 Hash: {hashed.hex()}\")\n```\n\n\n\n\n\n## Hack 思维\n\n### 数据范围\n\n输入不合法数据范围\n\n","source":"_posts/CTF知识点.md","raw":"---\ntitle: CTF知识点\ndate: 2024-05-15 00:06:29\ntags:\n---\n\n### 知识点\n\nhttps://ctf101.org/web-exploitation/overview/\n\nhttps://www.youtube.com/watch?v=5C-OtW7C5oU&t=30s\n\n\n\n\n\nhttps://book.hacktricks.xyz/network-services-pentesting/pentesting-web/flask\n\n### 练习网站\n\nbuuctf\n\nhttps://adworld.xctf.org.cn/\n\nhttps://ctflearn.com/challenge/1/browse\n\nhttps://www.root-me.org/?lang=en\n\nhttps://picoctf.org/\n\n1. tryhackme.com\n2. hackthebox.eu\n3. overthewire.org\n4. Root-me.org\n5. Ringzer0team.com\n6. Hack.me\n7. ctftime.org\n8. picoctf.com\n9. ctf365.com\n10. ctf101.org\n\n### 虚拟机\n\n打开或关闭功能, 打开 Hyper V, 然后重启\n\n下载 kali的Hyper V的Hyper V镜像. 然后双击bat安装. 然后就能打开了,点击连接就有gui\n\n## 文件\n\n### 图片文件处理\n\n打开图片\n\n``` shell\neog xxx.jpg\n```\n\n#### hexdump\n\nhex中查找 string\n\n* pdf里面找隐藏\n\n``` shell\nstrings xxx.jpg | grep CTFlearn \nstrings -n 10 xxx.jpg  # >= 10 长度的字符串\n```\n\nhexdump\n\n``` shell\nhexdump -C Pho.jpg | less\n```\n\npython\n\n``` python\nfile = open(\"TheMessage.txt\", \"r\").read()\nres = \"\"\nfor ch in file:\n\tif ord(ch) == 32:\n\t\tres += \"0\"\n\telse:\n\t\tres += \"1\"\nprint(res)\n```\n\n\n\n### binwalk\n\n``` shell\nbinwalk --dd=.* xx.jpeg # 查看所有隐藏的二进制, DD 可以顺便解压\nbinwalk -e xx.jpg # 提取文件\nfile * # 查看当前目录所有文件类型\nexiftool xx.jpg # 查看更多信息，有file里面没有显示完全的\n```\n\n#### stegehide\n\n``` shell\nsteghide extract -sf xx.jpg\n```\n\n### 二维码\n\n显示二维码\n\n``` shell\nsudo apt install zbar-tools\nzbarimg xx.png\n```\n\npython\n\n``` python\nimport cv2\nimg = cv2.imread(\"qr.png\")\ndet = cv2.QRCodeDetector()\ndata, box, b = det.detectAndDecode(img)\nprint(data)\n```\n\n\n\n## python \n\n### string\n\n所有可打印字符\n\n``` python\nstring.printable\n```\n\n### 提取flag\n\n``` python\nimport re\ndef extract_flag_from_string(string):\n    match = re.search(r'flag\\{[^}]+}', string)\n    return match.group(0) if match else None\n```\n\n### Crypto\n\n``` python\npip install pycryptodome\n```\n\n#### 计算两个byte的xor\n\n``` python\ndef xor(data, key):\n    return bytearray([x ^ y for x,y in zip(data,key)])\n```\n\n### urlencode\n\n``` python\nimport urllib.parse\n# 字典格式的数\ndata = {'name': '张三', 'age': 25}\n# 使用 urlencode 进行编码\nencoded_data = urllib.parse.urlencode(data)\nprint(encoded_data)\n```\n\n\n\n\n\n## Git\n\n查看历史log\n\n``` shell\ngit log\n```\n\n查看commit改变了什么\n\n``` shell\ngit show\n```\n\n## Linux\n\n#### 解压\n\n``` shell\nunzip x.zip\nunrar x x.rar\n```\n\n### 查看ls\n\n打印所有文件夹内容\n\n``` shell\nls -la *\n```\n\n查找\n\n``` shell\nfind / -name *.txt\n```\n\n\n\n\n\n# 密码学\n\nonline的工具\n\nhttps://gchq.github.io/CyberChef/\n\nhttps://www.dcode.fr/en\n\n加密\n\nhttps://www.boxentriq.com/code-breaking/cipher-identifier\n\n### 2进制到hex\n\n``` python\nx = str(hex(int(bc, 2)))[2:]\n```\n\n#### hex转换\n\n``` python\nfrom binascii import unhexlify\nhexstr = \"41 42 43 54 46 7B 34 35 43 31 31 5F 31 35 5F 55 35 33 46 55 4C 7D\"\nhexs = \"\".join(hexstr.split(\" \"))\nprint(unhexlify(hexs.encode()))\n```\n\n#### 输入bytes\n\n``` cpp\ns = \"f\\nk\\fw&O.@\\x11x\\rZ;U\\x11p\\x19F\\x1Fv\\\"M\"\na = bytearray(s.encode())\n```\n\n#### 字符串转换字符数组\n\n``` python\nchar_array = list(\"your_string\")\nstring = ''.join(char_array)\n```\n\n#### 交换大小写\n\n``` python\n\"asb\".swapcase()\n```\n\n`c.isalpha()`：判断 `c` 是否是字母。\n\n`c.isupper()`：判断 `c` 是否是大写字母。\n\n`c.islower()`：判断 `c` 是否是小写字母\n\n### base64\n\nshell\n\n``` shell\nbase64 -d xxx\necho \"c3ludCB2ZiA6IGEwX29icWxfczBldHJnX2RlX3BicXI=\" | base64 -d\n```\n\npython\n\n``` python\nfrom base64 import decodebytes\ns = decodebytes(\"Q1RGe0ZsYWdneVdhZ2d5UmFnZ3l9\".encode())\nprint(s)\n```\n\ncyberchef的label和jump可以实现循环解密\n\n原理：\n\n**将二进制数据转换为 6 位块：**\n\n- 每个字节有 8 位，3 个字节一共是 24 位。\n- 将这 24 位拆分为 4 个 6 位的块。\n\n**将 6 位的数据映射到 Base64 字符表：**\n\n- `A-Za-z0-9+/`\n\n如果输入数据的字节数不是 3 的倍数，编码过程会用 `=` 字符进行填充，使输出数据的长度是 4 字节的倍数。\n\n在后面每次填一个byte(0) 直到是3的倍数，然后base64加密，最后把由加入新0产生的A换成=就好了\n\n``` python\ndef b64en(s, table=\"default\"):\n    if table == \"default\":\n        table = \"\"\n        for i in range(26):\n            table += chr(i + ord('A'))\n        for i in range(26):\n            table += chr(i + ord('a'))\n        for i in range(10):\n            table += chr(i + ord('0'))\n        table += \"+/\"\n    s = s.encode()\n    lens = len(s)\n    s = int.from_bytes(s)\n    s = bin(s)[2:]\n  \n    while len(s) < lens*8:\n        s = \"0\" + s\n    needed = 0\n    while len(s) % 3 != 0:\n        s += \"00000000\"\n        needed += 1\n\n    s = list(map(int,list(s)))\n    i = 0\n    ans = []\n    while i < len(s):\n        x = 0\n        for j in range(6):\n            x = (x<<1) + s[i+j]\n        ans.append(table[x])\n        i += 6\n    for j in range(needed):\n        ans.pop()\n    for j in range(needed):\n        ans += \"=\"\n    return \"\".join(ans)\n\ndef b64de(s, table=\"default\"):\n    if table == \"default\":\n        table = \"\"\n        for i in range(26):\n            table += chr(i + ord('A'))\n        for i in range(26):\n            table += chr(i + ord('a'))\n        for i in range(10):\n            table += chr(i + ord('0'))\n        table += \"+/\"\n    s = list(s)\n    needed = 0\n    while s[-1] == \"=\":\n        s.pop()\n        needed += 1\n    for i in range(needed):\n        s += table[0]\n    a = \"\"\n    for i in range(len(s)):\n        x = table.index(s[i])\n        \n        toa = \"\"\n        for j in range(6):\n            if x>>j&1:\n                toa = \"1\" + toa\n            else:\n                toa = \"0\" + toa\n        \n        a += toa\n\n    a = list(map(int,list(a)))\n    for i in range(needed):\n        for j in range(8):\n            a.pop()\n    i = 0\n    ans = []\n    while i < len(a):\n        x = 0\n        for j in range(8):\n            x = (x<<1) + a[i+j]\n        ans.append(chr(x))\n        i += 8\n\n    ans = ''.join(ans)\n    return ans\n```\n\n\n\n#### DTMF 声调\n\nhttps://dtmf.netlify.app/\n\n## 不同种类的密码\n\n#### Vigenere Cipher\n\n一种凯撒密码\n\nkey 是 `OCU` 那么第一个字符被移动了 O (14)次，第二个字符被移动了 `C` (2) 次\n\n#### CAESAR Cipher\n\n在线暴力破解\n\nhttps://www.dcode.fr/caesar-cipher\n\n#### keyboard shift\n\n`BUH'tdy,|Bim5y~Bdt76yQ` 长这样, 有可能下划线不被解密\n\nhttps://www.dcode.fr/keyboard-shift-cipher\n\n#### bacon cipher\n\n\n\n#### 与佛论禅\n\nhttps://www.keyfc.net/bbs/tools/tudoucode.aspx\n\n密语是`佛曰：` 开头的\n\n#### rot13\n\nhttps://www.rot13.de/index.php\n\n\n\n### enigma cryptogarphy\n\nhttps://cryptii.com/pipes/enigma-machine\n\n#### Playfair cipher\n\n通常有一个表格表示密钥\n$$\n\\begin{array}{lllll}\nQ & W & E & R & T \\\\\nY & U & I & O & P \\\\\nA & S & D & F & G \\\\\nH & K & L & Z & X \\\\\nC & V & B & N & M\n\\end{array}\n$$\nhttps://www.boxentriq.com/code-breaking/playfair-cipher\n\n### brute force\n\n暴力key的长度，然后暴力，使得xor后的string有 `flag` \n\n\n\n#### sha1\n\n这个里面的 `0x8004u`就是sha1加密的标志\n\nhttp://www.ttmd5.com/hash.php?type=5\n\n#### Md5\n\n这个里面的 `0x8003u`就是sha1加密的标志\n\nhttps://hashes.com/en/decrypt/hash\n\nhttps://md5.gromweb.com/?md5=b74dec4f39d35b6a2e6c48e637c8aedb\n\nhttps://www.somd5.com/\n\n可以直接google MD5值, 看有没有解密\n\n\n\n### Discrete logarithm\n\n如果 $p-1$ 的质数分解比较小，那么可以解出来\n\nhttps://github.com/idekctf/idekctf-2024/blob/main/crypto/goldenticket/debug/solve.py\n\nsage 有一个函数 `discrete_log_lambda` 可以对一个区间计算答案，复杂度是 $O(\\sqrt{len})$ 级别, 之后再用CRT合并出大答案\n\n``` py\ndef PH_partial(h, g, p, fact_phi):\n    \"\"\"Returns (x, m), where\n    - x is the dlog of h in base g, mod m\n    - m = lcm(pi^ei) for (pi, ei) in fact_phi\n    \"\"\"\n    res = []\n    mod = []\n    F = GF(p)\n\n    phi = p-1\n    for pi, ei in fact_phi:\n        gi = pow(g, phi//(pi**ei), p)\n        hi = pow(h, phi//(pi**ei), p)\n        xi = discrete_log_lambda(F(hi), F(gi), bounds = (0, pi**ei))\n        res.append(int(xi))\n        mod.append(int(pi**ei))\n\n    x, m = CRT(res, mod), lcm(mod)\n    assert pow(g, x * phi//m, p) == pow(h, phi//m, p)\n    return x, m\n```\n\n\n\n\n\n# Web\n\n#### 信息收集\n\n从HTTP头中的Server字段可以了解用了什么服务器\n\n敏感目录：\n\n* `.git`\n* `svn`\n* `idea`\n\n工具\n\n* dirsearch\n* ffuf\n\n### SQL 注入\n\n#### 数字型注入\n\n`?id=1` 和 `?id=2-1` 是一样的\n\n\n\n## PWN\n\n#### pwn tool \n\n``` shell\npip install pwmtools\n```\n\n#### recv\n\n``` python\ncon.recvuntil(\"ready? Y/N : \".encode()).decode()\ncon.recvline_startswith(\"Computer\".encode()).decode() # 一直到有一个符合的\ncon.recv(1024)\n```\n\n#### send\n\n``` python\ncon.sendline(b'Y')\n```\n\n\n\n#### 连接\n\n``` python\nimport pwn\ncon = pwn.remote(\"thekidofarcrania.com\", 10001)\ns = con.recvuntil(\"ready? Y/N : \")\n```\n\n\n\n### Post Request\n\n#### curl\n\n``` shell\ncurl -X POST -d \"username=admin&password=71urlkufpsdnlkadsf\" http://165.227.106.113/post.php\n```\n\n\n\n### Burpsuite\n\ninstall\n\n``` shell\nsudo apt install burpsuite\n```\n\n打开之后点Proxy, 然后点 intercept on, 然后open browser 打开连接就可以获得对应的请求\n\n#### header\n\n可以右键发送到repeater里面\n\n然后在里面改header\n\n\n\n#### referer\n\n表示从哪里来的\n\n``` html\nReferer:awesomesauce.com\n```\n\n\n\n#### python插件\n\nRepeater里面右键，extension，里面可以复制为python的request\n\n\n\n### 开发者工具\n\n#### Storage\n\n可以看到存储的信息\n\n\n\n## 网站\n\n### `robots.txt`\n\n去网站的 https://ctflearn.com/robots.txt 可以看到不允许的网页\n\n#### wikipedia\n\nhttps://en.wikipedia.org/ \n\n用diff可以看到修改的信息\n\n#### 备份文件名\n\n`.git .svn .swp .svn .~ .bak .bash_history`\n\n### dirsearch\n\n可以看网页的目录\n\nhttps://github.com/maurosoria/dirsearch\n\n\n\n#### 更改网页源代码\n\n可以把disable的按钮改成可以按下去\n\n用hackbar可以发送post请求\n\n\n\n#### 查找网站的隐藏连接\n\n#### gobuster\n\n#### 查找历史网页状态\n\nwayback machinehttps://web.archive.org/\n\n## PHP\n\n#### 判断相等\n\n`==, >` 是弱类型判断，会先转换类型再判断，所以 `a=123abc` 会变成 `123`\n\n#### 反序列化\n\n序列化：把对象转成字符串存储。反序列化：把字符串转成对象\n\n`__wakeup()` 是在序列化的时候执行的\n\n``` php+HTML\n<?php \nclass xctf{\npublic $flag = '111';\npublic function __wakeup(){\nexit('bad requests');\n}\n}\n$a = new xctf();\n$c = serialize($a);\necho $c\n?> \n```\n\n输出是 ` O:4:\"xctf\":1:{s:4:\"flag\";s:3:\"111\";} ` 现在要绕过这个exit方法,改成2就行\n\n#### THINK PHP RCE\n\nRCE是remote code execution，在github上搜索think php5 可以找到漏洞\n\n### 文件上传\n\n\n\nhttps://www.cnblogs.com/xhds/p/12218471.html\n\n# misc\n\n#### 在线工具\n\nhttps://www.ilovepdf.com/zh-cn , https://pdf2doc.com/ PDF转换\n\nhttps://georgeom.net/StegOnline/checklist checklist steg\n\n### 隐写术\n\n#### 文件附加\n\n#### PNG\n\n开头是\n\n``` text\n89 50 4E 47 0D 0A 1A 0A\n```\n\nIEND 是\n\n``` text\n00 00 00 00 49 45 4E AE 42 60 82\n```\n\n查看metadata在linux上:\n\n``` shell\nexiftool xxx.png\n```\n\n#### JPEG\n\n* 头 `FF D8 FF`\n* 尾 `FF D9`\n\n#### GIF \n\n拆分图片工具：stegsolve分离图片（先open再analyse-frame browser）\n\n* `47 49 46 38`\n* `00 3B`\n\n#### ZIP \n\n* `50 4B 03 04`\n* `50 4B`\n\n#### RAR\n\n* `52 61 72 21`\n\n#### WAVE\n\n* `57 41 56 45`\n\n#### AVI\n\n* `41 56 49 20`\n\n### LSB\n\nLeast significant bit 在图片的最低有效位上写入信息\n\nStegsolve , zsteg 工具可以识别\n\n``` shell\nsudo apt install zsteg\nzsteg cats.png\nzsteg xx.bmp -b 1 -a yx -v\n```\n\npython脚本\n\n``` python\nfrom bitarray import bitarray\nimport cv2\n\ndef LSBtoBytes(path, index=0):\n    # index 0,1,2 = r,g,b\n    im = cv2.imread(path)\n    data = []\n    for row in im:\n        for col in row:\n            data.append(col[index] & 1)\n    return bitarray(data).tobytes()\n\ndef LSBtoImg(path, index=0):\n    im = cv2.imread(path)\n    for i,row in enumerate(im):\n        for j,col in enumerate(row):\n            if col[index] & 1 == 1:\n                im[i][j] = [255,255,255]\n            else:\n                im[i][j] = [0,0,0]\n    # cv2.imwrite(\"out.png\",im)\n    return im\n```\n\nLSB可能RG， GB之类的组合使用\n\n#### 隐写思路\n\n* 图片结构改变： 结尾加东西，`zsteg`\n\n  提取文件： `zsteg -e \"b1,rgb,lsb,xy\" xx.png > flag.png`\n\n  Chunks 改变 : 用 `pngcheck` 检查\n\n* LSB 隐写： 对应工具\n\n### 盲水印\n\n在不同与域上隐藏信息，在图片傅里叶变换后。把信息添加到“噪声”中，再逆变换回去就不会对原图片产生大变化\n\n工具: `BlindWaterMark`\n\n#### 现成的隐写工具\n\n* Jphide: JPG\n\n* Outguess: JPG\n\n  ``` shell\n  outguess -k \"key\" -r file.jpg out.txt # decode\n  ```\n\n* Steghide: support for JPEG, BMP, WAV and AU files\n\n* F5-steganography: BMP, GIF, or JPEG\n\n* invisible secrets\n\n* wbs43open\n\n* stegosuite\n\n* cloacked-pixel\n\n* Slient-Eye\n\n 暴力工具\n\n`DominicBreuker/stego-toolkit`\n\n### 压缩文件\n\n#### ZIP 文件\n\n* 数据区 (504B0304)\n  * 解压要的版本\n  * flags\n  * 压缩算法\n  * 文件修改时间\n  * CRC32\n  * 压缩前与后大小\n  * 文件名长度和内容\n  * 文件数据\n* 核心目录区 (504B0102)\n* 核心目录结束区 (504B0506)\n\n\n\n#### PDF 文件\n\n可能藏在图片后面，转word或者全选可以看\n\n\n\n#### RAR 文件\n\n`RAR <=4` 的签名 `5261172211A0700`\n\n`RAR5` 的签名 `526172211A070100`\n\n#### 暴力破解工具\n\nwindows: ARCHPR\n\nLinux: fcrackzip, RarCrack\n\n也可以通过爆破CRC32来获得\n\n`zip-crc-cracker` ，`crc32` \n\n#### 伪加密\n\nZIP里面有个通用标记位\n\n距离 `504B0102` 偏移 8 byte, 本身占 2 byte，最低位标识是否被加密。只要改回0就可以正常打开\n\nRAR里面也有\n\nHeadFlags 从低位起第3bit是，但是要重新计算CRC(`HEAD_CRC`)\n\n#### ZIP 明文攻击\n\n知道内容一些字节可以用，要先确认把呢不能\n\n可以用 `ARCHPR` , 非完整明文 `bkcrack`\n\n\n\n### 音频隐写\n\n#### 工具\n\n* audacity 查看音频\n\n\n\n\n\n### 流量分析\n\nWireshark\n\n统计里面，协议分级可以看流量包的比例\n\n会话里面会有地址\n\n过滤器\n\n``` shell\nip.src == xxx.xx.xx.xx\n```\n\n也可以右键作为过滤器应用\n\n#### HTTP\n\n明文传输的\n\n#### HTTPS\n\n添加TLS，要导入密钥才能看到内容\n\n#### FTP\n\n20，21 端口\n\n#### DNS\n\n解析网址\n\n### USB流量分析\n\n通过USB协议传输，从一个地址发送到host\n\n键盘是8字节，鼠标是4字节\n\n* 第一个字节是按键按下\n  * `00` 没有按下，`01` 按左键，`02` 按右键\n* 第二个字节是左右偏移\n  * 正是向右移动 `n` 个像素位\n* 第三个字节是上下偏移\n  * 正是向上移动\n\n键盘流量\n\n* Byte1：控制信息\n  * `[Right gui,Right alt,Right shift,Right control,Left Gui,Left Alt,left shift,Left Control]`\n* byte3：击键信息\n\n### wireshark\n\n提取流量数据\n\n``` python\nimport pyshark\nimport pyshark.packet\nfrom binascii import unhexlify\n\ncapture = pyshark.FileCapture('justapcap.pcap')\nhexstr = \"\"\ncnt = 0\nfor packet in capture:\n    s = str(packet)\n    cur = s.split(\"Name:\")[-1].split(\".\")[0].split(\"1m \")[1]\n    hexstr += cur\nhexstr = hexstr.split(\"exam\")[0]\n\nwith open(\"a.png\",\"wb\") as f:\n    f.write(unhexlify(hexstr))\n```\n\n### 内存取证\n\n#### volatility\n\n``` shell\nsudo snap install volatility-phocean\n```\n\n#### 确定信息\n\n``` shell\nvol.py -f memory imageinfo\n```\n\npsxview 查看内存\n\n``` shell\nvol.py -f memory --profile=Win7SPx86 psxview\n```\n\npslist 查看运行的进程\n\n``` shell\nvolatility -f mem.mem --profile=Win10x64_1231 pslist\n```\n\n\n\nfilescan 是打开的文件对象\n\ndumpfile \n\n``` shell\nvol.py -f memory --profile=Win7SPx86 prodump -p 1384 --dump-dir ./dump/\n\nfile dump/executable.i384.exe\n```\n\nPEB 会保存PEB信息\n\n``` shell\nvol.py -f memory --profile=Win7SPx86 cmdline\n```\n\n是命令行信息\n\nsockets\n\nhivelist, hivescan 是注册表\n\nhashdump获取用户密码的hash， mimikatz 插件可以还原hash\n\n#### volatitlity 3\n\n确定信息\n\n``` shell\nvol -f x.mem windows.info\n```\n\n\n\n### 磁盘取证\n\n#### 文件系统\n\nwindows: FAT16, FAT32, NTFS\n\nLinux: Ext2, Ext3, Ext4\n\n#### Fat16/32\n\n16bit 来表示一个簇\n\nDBR扇区\n\n![image-20240819191436093](CTF知识点/image-20240819191436093.png)\n\n#### NTFS\n\n性能优秀，安全性高，可恢复性，文件压缩\n\n\n\n# OSINT\n\n时光机 web archive\n\n\n\n\n\n# 区块链blockchain\n\nIDE：REMIX\n\n#### windows 安装nc\n\n去nmap官网下载就行\n\n\n\n### msg.sender\n\n当一个外部账户（例如，用户的钱包地址）调用合约中的函数时，`msg.sender` 会是该外部账户的地址。\n\n如果一个合约调用另一个合约的函数，那么 `msg.sender` 将是调用方合约的地址，而不是最终的外部账户。\n\n例如，如果合约 A 调用合约 B 的函数，合约 B 中的 `msg.sender` 会是合约 A 的地址，而不是最初发起调用的外部账户。\n\n当一个函数从合约内部调用另一个合约的函数时，`msg.sender` 仍然是直接发起调用的那个地址。如果函数调用链中有多个合约调用，`msg.sender` 始终代表的是当前执行上下文中的调用者。\n\n### storage\n\n在 Solidity 中，`storage` 是用于存储智能合约中状态变量的数据位置。它是智能合约中非常重要的一部分，用来持久化存储数据，也就是存储在以太坊区块链上的数据。与其他数据存储位置（如 `memory` 和 `stack`）不同，`storage` 中的数据是持久的，意味着它们在交易执行后会一直存在，直到被更新或删除。每个合约都有自己的 `storage` 空间。\n\n#### 1. **`storage` 的特点**\n\n- **持久性**：`storage` 中的数据在合约的生命周期内是持久的，意味着它们会被保存在区块链中。即使合约函数执行完成后，数据仍然保留，并且在下一次函数调用时可以访问。\n- **费用**：在 Solidity 中，将数据写入 `storage` 是昂贵的操作，因为这需要改变区块链状态并消耗 `gas`。相对而言，从 `storage` 中读取数据的费用要比写入便宜一些。\n- **每个合约的 `storage` 空间独立**：每个智能合约都有自己的 `storage` 空间，且 `storage` 中的数据可以通过合约的状态变量来访问\n\n#### slot\n\nSolidity 会将每个状态变量存储在固定的槽（slot）中。每个状态变量占据一定的存储槽，状态变量的存储位置由其在合约中声明的顺序决定。这些槽位在区块链上是固定的\n\n\n\n### 合约交互python\n\n先要安装solc, 然后pip安装`web3`,`py-solc-x`下面是基本配置\n\n``` python\nw3 = Web3(Web3.HTTPProvider('http://94.237.59.45:52415'))\n\n\ndef create_abi(name):\n    temp_file = solcx.compile_files(f'{name}.sol')\n    abi = temp_file[f'{name}.sol:{name}']['abi']\n    return abi\n\nsetup_abi = create_abi('Setup')\nfNFT_abi = create_abi('FrontierNFT')\nfMarket_abi = create_abi('FrontierMarketplace')\n\nif w3.is_connected():\n    print(\"Connected to Ethereum network\")\nelse:\n    print(\"Failed to connect\")\n\nprivate_key = \"1249bb2c45202146bbe401b6b29848c5f0345e418434eeedaade8dd8bdbb437a\"\nmy_address = \"0x41b34Fe0b213FF5300D648F875F84B0F016295cc\"\nfmarket_address = \"0x899c356B0489472c99EF4A46b3893B62Fd73F349\"\nsetup_address = \"0xD984cF86bfEbb01E62f0729c2Dd5562a852038f4\"\n```\n\n#### 调用函数\n\n不创建新节点\n\n``` python\nsetup = w3.eth.contract(address=setup_address, abi=setup_abi)\n\nprint(setup.functions.isSolved().call())\nprint(setup.functions.paramfunc(param).call()) # 有参数的写法\n```\n\n读取值，可以把值当成函数\n\n#### 查询block chain\n\n``` python\nlatest_block = w3.eth.get_block('latest')\n# block_number = 10000000  #\n# latest_block = w3.eth.get_block(0)\n# print(block['number']) \n\nprint(\"Latest Block Info:\")\nprint(f\"Block Number: {latest_block['number']}\")\nprint(f\"Block Hash: {latest_block['hash'].hex()}\")\nprint(f\"Parent Hash: {latest_block['parentHash'].hex()}\")\nprint(f\"Timestamp: {latest_block['timestamp']}\")\nprint(f\"Miner: {latest_block['miner']}\")\nprint(f\"Gas Used: {latest_block['gasUsed']}\")\nprint(f\"Gas Limit: {latest_block['gasLimit']}\")\nprint(f\"Transactions Count: {len(latest_block['transactions'])}\")\n\n```\n\n##### 查询balance\n\n``` python\n# 查询该地址的余额（返回值是以 wei 为单位）\nbalance_wei = web3.eth.get_balance(address)\n# 将 wei 转换为 ether\nbalance_ether = web3.from_wei(balance_wei, 'ether')\n```\n\n\n\n#### 查询transactions\n\n``` python\n# 查询某个区块范围内的交易\nblock_start = 10000000  # 起始区块\nblock_end = 10001000    # 结束区块\n\n# 获取区块范围内的交易\nfor block_number in range(block_start, block_end + 1):\n    block = web3.eth.getBlock(block_number, full_transactions=True)\n\n    # 遍历区块中的所有交易\n    for tx in block.transactions:\n        # 如果交易是发送到合约地址\n        if tx.to == contract_address:\n            # 解析交易的input数据，检查是否是函数调用\n            input_data = tx.input\n            print(f\"Transaction Hash: {tx.hash.hex()}\")\n\n            # 使用ABI来解码交易数据\n            decoded_input = contract.decode_function_input(input_data)\n            function_name = decoded_input[0].fn.__name__\n            print(f\"Called function: {function_name}\")\n            print(f\"Function Arguments: {decoded_input[1]}\")\n            \n# 遍历\nfor tx_hash in latest_block['transactions']:\n    tx = w3.eth.get_transaction(tx_hash)\n    print(f\"from: {tx['from']}\")\n\n    # \n    if tx['to'] is None:\n        print(f\"Transaction {tx_hash.hex()} is a contract deployment.\")\n    else:\n        print(f\"Transaction {tx_hash.hex()} is a contract function call to {tx['to']}.\")\n\n    # \n    receipt = w3.eth.get_transaction_receipt(tx_hash)\n\n    # \n    if receipt['contractAddress']:\n        print(f\"Contract deployed at address {receipt['contractAddress']}\")\n    else:\n        print(\"No contract deployed in this transaction.\")\n\n    # print(f\"Transaction Input Data: {tx['input']}\")\n    \n    # decoded_input = setup.decode_function_input(tx['input'])\n```\n\n##### 交易信息\n\n``` python\n# 打印交易的详细信息\nfor tx_hash in transactions:\n    transaction = web3.eth.get_transaction(tx_hash)\n    print(f\"Transaction Hash: {tx_hash.hex()}\")\n    print(f\"From: {transaction['from']}\")\n    print(f\"To: {transaction['to']}\")\n    print(f\"Value: {web3.fromWei(transaction['value'], 'ether')} ETH\")\n    print(f\"Gas: {transaction['gas']}\")\n    print(f\"Gas Price: {web3.fromWei(transaction['gasPrice'], 'gwei')} Gwei\")\n    print(\"-\" * 40)\n```\n\n\n\n#### 查询事件\n\n``` python\nevent_filter = setup.events.DeployedTarget.create_filter(from_block=1, to_block=1) #DeployedTarget是函数名字\nevents = event_filter.get_all_entries()\n\n# print event\nfor event in events:\n    print(f\"Event: {event.event}\")\n    print(f\"Arguments: {event.args}\")\n```\n\n#### 发送transaction\n\n``` python\n# send transactions\ntx = forgotten.functions.discover(hashed).build_transaction(\n    {\n        'from': my_address,\n        \"gasPrice\": w3.eth.gas_price,  # two ******* hours it took to figure out this was needed.\n        'nonce': w3.eth.get_transaction_count(\"0xEB4B81DE5738a22d24631ABD62f62cEECC268e71\"),\n    }\n)\n\n# needs to be signed as we are executing/writing not just reading\ntx_create = w3.eth.account.sign_transaction(tx, private_key)\ntx_hash = w3.eth.send_raw_transaction(tx_create.raw_transaction)\ntx_receipt = w3.eth.wait_for_transaction_receipt(tx_hash)\nprint(f'Tx successful with hash: { tx_receipt.transactionHash.hex() }')\n```\n\n#### 计算keccak哈希\n\n``` python\nhashed = w3.solidity_keccak(\n    ['uint256', 'uint256', 'address'], \n    [1, 1734258030, \"0x3E698Aba19B29C3fB625966A9631e6cf5C79505e\"]  \n)\n\nprint(f\"Keccak256 Hash: {hashed.hex()}\")\n```\n\n\n\n\n\n## Hack 思维\n\n### 数据范围\n\n输入不合法数据范围\n\n","slug":"CTF知识点","published":1,"updated":"2025-02-04T17:12:24.645Z","comments":1,"layout":"post","photos":[],"_id":"cm6qr0i9h0000yokj1g1k34zr","content":"<h3 id=\"知识点\"><a class=\"anchor\" href=\"#知识点\">#</a> 知识点</h3>\n<p><a href=\"https://ctf101.org/web-exploitation/overview/\">https://ctf101.org/web-exploitation/overview/</a></p>\n<p><a href=\"https://www.youtube.com/watch?v=5C-OtW7C5oU&amp;t=30s\">https://www.youtube.com/watch?v=5C-OtW7C5oU&amp;t=30s</a></p>\n<p><a href=\"https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/flask\">https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/flask</a></p>\n<h3 id=\"练习网站\"><a class=\"anchor\" href=\"#练习网站\">#</a> 练习网站</h3>\n<p>buuctf</p>\n<p><a href=\"https://adworld.xctf.org.cn/\">https://adworld.xctf.org.cn/</a></p>\n<p><a href=\"https://ctflearn.com/challenge/1/browse\">https://ctflearn.com/challenge/1/browse</a></p>\n<p><a href=\"https://www.root-me.org/?lang=en\">https://www.root-me.org/?lang=en</a></p>\n<p><a href=\"https://picoctf.org/\">https://picoctf.org/</a></p>\n<ol>\n<li><a href=\"http://tryhackme.com\">tryhackme.com</a></li>\n<li><a href=\"http://hackthebox.eu\">hackthebox.eu</a></li>\n<li><a href=\"http://overthewire.org\">overthewire.org</a></li>\n<li><a href=\"http://Root-me.org\">Root-me.org</a></li>\n<li><a href=\"http://Ringzer0team.com\">Ringzer0team.com</a></li>\n<li><a href=\"http://Hack.me\">Hack.me</a></li>\n<li><a href=\"http://ctftime.org\">ctftime.org</a></li>\n<li><a href=\"http://picoctf.com\">picoctf.com</a></li>\n<li><a href=\"http://ctf365.com\">ctf365.com</a></li>\n<li><a href=\"http://ctf101.org\">ctf101.org</a></li>\n</ol>\n<h3 id=\"虚拟机\"><a class=\"anchor\" href=\"#虚拟机\">#</a> 虚拟机</h3>\n<p>打开或关闭功能，打开 Hyper V, 然后重启</p>\n<p>下载 kali 的 Hyper V 的 Hyper V 镜像。然后双击 bat 安装。然后就能打开了，点击连接就有 gui</p>\n<h2 id=\"文件\"><a class=\"anchor\" href=\"#文件\">#</a> 文件</h2>\n<h3 id=\"图片文件处理\"><a class=\"anchor\" href=\"#图片文件处理\">#</a> 图片文件处理</h3>\n<p>打开图片</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>eog xxx.jpg</pre></td></tr></table></figure><h4 id=\"hexdump\"><a class=\"anchor\" href=\"#hexdump\">#</a> hexdump</h4>\n<p>hex 中查找 string</p>\n<ul>\n<li>pdf 里面找隐藏</li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>strings xxx.jpg <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> CTFlearn </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>strings <span class=\"token parameter variable\">-n</span> <span class=\"token number\">10</span> xxx.jpg  <span class=\"token comment\"># >= 10 长度的字符串</span></pre></td></tr></table></figure><p>hexdump</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hexdump <span class=\"token parameter variable\">-C</span> Pho.jpg <span class=\"token operator\">|</span> <span class=\"token function\">less</span></pre></td></tr></table></figure><p>python</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin\">file</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TheMessage.txt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>res <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">for</span> ch <span class=\"token keyword\">in</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>ch<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">32</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\tres <span class=\"token operator\">+=</span> <span class=\"token string\">\"0\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\tres <span class=\"token operator\">+=</span> <span class=\"token string\">\"1\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"binwalk\"><a class=\"anchor\" href=\"#binwalk\">#</a> binwalk</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>binwalk <span class=\"token parameter variable\">--dd</span><span class=\"token operator\">=</span>.* xx.jpeg <span class=\"token comment\"># 查看所有隐藏的二进制，DD 可以顺便解压</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>binwalk <span class=\"token parameter variable\">-e</span> xx.jpg <span class=\"token comment\"># 提取文件</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">file</span> * <span class=\"token comment\"># 查看当前目录所有文件类型</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>exiftool xx.jpg <span class=\"token comment\"># 查看更多信息，有 file 里面没有显示完全的</span></pre></td></tr></table></figure><h4 id=\"stegehide\"><a class=\"anchor\" href=\"#stegehide\">#</a> stegehide</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>steghide extract <span class=\"token parameter variable\">-sf</span> xx.jpg</pre></td></tr></table></figure><h3 id=\"二维码\"><a class=\"anchor\" href=\"#二维码\">#</a> 二维码</h3>\n<p>显示二维码</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> zbar-tools</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>zbarimg xx.png</pre></td></tr></table></figure><p>python</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> cv2</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>img <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>imread<span class=\"token punctuation\">(</span><span class=\"token string\">\"qr.png\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>det <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>QRCodeDetector<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>data<span class=\"token punctuation\">,</span> box<span class=\"token punctuation\">,</span> b <span class=\"token operator\">=</span> det<span class=\"token punctuation\">.</span>detectAndDecode<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"python\"><a class=\"anchor\" href=\"#python\">#</a> python</h2>\n<h3 id=\"string\"><a class=\"anchor\" href=\"#string\">#</a> string</h3>\n<p>所有可打印字符</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>string<span class=\"token punctuation\">.</span>printable</pre></td></tr></table></figure><h3 id=\"提取flag\"><a class=\"anchor\" href=\"#提取flag\">#</a> 提取 flag</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> re</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">extract_flag_from_string</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">match</span> <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">(</span><span class=\"token string\">r'flag\\&#123;[^&#125;]+&#125;'</span><span class=\"token punctuation\">,</span> string<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token keyword\">match</span><span class=\"token punctuation\">.</span>group<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">if</span> <span class=\"token keyword\">match</span> <span class=\"token keyword\">else</span> <span class=\"token boolean\">None</span></pre></td></tr></table></figure><h3 id=\"crypto\"><a class=\"anchor\" href=\"#crypto\">#</a> Crypto</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pip install pycryptodome</pre></td></tr></table></figure><h4 id=\"计算两个byte的xor\"><a class=\"anchor\" href=\"#计算两个byte的xor\">#</a> 计算两个 byte 的 xor</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">xor</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token builtin\">bytearray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>x <span class=\"token operator\">^</span> y <span class=\"token keyword\">for</span> x<span class=\"token punctuation\">,</span>y <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"urlencode\"><a class=\"anchor\" href=\"#urlencode\">#</a> urlencode</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> urllib<span class=\"token punctuation\">.</span>parse</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 字典格式的数</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>data <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'张三'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'age'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">25</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 使用 urlencode 进行编码</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>encoded_data <span class=\"token operator\">=</span> urllib<span class=\"token punctuation\">.</span>parse<span class=\"token punctuation\">.</span>urlencode<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>encoded_data<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"git\"><a class=\"anchor\" href=\"#git\">#</a> Git</h2>\n<p>查看历史 log</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">git</span> log</pre></td></tr></table></figure><p>查看 commit 改变了什么</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">git</span> show</pre></td></tr></table></figure><h2 id=\"linux\"><a class=\"anchor\" href=\"#linux\">#</a> Linux</h2>\n<h4 id=\"解压\"><a class=\"anchor\" href=\"#解压\">#</a> 解压</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">unzip</span> x.zip</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">unrar</span> x x.rar</pre></td></tr></table></figure><h3 id=\"查看ls\"><a class=\"anchor\" href=\"#查看ls\">#</a> 查看 ls</h3>\n<p>打印所有文件夹内容</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ls</span> <span class=\"token parameter variable\">-la</span> *</pre></td></tr></table></figure><p>查找</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> / <span class=\"token parameter variable\">-name</span> *.txt</pre></td></tr></table></figure><h1 id=\"密码学\"><a class=\"anchor\" href=\"#密码学\">#</a> 密码学</h1>\n<p>online 的工具</p>\n<p><a href=\"https://gchq.github.io/CyberChef/\">https://gchq.github.io/CyberChef/</a></p>\n<p><a href=\"https://www.dcode.fr/en\">https://www.dcode.fr/en</a></p>\n<p>加密</p>\n<p><a href=\"https://www.boxentriq.com/code-breaking/cipher-identifier\">https://www.boxentriq.com/code-breaking/cipher-identifier</a></p>\n<h3 id=\"2进制到hex\"><a class=\"anchor\" href=\"#2进制到hex\">#</a> 2 进制到 hex</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>x <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>bc<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><h4 id=\"hex转换\"><a class=\"anchor\" href=\"#hex转换\">#</a> hex 转换</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> binascii <span class=\"token keyword\">import</span> unhexlify</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>hexstr <span class=\"token operator\">=</span> <span class=\"token string\">\"41 42 43 54 46 7B 34 35 43 31 31 5F 31 35 5F 55 35 33 46 55 4C 7D\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>hexs <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>hexstr<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>unhexlify<span class=\"token punctuation\">(</span>hexs<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"输入bytes\"><a class=\"anchor\" href=\"#输入bytes\">#</a> 输入 bytes</h4>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>s <span class=\"token operator\">=</span> <span class=\"token string\">\"f\\nk\\fw&amp;O.@\\x11x\\rZ;U\\x11p\\x19F\\x1Fv\\\"M\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>a <span class=\"token operator\">=</span> <span class=\"token function\">bytearray</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">.</span><span class=\"token function\">encode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"字符串转换字符数组\"><a class=\"anchor\" href=\"#字符串转换字符数组\">#</a> 字符串转换字符数组</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>char_array <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"your_string\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>string <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>char_array<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"交换大小写\"><a class=\"anchor\" href=\"#交换大小写\">#</a> 交换大小写</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token string\">\"asb\"</span><span class=\"token punctuation\">.</span>swapcase<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><code>c.isalpha()</code> ：判断  <code>c</code>  是否是字母。</p>\n<p><code>c.isupper()</code> ：判断  <code>c</code>  是否是大写字母。</p>\n<p><code>c.islower()</code> ：判断  <code>c</code>  是否是小写字母</p>\n<h3 id=\"base64\"><a class=\"anchor\" href=\"#base64\">#</a> base64</h3>\n<p>shell</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>base64 <span class=\"token parameter variable\">-d</span> xxx</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"c3ludCB2ZiA6IGEwX29icWxfczBldHJnX2RlX3BicXI=\"</span> <span class=\"token operator\">|</span> base64 <span class=\"token parameter variable\">-d</span></pre></td></tr></table></figure><p>python</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> base64 <span class=\"token keyword\">import</span> decodebytes</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>s <span class=\"token operator\">=</span> decodebytes<span class=\"token punctuation\">(</span><span class=\"token string\">\"Q1RGe0ZsYWdneVdhZ2d5UmFnZ3l9\"</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>cyberchef 的 label 和 jump 可以实现循环解密</p>\n<p>原理：</p>\n<p><strong>将二进制数据转换为 6 位块：</strong></p>\n<ul>\n<li>每个字节有 8 位，3 个字节一共是 24 位。</li>\n<li>将这 24 位拆分为 4 个 6 位的块。</li>\n</ul>\n<p><strong>将 6 位的数据映射到 Base64 字符表：</strong></p>\n<ul>\n<li><code>A-Za-z0-9+/</code></li>\n</ul>\n<p>如果输入数据的字节数不是 3 的倍数，编码过程会用  <code>=</code>  字符进行填充，使输出数据的长度是 4 字节的倍数。</p>\n<p>在后面每次填一个 byte (0) 直到是 3 的倍数，然后 base64 加密，最后把由加入新 0 产生的 A 换成 = 就好了</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">b64en</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">,</span> table<span class=\"token operator\">=</span><span class=\"token string\">\"default\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">if</span> table <span class=\"token operator\">==</span> <span class=\"token string\">\"default\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        table <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            table <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'A'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            table <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            table <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        table <span class=\"token operator\">+=</span> <span class=\"token string\">\"+/\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    s <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    lens <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    s <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">.</span>from_bytes<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    s <span class=\"token operator\">=</span> <span class=\"token builtin\">bin</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> lens<span class=\"token operator\">*</span><span class=\"token number\">8</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        s <span class=\"token operator\">=</span> <span class=\"token string\">\"0\"</span> <span class=\"token operator\">+</span> s</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    needed <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">3</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        s <span class=\"token operator\">+=</span> <span class=\"token string\">\"00000000\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        needed <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    s <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    i <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    ans <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">while</span> i <span class=\"token operator\">&lt;</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        x <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            x <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x<span class=\"token operator\">&lt;&lt;</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> s<span class=\"token punctuation\">[</span>i<span class=\"token operator\">+</span>j<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        ans<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>table<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        i <span class=\"token operator\">+=</span> <span class=\"token number\">6</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>needed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        ans<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>needed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        ans <span class=\"token operator\">+=</span> <span class=\"token string\">\"=\"</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>ans<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">b64de</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">,</span> table<span class=\"token operator\">=</span><span class=\"token string\">\"default\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token keyword\">if</span> table <span class=\"token operator\">==</span> <span class=\"token string\">\"default\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        table <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            table <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'A'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            table <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            table <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        table <span class=\"token operator\">+=</span> <span class=\"token string\">\"+/\"</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    s <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    needed <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token keyword\">while</span> s<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"=\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        s<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        needed <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>needed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        s <span class=\"token operator\">+=</span> table<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    a <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        x <span class=\"token operator\">=</span> table<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        toa <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>            <span class=\"token keyword\">if</span> x<span class=\"token operator\">>></span>j<span class=\"token operator\">&amp;</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>                toa <span class=\"token operator\">=</span> <span class=\"token string\">\"1\"</span> <span class=\"token operator\">+</span> toa</pre></td></tr><tr><td data-num=\"63\"></td><td><pre>            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>                toa <span class=\"token operator\">=</span> <span class=\"token string\">\"0\"</span> <span class=\"token operator\">+</span> toa</pre></td></tr><tr><td data-num=\"65\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"66\"></td><td><pre>        a <span class=\"token operator\">+=</span> toa</pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    a <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>needed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>        <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>            a<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    i <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>    ans <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    <span class=\"token keyword\">while</span> i <span class=\"token operator\">&lt;</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>        x <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>        <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>            x <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x<span class=\"token operator\">&lt;&lt;</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> a<span class=\"token punctuation\">[</span>i<span class=\"token operator\">+</span>j<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>        ans<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>        i <span class=\"token operator\">+=</span> <span class=\"token number\">8</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>    ans <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>ans<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    <span class=\"token keyword\">return</span> ans</pre></td></tr></table></figure><h4 id=\"dtmf-声调\"><a class=\"anchor\" href=\"#dtmf-声调\">#</a> DTMF 声调</h4>\n<p><a href=\"https://dtmf.netlify.app/\">https://dtmf.netlify.app/</a></p>\n<h2 id=\"不同种类的密码\"><a class=\"anchor\" href=\"#不同种类的密码\">#</a> 不同种类的密码</h2>\n<h4 id=\"vigenere-cipher\"><a class=\"anchor\" href=\"#vigenere-cipher\">#</a> Vigenere Cipher</h4>\n<p>一种凯撒密码</p>\n<p>key 是  <code>OCU</code>  那么第一个字符被移动了 O (14) 次，第二个字符被移动了  <code>C</code>  (2) 次</p>\n<h4 id=\"caesar-cipher\"><a class=\"anchor\" href=\"#caesar-cipher\">#</a> CAESAR Cipher</h4>\n<p>在线暴力破解</p>\n<p><a href=\"https://www.dcode.fr/caesar-cipher\">https://www.dcode.fr/caesar-cipher</a></p>\n<h4 id=\"keyboard-shift\"><a class=\"anchor\" href=\"#keyboard-shift\">#</a> keyboard shift</h4>\n<p><code>BUH'tdy,|Bim5y~Bdt76yQ</code>  长这样，有可能下划线不被解密</p>\n<p><a href=\"https://www.dcode.fr/keyboard-shift-cipher\">https://www.dcode.fr/keyboard-shift-cipher</a></p>\n<h4 id=\"bacon-cipher\"><a class=\"anchor\" href=\"#bacon-cipher\">#</a> bacon cipher</h4>\n<h4 id=\"与佛论禅\"><a class=\"anchor\" href=\"#与佛论禅\">#</a> 与佛论禅</h4>\n<p><a href=\"https://www.keyfc.net/bbs/tools/tudoucode.aspx\">https://www.keyfc.net/bbs/tools/tudoucode.aspx</a></p>\n<p>密语是 <code>佛曰：</code>  开头的</p>\n<h4 id=\"rot13\"><a class=\"anchor\" href=\"#rot13\">#</a> rot13</h4>\n<p><a href=\"https://www.rot13.de/index.php\">https://www.rot13.de/index.php</a></p>\n<h3 id=\"enigma-cryptogarphy\"><a class=\"anchor\" href=\"#enigma-cryptogarphy\">#</a> enigma cryptogarphy</h3>\n<p><a href=\"https://cryptii.com/pipes/enigma-machine\">https://cryptii.com/pipes/enigma-machine</a></p>\n<h4 id=\"playfair-cipher\"><a class=\"anchor\" href=\"#playfair-cipher\">#</a> Playfair cipher</h4>\n<p>通常有一个表格表示密钥</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.16em\" columnalign=\"left left left left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>Q</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>W</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>E</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>R</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>T</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>Y</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>U</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>I</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>O</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>P</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>A</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>S</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>D</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>F</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>G</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>H</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>K</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>L</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>Z</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>X</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>C</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>V</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>B</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>N</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>M</mi></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{array}{lllll}\nQ &amp; W &amp; E &amp; R &amp; T \\\\\nY &amp; U &amp; I &amp; O &amp; P \\\\\nA &amp; S &amp; D &amp; F &amp; G \\\\\nH &amp; K &amp; L &amp; Z &amp; X \\\\\nC &amp; V &amp; B &amp; N &amp; M\n\\end{array}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:6em;vertical-align:-2.75em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span></span></span></span></span></span></span></p>\n<p><a href=\"https://www.boxentriq.com/code-breaking/playfair-cipher\">https://www.boxentriq.com/code-breaking/playfair-cipher</a></p>\n<h3 id=\"brute-force\"><a class=\"anchor\" href=\"#brute-force\">#</a> brute force</h3>\n<p>暴力 key 的长度，然后暴力，使得 xor 后的 string 有  <code>flag</code></p>\n<h4 id=\"sha1\"><a class=\"anchor\" href=\"#sha1\">#</a> sha1</h4>\n<p>这个里面的  <code>0x8004u</code>  就是 sha1 加密的标志</p>\n<p><a href=\"http://www.ttmd5.com/hash.php?type=5\">http://www.ttmd5.com/hash.php?type=5</a></p>\n<h4 id=\"md5\"><a class=\"anchor\" href=\"#md5\">#</a> Md5</h4>\n<p>这个里面的  <code>0x8003u</code>  就是 sha1 加密的标志</p>\n<p><a href=\"https://hashes.com/en/decrypt/hash\">https://hashes.com/en/decrypt/hash</a></p>\n<p><a href=\"https://md5.gromweb.com/?md5=b74dec4f39d35b6a2e6c48e637c8aedb\">https://md5.gromweb.com/?md5=b74dec4f39d35b6a2e6c48e637c8aedb</a></p>\n<p><a href=\"https://www.somd5.com/\">https://www.somd5.com/</a></p>\n<p>可以直接 google MD5 值，看有没有解密</p>\n<h3 id=\"discrete-logarithm\"><a class=\"anchor\" href=\"#discrete-logarithm\">#</a> Discrete logarithm</h3>\n<p>如果 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">p-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 的质数分解比较小，那么可以解出来</p>\n<p><a href=\"https://github.com/idekctf/idekctf-2024/blob/main/crypto/goldenticket/debug/solve.py\">https://github.com/idekctf/idekctf-2024/blob/main/crypto/goldenticket/debug/solve.py</a></p>\n<p>sage 有一个函数  <code>discrete_log_lambda</code>  可以对一个区间计算答案，复杂度是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msqrt><mrow><mi>l</mi><mi>e</mi><mi>n</mi></mrow></msqrt><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\sqrt{len})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1822em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9322em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-2.8922em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewbox=\"0 0 400000 1080\" preserveaspectratio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1078em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 级别，之后再用 CRT 合并出大答案</p>\n<figure class=\"highlight py\"><figcaption data-lang=\"Python\"><span>y</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">PH_partial</span><span class=\"token punctuation\">(</span>h<span class=\"token punctuation\">,</span> g<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">,</span> fact_phi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token triple-quoted-string string\">\"\"\"Returns (x, m), where</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    - x is the dlog of h in base g, mod m</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    - m = lcm(pi^ei) for (pi, ei) in fact_phi</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    \"\"\"</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    res <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    mod <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    F <span class=\"token operator\">=</span> GF<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    phi <span class=\"token operator\">=</span> p<span class=\"token operator\">-</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">for</span> pi<span class=\"token punctuation\">,</span> ei <span class=\"token keyword\">in</span> fact_phi<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        gi <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">,</span> phi<span class=\"token operator\">//</span><span class=\"token punctuation\">(</span>pi<span class=\"token operator\">**</span>ei<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        hi <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>h<span class=\"token punctuation\">,</span> phi<span class=\"token operator\">//</span><span class=\"token punctuation\">(</span>pi<span class=\"token operator\">**</span>ei<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        xi <span class=\"token operator\">=</span> discrete_log_lambda<span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">(</span>hi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> F<span class=\"token punctuation\">(</span>gi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> bounds <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> pi<span class=\"token operator\">**</span>ei<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        res<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>xi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        mod<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>pi<span class=\"token operator\">**</span>ei<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    x<span class=\"token punctuation\">,</span> m <span class=\"token operator\">=</span> CRT<span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> mod<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> lcm<span class=\"token punctuation\">(</span>mod<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">assert</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">,</span> x <span class=\"token operator\">*</span> phi<span class=\"token operator\">//</span>m<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>h<span class=\"token punctuation\">,</span> phi<span class=\"token operator\">//</span>m<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">return</span> x<span class=\"token punctuation\">,</span> m</pre></td></tr></table></figure><h1 id=\"web\"><a class=\"anchor\" href=\"#web\">#</a> Web</h1>\n<h4 id=\"信息收集\"><a class=\"anchor\" href=\"#信息收集\">#</a> 信息收集</h4>\n<p>从 HTTP 头中的 Server 字段可以了解用了什么服务器</p>\n<p>敏感目录：</p>\n<ul>\n<li><code>.git</code></li>\n<li><code>svn</code></li>\n<li><code>idea</code></li>\n</ul>\n<p>工具</p>\n<ul>\n<li>dirsearch</li>\n<li>ffuf</li>\n</ul>\n<h3 id=\"sql-注入\"><a class=\"anchor\" href=\"#sql-注入\">#</a> SQL 注入</h3>\n<h4 id=\"数字型注入\"><a class=\"anchor\" href=\"#数字型注入\">#</a> 数字型注入</h4>\n<p><code>?id=1</code>  和  <code>?id=2-1</code>  是一样的</p>\n<h2 id=\"pwn\"><a class=\"anchor\" href=\"#pwn\">#</a> PWN</h2>\n<h4 id=\"pwn-tool\"><a class=\"anchor\" href=\"#pwn-tool\">#</a> pwn tool</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pip <span class=\"token function\">install</span> pwmtools</pre></td></tr></table></figure><h4 id=\"recv\"><a class=\"anchor\" href=\"#recv\">#</a> recv</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>con<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"ready? Y/N : \"</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>con<span class=\"token punctuation\">.</span>recvline_startswith<span class=\"token punctuation\">(</span><span class=\"token string\">\"Computer\"</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 一直到有一个符合的</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>con<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"send\"><a class=\"anchor\" href=\"#send\">#</a> send</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>con<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'Y'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"连接\"><a class=\"anchor\" href=\"#连接\">#</a> 连接</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> pwn</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>con <span class=\"token operator\">=</span> pwn<span class=\"token punctuation\">.</span>remote<span class=\"token punctuation\">(</span><span class=\"token string\">\"thekidofarcrania.com\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10001</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>s <span class=\"token operator\">=</span> con<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"ready? Y/N : \"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"post-request\"><a class=\"anchor\" href=\"#post-request\">#</a> Post Request</h3>\n<h4 id=\"curl\"><a class=\"anchor\" href=\"#curl\">#</a> curl</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-X</span> POST <span class=\"token parameter variable\">-d</span> <span class=\"token string\">\"username=admin&amp;password=71urlkufpsdnlkadsf\"</span> http://165.227.106.113/post.php</pre></td></tr></table></figure><h3 id=\"burpsuite\"><a class=\"anchor\" href=\"#burpsuite\">#</a> Burpsuite</h3>\n<p>install</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> burpsuite</pre></td></tr></table></figure><p>打开之后点 Proxy, 然后点 intercept on, 然后 open browser 打开连接就可以获得对应的请求</p>\n<h4 id=\"header\"><a class=\"anchor\" href=\"#header\">#</a> header</h4>\n<p>可以右键发送到 repeater 里面</p>\n<p>然后在里面改 header</p>\n<h4 id=\"referer\"><a class=\"anchor\" href=\"#referer\">#</a> referer</h4>\n<p>表示从哪里来的</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Referer:awesomesauce.com</pre></td></tr></table></figure><h4 id=\"python插件\"><a class=\"anchor\" href=\"#python插件\">#</a> python 插件</h4>\n<p>Repeater 里面右键，extension，里面可以复制为 python 的 request</p>\n<h3 id=\"开发者工具\"><a class=\"anchor\" href=\"#开发者工具\">#</a> 开发者工具</h3>\n<h4 id=\"storage\"><a class=\"anchor\" href=\"#storage\">#</a> Storage</h4>\n<p>可以看到存储的信息</p>\n<h2 id=\"网站\"><a class=\"anchor\" href=\"#网站\">#</a> 网站</h2>\n<h3 id=\"robotstxt\"><a class=\"anchor\" href=\"#robotstxt\">#</a>  <code>robots.txt</code></h3>\n<p>去网站的 <a href=\"https://ctflearn.com/robots.txt\">https://ctflearn.com/robots.txt</a> 可以看到不允许的网页</p>\n<h4 id=\"wikipedia\"><a class=\"anchor\" href=\"#wikipedia\">#</a> wikipedia</h4>\n<p><a href=\"https://en.wikipedia.org/\">https://en.wikipedia.org/</a></p>\n<p>用 diff 可以看到修改的信息</p>\n<h4 id=\"备份文件名\"><a class=\"anchor\" href=\"#备份文件名\">#</a> 备份文件名</h4>\n<p><code>.git .svn .swp .svn .~ .bak .bash_history</code></p>\n<h3 id=\"dirsearch\"><a class=\"anchor\" href=\"#dirsearch\">#</a> dirsearch</h3>\n<p>可以看网页的目录</p>\n<p><a href=\"https://github.com/maurosoria/dirsearch\">https://github.com/maurosoria/dirsearch</a></p>\n<h4 id=\"更改网页源代码\"><a class=\"anchor\" href=\"#更改网页源代码\">#</a> 更改网页源代码</h4>\n<p>可以把 disable 的按钮改成可以按下去</p>\n<p>用 hackbar 可以发送 post 请求</p>\n<h4 id=\"查找网站的隐藏连接\"><a class=\"anchor\" href=\"#查找网站的隐藏连接\">#</a> 查找网站的隐藏连接</h4>\n<h4 id=\"gobuster\"><a class=\"anchor\" href=\"#gobuster\">#</a> gobuster</h4>\n<h4 id=\"查找历史网页状态\"><a class=\"anchor\" href=\"#查找历史网页状态\">#</a> 查找历史网页状态</h4>\n<p>wayback machinehttps://web.archive.org/</p>\n<h2 id=\"php\"><a class=\"anchor\" href=\"#php\">#</a> PHP</h2>\n<h4 id=\"判断相等\"><a class=\"anchor\" href=\"#判断相等\">#</a> 判断相等</h4>\n<p><code>==, &gt;</code>  是弱类型判断，会先转换类型再判断，所以  <code>a=123abc</code>  会变成  <code>123</code></p>\n<h4 id=\"反序列化\"><a class=\"anchor\" href=\"#反序列化\">#</a> 反序列化</h4>\n<p>序列化：把对象转成字符串存储。反序列化：把字符串转成对象</p>\n<p><code>__wakeup()</code>  是在序列化的时候执行的</p>\n<pre><code class=\"language-php+HTML\">&lt;?php \nclass xctf&#123;\npublic $flag = '111';\npublic function __wakeup()&#123;\nexit('bad requests');\n&#125;\n&#125;\n$a = new xctf();\n$c = serialize($a);\necho $c\n?&gt; \n</code></pre>\n<p>输出是  <code>O:4:&quot;xctf&quot;:1:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code>  现在要绕过这个 exit 方法，改成 2 就行</p>\n<h4 id=\"think-php-rce\"><a class=\"anchor\" href=\"#think-php-rce\">#</a> THINK PHP RCE</h4>\n<p>RCE 是 remote code execution，在 github 上搜索 think php5 可以找到漏洞</p>\n<h3 id=\"文件上传\"><a class=\"anchor\" href=\"#文件上传\">#</a> 文件上传</h3>\n<p><a href=\"https://www.cnblogs.com/xhds/p/12218471.html\">https://www.cnblogs.com/xhds/p/12218471.html</a></p>\n<h1 id=\"misc\"><a class=\"anchor\" href=\"#misc\">#</a> misc</h1>\n<h4 id=\"在线工具\"><a class=\"anchor\" href=\"#在线工具\">#</a> 在线工具</h4>\n<p><a href=\"https://www.ilovepdf.com/zh-cn\">https://www.ilovepdf.com/zh-cn</a> , <a href=\"https://pdf2doc.com/\">https://pdf2doc.com/</a> PDF 转换</p>\n<p><a href=\"https://georgeom.net/StegOnline/checklist\">https://georgeom.net/StegOnline/checklist</a> checklist steg</p>\n<h3 id=\"隐写术\"><a class=\"anchor\" href=\"#隐写术\">#</a> 隐写术</h3>\n<h4 id=\"文件附加\"><a class=\"anchor\" href=\"#文件附加\">#</a> 文件附加</h4>\n<h4 id=\"png\"><a class=\"anchor\" href=\"#png\">#</a> PNG</h4>\n<p>开头是</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"><span>t</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>89 50 4E 47 0D 0A 1A 0A</pre></td></tr></table></figure><p>IEND 是</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"><span>t</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>00 00 00 00 49 45 4E AE 42 60 82</pre></td></tr></table></figure><p>查看 metadata 在 linux 上:</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>exiftool xxx.png</pre></td></tr></table></figure><h4 id=\"jpeg\"><a class=\"anchor\" href=\"#jpeg\">#</a> JPEG</h4>\n<ul>\n<li>头  <code>FF D8 FF</code></li>\n<li>尾  <code>FF D9</code></li>\n</ul>\n<h4 id=\"gif\"><a class=\"anchor\" href=\"#gif\">#</a> GIF</h4>\n<p>拆分图片工具：stegsolve 分离图片（先 open 再 analyse-frame browser）</p>\n<ul>\n<li><code>47 49 46 38</code></li>\n<li><code>00 3B</code></li>\n</ul>\n<h4 id=\"zip\"><a class=\"anchor\" href=\"#zip\">#</a> ZIP</h4>\n<ul>\n<li><code>50 4B 03 04</code></li>\n<li><code>50 4B</code></li>\n</ul>\n<h4 id=\"rar\"><a class=\"anchor\" href=\"#rar\">#</a> RAR</h4>\n<ul>\n<li><code>52 61 72 21</code></li>\n</ul>\n<h4 id=\"wave\"><a class=\"anchor\" href=\"#wave\">#</a> WAVE</h4>\n<ul>\n<li><code>57 41 56 45</code></li>\n</ul>\n<h4 id=\"avi\"><a class=\"anchor\" href=\"#avi\">#</a> AVI</h4>\n<ul>\n<li><code>41 56 49 20</code></li>\n</ul>\n<h3 id=\"lsb\"><a class=\"anchor\" href=\"#lsb\">#</a> LSB</h3>\n<p>Least significant bit 在图片的最低有效位上写入信息</p>\n<p>Stegsolve , zsteg 工具可以识别</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> zsteg</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>zsteg cats.png</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>zsteg xx.bmp <span class=\"token parameter variable\">-b</span> <span class=\"token number\">1</span> <span class=\"token parameter variable\">-a</span> yx <span class=\"token parameter variable\">-v</span></pre></td></tr></table></figure><p>python 脚本</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> bitarray <span class=\"token keyword\">import</span> bitarray</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> cv2</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">LSBtoBytes</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\"># index 0,1,2 = r,g,b</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    im <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>imread<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">for</span> row <span class=\"token keyword\">in</span> im<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">for</span> col <span class=\"token keyword\">in</span> row<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            data<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>col<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">return</span> bitarray<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>tobytes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">LSBtoImg</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    im <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>imread<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span>row <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">for</span> j<span class=\"token punctuation\">,</span>col <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">if</span> col<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                im<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                im<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token comment\"># cv2.imwrite(\"out.png\",im)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">return</span> im</pre></td></tr></table></figure><p>LSB 可能 RG， GB 之类的组合使用</p>\n<h4 id=\"隐写思路\"><a class=\"anchor\" href=\"#隐写思路\">#</a> 隐写思路</h4>\n<ul>\n<li>\n<p>图片结构改变： 结尾加东西， <code>zsteg</code></p>\n<p>提取文件：  <code>zsteg -e &quot;b1,rgb,lsb,xy&quot; xx.png &gt; flag.png</code></p>\n<p>Chunks 改变：用  <code>pngcheck</code>  检查</p>\n</li>\n<li>\n<p>LSB 隐写： 对应工具</p>\n</li>\n</ul>\n<h3 id=\"盲水印\"><a class=\"anchor\" href=\"#盲水印\">#</a> 盲水印</h3>\n<p>在不同与域上隐藏信息，在图片傅里叶变换后。把信息添加到 “噪声” 中，再逆变换回去就不会对原图片产生大变化</p>\n<p>工具:  <code>BlindWaterMark</code></p>\n<h4 id=\"现成的隐写工具\"><a class=\"anchor\" href=\"#现成的隐写工具\">#</a> 现成的隐写工具</h4>\n<ul>\n<li>\n<p>Jphide: JPG</p>\n</li>\n<li>\n<p>Outguess: JPG</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>outguess <span class=\"token parameter variable\">-k</span> <span class=\"token string\">\"key\"</span> <span class=\"token parameter variable\">-r</span> file.jpg out.txt <span class=\"token comment\"># decode</span></pre></td></tr></table></figure></li>\n<li>\n<p>Steghide: support for JPEG, BMP, WAV and AU files</p>\n</li>\n<li>\n<p>F5-steganography: BMP, GIF, or JPEG</p>\n</li>\n<li>\n<p>invisible secrets</p>\n</li>\n<li>\n<p>wbs43open</p>\n</li>\n<li>\n<p>stegosuite</p>\n</li>\n<li>\n<p>cloacked-pixel</p>\n</li>\n<li>\n<p>Slient-Eye</p>\n</li>\n</ul>\n<p>暴力工具</p>\n<p><code>DominicBreuker/stego-toolkit</code></p>\n<h3 id=\"压缩文件\"><a class=\"anchor\" href=\"#压缩文件\">#</a> 压缩文件</h3>\n<h4 id=\"zip-文件\"><a class=\"anchor\" href=\"#zip-文件\">#</a> ZIP 文件</h4>\n<ul>\n<li>数据区 (504B0304)\n<ul>\n<li>解压要的版本</li>\n<li>flags</li>\n<li>压缩算法</li>\n<li>文件修改时间</li>\n<li>CRC32</li>\n<li>压缩前与后大小</li>\n<li>文件名长度和内容</li>\n<li>文件数据</li>\n</ul>\n</li>\n<li>核心目录区 (504B0102)</li>\n<li>核心目录结束区 (504B0506)</li>\n</ul>\n<h4 id=\"pdf-文件\"><a class=\"anchor\" href=\"#pdf-文件\">#</a> PDF 文件</h4>\n<p>可能藏在图片后面，转 word 或者全选可以看</p>\n<h4 id=\"rar-文件\"><a class=\"anchor\" href=\"#rar-文件\">#</a> RAR 文件</h4>\n<p><code>RAR &lt;=4</code>  的签名  <code>5261172211A0700</code></p>\n<p><code>RAR5</code>  的签名  <code>526172211A070100</code></p>\n<h4 id=\"暴力破解工具\"><a class=\"anchor\" href=\"#暴力破解工具\">#</a> 暴力破解工具</h4>\n<p>windows: ARCHPR</p>\n<p>Linux: fcrackzip, RarCrack</p>\n<p>也可以通过爆破 CRC32 来获得</p>\n<p><code>zip-crc-cracker</code>  ， <code>crc32</code></p>\n<h4 id=\"伪加密\"><a class=\"anchor\" href=\"#伪加密\">#</a> 伪加密</h4>\n<p>ZIP 里面有个通用标记位</p>\n<p>距离  <code>504B0102</code>  偏移 8 byte, 本身占 2 byte，最低位标识是否被加密。只要改回 0 就可以正常打开</p>\n<p>RAR 里面也有</p>\n<p>HeadFlags 从低位起第 3bit 是，但是要重新计算 CRC ( <code>HEAD_CRC</code> )</p>\n<h4 id=\"zip-明文攻击\"><a class=\"anchor\" href=\"#zip-明文攻击\">#</a> ZIP 明文攻击</h4>\n<p>知道内容一些字节可以用，要先确认把呢不能</p>\n<p>可以用  <code>ARCHPR</code>  , 非完整明文  <code>bkcrack</code></p>\n<h3 id=\"音频隐写\"><a class=\"anchor\" href=\"#音频隐写\">#</a> 音频隐写</h3>\n<h4 id=\"工具\"><a class=\"anchor\" href=\"#工具\">#</a> 工具</h4>\n<ul>\n<li>audacity 查看音频</li>\n</ul>\n<h3 id=\"流量分析\"><a class=\"anchor\" href=\"#流量分析\">#</a> 流量分析</h3>\n<p>Wireshark</p>\n<p>统计里面，协议分级可以看流量包的比例</p>\n<p>会话里面会有地址</p>\n<p>过滤器</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ip.src <span class=\"token operator\">==</span> xxx.xx.xx.xx</pre></td></tr></table></figure><p>也可以右键作为过滤器应用</p>\n<h4 id=\"http\"><a class=\"anchor\" href=\"#http\">#</a> HTTP</h4>\n<p>明文传输的</p>\n<h4 id=\"https\"><a class=\"anchor\" href=\"#https\">#</a> HTTPS</h4>\n<p>添加 TLS，要导入密钥才能看到内容</p>\n<h4 id=\"ftp\"><a class=\"anchor\" href=\"#ftp\">#</a> FTP</h4>\n<p>20，21 端口</p>\n<h4 id=\"dns\"><a class=\"anchor\" href=\"#dns\">#</a> DNS</h4>\n<p>解析网址</p>\n<h3 id=\"usb流量分析\"><a class=\"anchor\" href=\"#usb流量分析\">#</a> USB 流量分析</h3>\n<p>通过 USB 协议传输，从一个地址发送到 host</p>\n<p>键盘是 8 字节，鼠标是 4 字节</p>\n<ul>\n<li>第一个字节是按键按下\n<ul>\n<li><code>00</code>  没有按下， <code>01</code>  按左键， <code>02</code>  按右键</li>\n</ul>\n</li>\n<li>第二个字节是左右偏移\n<ul>\n<li>正是向右移动  <code>n</code>  个像素位</li>\n</ul>\n</li>\n<li>第三个字节是上下偏移\n<ul>\n<li>正是向上移动</li>\n</ul>\n</li>\n</ul>\n<p>键盘流量</p>\n<ul>\n<li>Byte1：控制信息\n<ul>\n<li><code>[Right gui,Right alt,Right shift,Right control,Left Gui,Left Alt,left shift,Left Control]</code></li>\n</ul>\n</li>\n<li>byte3：击键信息</li>\n</ul>\n<h3 id=\"wireshark\"><a class=\"anchor\" href=\"#wireshark\">#</a> wireshark</h3>\n<p>提取流量数据</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> pyshark</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> pyshark<span class=\"token punctuation\">.</span>packet</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> binascii <span class=\"token keyword\">import</span> unhexlify</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>capture <span class=\"token operator\">=</span> pyshark<span class=\"token punctuation\">.</span>FileCapture<span class=\"token punctuation\">(</span><span class=\"token string\">'justapcap.pcap'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>hexstr <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>cnt <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">for</span> packet <span class=\"token keyword\">in</span> capture<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    s <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>packet<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    cur <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\"Name:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\".\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\"1m \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    hexstr <span class=\"token operator\">+=</span> cur</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>hexstr <span class=\"token operator\">=</span> hexstr<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\"exam\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a.png\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"wb\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>unhexlify<span class=\"token punctuation\">(</span>hexstr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"内存取证\"><a class=\"anchor\" href=\"#内存取证\">#</a> 内存取证</h3>\n<h4 id=\"volatility\"><a class=\"anchor\" href=\"#volatility\">#</a> volatility</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> snap <span class=\"token function\">install</span> volatility-phocean</pre></td></tr></table></figure><h4 id=\"确定信息\"><a class=\"anchor\" href=\"#确定信息\">#</a> 确定信息</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>vol.py <span class=\"token parameter variable\">-f</span> memory imageinfo</pre></td></tr></table></figure><p>psxview 查看内存</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>vol.py <span class=\"token parameter variable\">-f</span> memory <span class=\"token parameter variable\">--profile</span><span class=\"token operator\">=</span>Win7SPx86 psxview</pre></td></tr></table></figure><p>pslist 查看运行的进程</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>volatility <span class=\"token parameter variable\">-f</span> mem.mem <span class=\"token parameter variable\">--profile</span><span class=\"token operator\">=</span>Win10x64_1231 pslist</pre></td></tr></table></figure><p>filescan 是打开的文件对象</p>\n<p>dumpfile</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>vol.py <span class=\"token parameter variable\">-f</span> memory <span class=\"token parameter variable\">--profile</span><span class=\"token operator\">=</span>Win7SPx86 prodump <span class=\"token parameter variable\">-p</span> <span class=\"token number\">1384</span> --dump-dir ./dump/</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">file</span> dump/executable.i384.exe</pre></td></tr></table></figure><p>PEB 会保存 PEB 信息</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>vol.py <span class=\"token parameter variable\">-f</span> memory <span class=\"token parameter variable\">--profile</span><span class=\"token operator\">=</span>Win7SPx86 cmdline</pre></td></tr></table></figure><p>是命令行信息</p>\n<p>sockets</p>\n<p>hivelist, hivescan 是注册表</p>\n<p>hashdump 获取用户密码的 hash， mimikatz 插件可以还原 hash</p>\n<h4 id=\"volatitlity-3\"><a class=\"anchor\" href=\"#volatitlity-3\">#</a> volatitlity 3</h4>\n<p>确定信息</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>vol <span class=\"token parameter variable\">-f</span> x.mem windows.info</pre></td></tr></table></figure><h3 id=\"磁盘取证\"><a class=\"anchor\" href=\"#磁盘取证\">#</a> 磁盘取证</h3>\n<h4 id=\"文件系统\"><a class=\"anchor\" href=\"#文件系统\">#</a> 文件系统</h4>\n<p>windows: FAT16, FAT32, NTFS</p>\n<p>Linux: Ext2, Ext3, Ext4</p>\n<h4 id=\"fat1632\"><a class=\"anchor\" href=\"#fat1632\">#</a> Fat16/32</h4>\n<p>16bit 来表示一个簇</p>\n<p>DBR 扇区</p>\n<p><img src=\"/CTF%E7%9F%A5%E8%AF%86%E7%82%B9/image-20240819191436093.png\" alt=\"image-20240819191436093\"></p>\n<h4 id=\"ntfs\"><a class=\"anchor\" href=\"#ntfs\">#</a> NTFS</h4>\n<p>性能优秀，安全性高，可恢复性，文件压缩</p>\n<h1 id=\"osint\"><a class=\"anchor\" href=\"#osint\">#</a> OSINT</h1>\n<p>时光机 web archive</p>\n<h1 id=\"区块链blockchain\"><a class=\"anchor\" href=\"#区块链blockchain\">#</a> 区块链 blockchain</h1>\n<p>IDE：REMIX</p>\n<h4 id=\"windows-安装nc\"><a class=\"anchor\" href=\"#windows-安装nc\">#</a> windows 安装 nc</h4>\n<p>去 nmap 官网下载就行</p>\n<h3 id=\"msgsender\"><a class=\"anchor\" href=\"#msgsender\">#</a> msg.sender</h3>\n<p>当一个外部账户（例如，用户的钱包地址）调用合约中的函数时， <code>msg.sender</code>  会是该外部账户的地址。</p>\n<p>如果一个合约调用另一个合约的函数，那么  <code>msg.sender</code>  将是调用方合约的地址，而不是最终的外部账户。</p>\n<p>例如，如果合约 A 调用合约 B 的函数，合约 B 中的  <code>msg.sender</code>  会是合约 A 的地址，而不是最初发起调用的外部账户。</p>\n<p>当一个函数从合约内部调用另一个合约的函数时， <code>msg.sender</code>  仍然是直接发起调用的那个地址。如果函数调用链中有多个合约调用， <code>msg.sender</code>  始终代表的是当前执行上下文中的调用者。</p>\n<h3 id=\"storage-2\"><a class=\"anchor\" href=\"#storage-2\">#</a> storage</h3>\n<p>在 Solidity 中， <code>storage</code>  是用于存储智能合约中状态变量的数据位置。它是智能合约中非常重要的一部分，用来持久化存储数据，也就是存储在以太坊区块链上的数据。与其他数据存储位置（如  <code>memory</code>  和  <code>stack</code> ）不同， <code>storage</code>  中的数据是持久的，意味着它们在交易执行后会一直存在，直到被更新或删除。每个合约都有自己的  <code>storage</code>  空间。</p>\n<h4 id=\"1-storage-的特点\"><a class=\"anchor\" href=\"#1-storage-的特点\">#</a> 1. <strong> <code>storage</code>  的特点</strong></h4>\n<ul>\n<li><strong>持久性</strong>： <code>storage</code>  中的数据在合约的生命周期内是持久的，意味着它们会被保存在区块链中。即使合约函数执行完成后，数据仍然保留，并且在下一次函数调用时可以访问。</li>\n<li><strong>费用</strong>：在 Solidity 中，将数据写入  <code>storage</code>  是昂贵的操作，因为这需要改变区块链状态并消耗  <code>gas</code> 。相对而言，从  <code>storage</code>  中读取数据的费用要比写入便宜一些。</li>\n<li><strong>每个合约的  <code>storage</code>  空间独立</strong>：每个智能合约都有自己的  <code>storage</code>  空间，且  <code>storage</code>  中的数据可以通过合约的状态变量来访问</li>\n</ul>\n<h4 id=\"slot\"><a class=\"anchor\" href=\"#slot\">#</a> slot</h4>\n<p>Solidity 会将每个状态变量存储在固定的槽（slot）中。每个状态变量占据一定的存储槽，状态变量的存储位置由其在合约中声明的顺序决定。这些槽位在区块链上是固定的</p>\n<h3 id=\"合约交互python\"><a class=\"anchor\" href=\"#合约交互python\">#</a> 合约交互 python</h3>\n<p>先要安装 solc, 然后 pip 安装 <code>web3</code> , <code>py-solc-x</code>  下面是基本配置</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>w3 <span class=\"token operator\">=</span> Web3<span class=\"token punctuation\">(</span>Web3<span class=\"token punctuation\">.</span>HTTPProvider<span class=\"token punctuation\">(</span><span class=\"token string\">'http://94.237.59.45:52415'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">create_abi</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    temp_file <span class=\"token operator\">=</span> solcx<span class=\"token punctuation\">.</span>compile_files<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>name<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">.sol'</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    abi <span class=\"token operator\">=</span> temp_file<span class=\"token punctuation\">[</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>name<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">.sol:</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>name<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'abi'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">return</span> abi</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>setup_abi <span class=\"token operator\">=</span> create_abi<span class=\"token punctuation\">(</span><span class=\"token string\">'Setup'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>fNFT_abi <span class=\"token operator\">=</span> create_abi<span class=\"token punctuation\">(</span><span class=\"token string\">'FrontierNFT'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>fMarket_abi <span class=\"token operator\">=</span> create_abi<span class=\"token punctuation\">(</span><span class=\"token string\">'FrontierMarketplace'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">if</span> w3<span class=\"token punctuation\">.</span>is_connected<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Connected to Ethereum network\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Failed to connect\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>private_key <span class=\"token operator\">=</span> <span class=\"token string\">\"1249bb2c45202146bbe401b6b29848c5f0345e418434eeedaade8dd8bdbb437a\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>my_address <span class=\"token operator\">=</span> <span class=\"token string\">\"0x41b34Fe0b213FF5300D648F875F84B0F016295cc\"</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>fmarket_address <span class=\"token operator\">=</span> <span class=\"token string\">\"0x899c356B0489472c99EF4A46b3893B62Fd73F349\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>setup_address <span class=\"token operator\">=</span> <span class=\"token string\">\"0xD984cF86bfEbb01E62f0729c2Dd5562a852038f4\"</span></pre></td></tr></table></figure><h4 id=\"调用函数\"><a class=\"anchor\" href=\"#调用函数\">#</a> 调用函数</h4>\n<p>不创建新节点</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>setup <span class=\"token operator\">=</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>contract<span class=\"token punctuation\">(</span>address<span class=\"token operator\">=</span>setup_address<span class=\"token punctuation\">,</span> abi<span class=\"token operator\">=</span>setup_abi<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>setup<span class=\"token punctuation\">.</span>functions<span class=\"token punctuation\">.</span>isSolved<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>call<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>setup<span class=\"token punctuation\">.</span>functions<span class=\"token punctuation\">.</span>paramfunc<span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>call<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 有参数的写法</span></pre></td></tr></table></figure><p>读取值，可以把值当成函数</p>\n<h4 id=\"查询block-chain\"><a class=\"anchor\" href=\"#查询block-chain\">#</a> 查询 block chain</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>latest_block <span class=\"token operator\">=</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>get_block<span class=\"token punctuation\">(</span><span class=\"token string\">'latest'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># block_number = 10000000  #</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># latest_block = w3.eth.get_block(0)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># print(block['number']) </span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Latest Block Info:\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Block Number: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'number'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Block Hash: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'hash'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Parent Hash: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'parentHash'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Timestamp: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'timestamp'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Miner: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'miner'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Gas Used: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'gasUsed'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Gas Limit: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'gasLimit'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Transactions Count: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'transactions'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h5 id=\"查询balance\"><a class=\"anchor\" href=\"#查询balance\">#</a> 查询 balance</h5>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 查询该地址的余额（返回值是以 wei 为单位）</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>balance_wei <span class=\"token operator\">=</span> web3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>get_balance<span class=\"token punctuation\">(</span>address<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 将 wei 转换为 ether</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>balance_ether <span class=\"token operator\">=</span> web3<span class=\"token punctuation\">.</span>from_wei<span class=\"token punctuation\">(</span>balance_wei<span class=\"token punctuation\">,</span> <span class=\"token string\">'ether'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"查询transactions\"><a class=\"anchor\" href=\"#查询transactions\">#</a> 查询 transactions</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 查询某个区块范围内的交易</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>block_start <span class=\"token operator\">=</span> <span class=\"token number\">10000000</span>  <span class=\"token comment\"># 起始区块</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>block_end <span class=\"token operator\">=</span> <span class=\"token number\">10001000</span>    <span class=\"token comment\"># 结束区块</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 获取区块范围内的交易</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">for</span> block_number <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>block_start<span class=\"token punctuation\">,</span> block_end <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    block <span class=\"token operator\">=</span> web3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>getBlock<span class=\"token punctuation\">(</span>block_number<span class=\"token punctuation\">,</span> full_transactions<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token comment\"># 遍历区块中的所有交易</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">for</span> tx <span class=\"token keyword\">in</span> block<span class=\"token punctuation\">.</span>transactions<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\"># 如果交易是发送到合约地址</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">if</span> tx<span class=\"token punctuation\">.</span>to <span class=\"token operator\">==</span> contract_address<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token comment\"># 解析交易的 input 数据，检查是否是函数调用</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            input_data <span class=\"token operator\">=</span> tx<span class=\"token punctuation\">.</span><span class=\"token builtin\">input</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Transaction Hash: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>tx<span class=\"token punctuation\">.</span><span class=\"token builtin\">hash</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token comment\"># 使用 ABI 来解码交易数据</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            decoded_input <span class=\"token operator\">=</span> contract<span class=\"token punctuation\">.</span>decode_function_input<span class=\"token punctuation\">(</span>input_data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            function_name <span class=\"token operator\">=</span> decoded_input<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>fn<span class=\"token punctuation\">.</span>__name__</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Called function: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>function_name<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Function Arguments: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>decoded_input<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            </pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\"># 遍历</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">for</span> tx_hash <span class=\"token keyword\">in</span> latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'transactions'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    tx <span class=\"token operator\">=</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>get_transaction<span class=\"token punctuation\">(</span>tx_hash<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"from: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>tx<span class=\"token punctuation\">[</span><span class=\"token string\">'from'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token comment\"># </span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">if</span> tx<span class=\"token punctuation\">[</span><span class=\"token string\">'to'</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Transaction </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>tx_hash<span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> is a contract deployment.\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Transaction </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>tx_hash<span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> is a contract function call to </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>tx<span class=\"token punctuation\">[</span><span class=\"token string\">'to'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">.\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token comment\"># </span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    receipt <span class=\"token operator\">=</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>get_transaction_receipt<span class=\"token punctuation\">(</span>tx_hash<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token comment\"># </span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">if</span> receipt<span class=\"token punctuation\">[</span><span class=\"token string\">'contractAddress'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Contract deployed at address </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>receipt<span class=\"token punctuation\">[</span><span class=\"token string\">'contractAddress'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"No contract deployed in this transaction.\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token comment\"># print(f\"Transaction Input Data: &#123;tx['input']&#125;\")</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token comment\"># decoded_input = setup.decode_function_input(tx['input'])</span></pre></td></tr></table></figure><h5 id=\"交易信息\"><a class=\"anchor\" href=\"#交易信息\">#</a> 交易信息</h5>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 打印交易的详细信息</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">for</span> tx_hash <span class=\"token keyword\">in</span> transactions<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    transaction <span class=\"token operator\">=</span> web3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>get_transaction<span class=\"token punctuation\">(</span>tx_hash<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Transaction Hash: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>tx_hash<span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"From: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>transaction<span class=\"token punctuation\">[</span><span class=\"token string\">'from'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"To: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>transaction<span class=\"token punctuation\">[</span><span class=\"token string\">'to'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Value: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>web3<span class=\"token punctuation\">.</span>fromWei<span class=\"token punctuation\">(</span>transaction<span class=\"token punctuation\">[</span><span class=\"token string\">'value'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ether'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> ETH\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Gas: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>transaction<span class=\"token punctuation\">[</span><span class=\"token string\">'gas'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Gas Price: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>web3<span class=\"token punctuation\">.</span>fromWei<span class=\"token punctuation\">(</span>transaction<span class=\"token punctuation\">[</span><span class=\"token string\">'gasPrice'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'gwei'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> Gwei\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-\"</span> <span class=\"token operator\">*</span> <span class=\"token number\">40</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"查询事件\"><a class=\"anchor\" href=\"#查询事件\">#</a> 查询事件</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>event_filter <span class=\"token operator\">=</span> setup<span class=\"token punctuation\">.</span>events<span class=\"token punctuation\">.</span>DeployedTarget<span class=\"token punctuation\">.</span>create_filter<span class=\"token punctuation\">(</span>from_block<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> to_block<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#DeployedTarget 是函数名字</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>events <span class=\"token operator\">=</span> event_filter<span class=\"token punctuation\">.</span>get_all_entries<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># print event</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">for</span> event <span class=\"token keyword\">in</span> events<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Event: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>event<span class=\"token punctuation\">.</span>event<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Arguments: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>event<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"发送transaction\"><a class=\"anchor\" href=\"#发送transaction\">#</a> 发送 transaction</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># send transactions</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>tx <span class=\"token operator\">=</span> forgotten<span class=\"token punctuation\">.</span>functions<span class=\"token punctuation\">.</span>discover<span class=\"token punctuation\">(</span>hashed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>build_transaction<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token string\">'from'</span><span class=\"token punctuation\">:</span> my_address<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token string\">\"gasPrice\"</span><span class=\"token punctuation\">:</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>gas_price<span class=\"token punctuation\">,</span>  <span class=\"token comment\"># two ******* hours it took to figure out this was needed.</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token string\">'nonce'</span><span class=\"token punctuation\">:</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>get_transaction_count<span class=\"token punctuation\">(</span><span class=\"token string\">\"0xEB4B81DE5738a22d24631ABD62f62cEECC268e71\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># needs to be signed as we are executing/writing not just reading</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>tx_create <span class=\"token operator\">=</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>account<span class=\"token punctuation\">.</span>sign_transaction<span class=\"token punctuation\">(</span>tx<span class=\"token punctuation\">,</span> private_key<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>tx_hash <span class=\"token operator\">=</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>send_raw_transaction<span class=\"token punctuation\">(</span>tx_create<span class=\"token punctuation\">.</span>raw_transaction<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>tx_receipt <span class=\"token operator\">=</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>wait_for_transaction_receipt<span class=\"token punctuation\">(</span>tx_hash<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'Tx successful with hash: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span> tx_receipt<span class=\"token punctuation\">.</span>transactionHash<span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"计算keccak哈希\"><a class=\"anchor\" href=\"#计算keccak哈希\">#</a> 计算 keccak 哈希</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hashed <span class=\"token operator\">=</span> w3<span class=\"token punctuation\">.</span>solidity_keccak<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token punctuation\">[</span><span class=\"token string\">'uint256'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'uint256'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'address'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1734258030</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0x3E698Aba19B29C3fB625966A9631e6cf5C79505e\"</span><span class=\"token punctuation\">]</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Keccak256 Hash: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>hashed<span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"hack-思维\"><a class=\"anchor\" href=\"#hack-思维\">#</a> Hack 思维</h2>\n<h3 id=\"数据范围\"><a class=\"anchor\" href=\"#数据范围\">#</a> 数据范围</h3>\n<p>输入不合法数据范围</p>\n","length":14720,"excerpt":"","more":"<h3 id=\"知识点\"><a class=\"anchor\" href=\"#知识点\">#</a> 知识点</h3>\n<p><a href=\"https://ctf101.org/web-exploitation/overview/\">https://ctf101.org/web-exploitation/overview/</a></p>\n<p><a href=\"https://www.youtube.com/watch?v=5C-OtW7C5oU&amp;t=30s\">https://www.youtube.com/watch?v=5C-OtW7C5oU&amp;t=30s</a></p>\n<p><a href=\"https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/flask\">https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/flask</a></p>\n<h3 id=\"练习网站\"><a class=\"anchor\" href=\"#练习网站\">#</a> 练习网站</h3>\n<p>buuctf</p>\n<p><a href=\"https://adworld.xctf.org.cn/\">https://adworld.xctf.org.cn/</a></p>\n<p><a href=\"https://ctflearn.com/challenge/1/browse\">https://ctflearn.com/challenge/1/browse</a></p>\n<p><a href=\"https://www.root-me.org/?lang=en\">https://www.root-me.org/?lang=en</a></p>\n<p><a href=\"https://picoctf.org/\">https://picoctf.org/</a></p>\n<ol>\n<li><a href=\"http://tryhackme.com\">tryhackme.com</a></li>\n<li><a href=\"http://hackthebox.eu\">hackthebox.eu</a></li>\n<li><a href=\"http://overthewire.org\">overthewire.org</a></li>\n<li><a href=\"http://Root-me.org\">Root-me.org</a></li>\n<li><a href=\"http://Ringzer0team.com\">Ringzer0team.com</a></li>\n<li><a href=\"http://Hack.me\">Hack.me</a></li>\n<li><a href=\"http://ctftime.org\">ctftime.org</a></li>\n<li><a href=\"http://picoctf.com\">picoctf.com</a></li>\n<li><a href=\"http://ctf365.com\">ctf365.com</a></li>\n<li><a href=\"http://ctf101.org\">ctf101.org</a></li>\n</ol>\n<h3 id=\"虚拟机\"><a class=\"anchor\" href=\"#虚拟机\">#</a> 虚拟机</h3>\n<p>打开或关闭功能，打开 Hyper V, 然后重启</p>\n<p>下载 kali 的 Hyper V 的 Hyper V 镜像。然后双击 bat 安装。然后就能打开了，点击连接就有 gui</p>\n<h2 id=\"文件\"><a class=\"anchor\" href=\"#文件\">#</a> 文件</h2>\n<h3 id=\"图片文件处理\"><a class=\"anchor\" href=\"#图片文件处理\">#</a> 图片文件处理</h3>\n<p>打开图片</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>eog xxx.jpg</pre></td></tr></table></figure><h4 id=\"hexdump\"><a class=\"anchor\" href=\"#hexdump\">#</a> hexdump</h4>\n<p>hex 中查找 string</p>\n<ul>\n<li>pdf 里面找隐藏</li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>strings xxx.jpg <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> CTFlearn </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>strings <span class=\"token parameter variable\">-n</span> <span class=\"token number\">10</span> xxx.jpg  <span class=\"token comment\"># >= 10 长度的字符串</span></pre></td></tr></table></figure><p>hexdump</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hexdump <span class=\"token parameter variable\">-C</span> Pho.jpg <span class=\"token operator\">|</span> <span class=\"token function\">less</span></pre></td></tr></table></figure><p>python</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin\">file</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"TheMessage.txt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>res <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">for</span> ch <span class=\"token keyword\">in</span> <span class=\"token builtin\">file</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>ch<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">32</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\tres <span class=\"token operator\">+=</span> <span class=\"token string\">\"0\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\tres <span class=\"token operator\">+=</span> <span class=\"token string\">\"1\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"binwalk\"><a class=\"anchor\" href=\"#binwalk\">#</a> binwalk</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>binwalk <span class=\"token parameter variable\">--dd</span><span class=\"token operator\">=</span>.* xx.jpeg <span class=\"token comment\"># 查看所有隐藏的二进制，DD 可以顺便解压</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>binwalk <span class=\"token parameter variable\">-e</span> xx.jpg <span class=\"token comment\"># 提取文件</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">file</span> * <span class=\"token comment\"># 查看当前目录所有文件类型</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>exiftool xx.jpg <span class=\"token comment\"># 查看更多信息，有 file 里面没有显示完全的</span></pre></td></tr></table></figure><h4 id=\"stegehide\"><a class=\"anchor\" href=\"#stegehide\">#</a> stegehide</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>steghide extract <span class=\"token parameter variable\">-sf</span> xx.jpg</pre></td></tr></table></figure><h3 id=\"二维码\"><a class=\"anchor\" href=\"#二维码\">#</a> 二维码</h3>\n<p>显示二维码</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> zbar-tools</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>zbarimg xx.png</pre></td></tr></table></figure><p>python</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> cv2</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>img <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>imread<span class=\"token punctuation\">(</span><span class=\"token string\">\"qr.png\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>det <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>QRCodeDetector<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>data<span class=\"token punctuation\">,</span> box<span class=\"token punctuation\">,</span> b <span class=\"token operator\">=</span> det<span class=\"token punctuation\">.</span>detectAndDecode<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"python\"><a class=\"anchor\" href=\"#python\">#</a> python</h2>\n<h3 id=\"string\"><a class=\"anchor\" href=\"#string\">#</a> string</h3>\n<p>所有可打印字符</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>string<span class=\"token punctuation\">.</span>printable</pre></td></tr></table></figure><h3 id=\"提取flag\"><a class=\"anchor\" href=\"#提取flag\">#</a> 提取 flag</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> re</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">extract_flag_from_string</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">match</span> <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">(</span><span class=\"token string\">r'flag\\&#123;[^&#125;]+&#125;'</span><span class=\"token punctuation\">,</span> string<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token keyword\">match</span><span class=\"token punctuation\">.</span>group<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">if</span> <span class=\"token keyword\">match</span> <span class=\"token keyword\">else</span> <span class=\"token boolean\">None</span></pre></td></tr></table></figure><h3 id=\"crypto\"><a class=\"anchor\" href=\"#crypto\">#</a> Crypto</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pip install pycryptodome</pre></td></tr></table></figure><h4 id=\"计算两个byte的xor\"><a class=\"anchor\" href=\"#计算两个byte的xor\">#</a> 计算两个 byte 的 xor</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">xor</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token builtin\">bytearray</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>x <span class=\"token operator\">^</span> y <span class=\"token keyword\">for</span> x<span class=\"token punctuation\">,</span>y <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"urlencode\"><a class=\"anchor\" href=\"#urlencode\">#</a> urlencode</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> urllib<span class=\"token punctuation\">.</span>parse</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># 字典格式的数</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>data <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'张三'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'age'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">25</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 使用 urlencode 进行编码</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>encoded_data <span class=\"token operator\">=</span> urllib<span class=\"token punctuation\">.</span>parse<span class=\"token punctuation\">.</span>urlencode<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>encoded_data<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"git\"><a class=\"anchor\" href=\"#git\">#</a> Git</h2>\n<p>查看历史 log</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">git</span> log</pre></td></tr></table></figure><p>查看 commit 改变了什么</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">git</span> show</pre></td></tr></table></figure><h2 id=\"linux\"><a class=\"anchor\" href=\"#linux\">#</a> Linux</h2>\n<h4 id=\"解压\"><a class=\"anchor\" href=\"#解压\">#</a> 解压</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">unzip</span> x.zip</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">unrar</span> x x.rar</pre></td></tr></table></figure><h3 id=\"查看ls\"><a class=\"anchor\" href=\"#查看ls\">#</a> 查看 ls</h3>\n<p>打印所有文件夹内容</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">ls</span> <span class=\"token parameter variable\">-la</span> *</pre></td></tr></table></figure><p>查找</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">find</span> / <span class=\"token parameter variable\">-name</span> *.txt</pre></td></tr></table></figure><h1 id=\"密码学\"><a class=\"anchor\" href=\"#密码学\">#</a> 密码学</h1>\n<p>online 的工具</p>\n<p><a href=\"https://gchq.github.io/CyberChef/\">https://gchq.github.io/CyberChef/</a></p>\n<p><a href=\"https://www.dcode.fr/en\">https://www.dcode.fr/en</a></p>\n<p>加密</p>\n<p><a href=\"https://www.boxentriq.com/code-breaking/cipher-identifier\">https://www.boxentriq.com/code-breaking/cipher-identifier</a></p>\n<h3 id=\"2进制到hex\"><a class=\"anchor\" href=\"#2进制到hex\">#</a> 2 进制到 hex</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>x <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>bc<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><h4 id=\"hex转换\"><a class=\"anchor\" href=\"#hex转换\">#</a> hex 转换</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> binascii <span class=\"token keyword\">import</span> unhexlify</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>hexstr <span class=\"token operator\">=</span> <span class=\"token string\">\"41 42 43 54 46 7B 34 35 43 31 31 5F 31 35 5F 55 35 33 46 55 4C 7D\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>hexs <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>hexstr<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>unhexlify<span class=\"token punctuation\">(</span>hexs<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"输入bytes\"><a class=\"anchor\" href=\"#输入bytes\">#</a> 输入 bytes</h4>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>s <span class=\"token operator\">=</span> <span class=\"token string\">\"f\\nk\\fw&amp;O.@\\x11x\\rZ;U\\x11p\\x19F\\x1Fv\\\"M\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>a <span class=\"token operator\">=</span> <span class=\"token function\">bytearray</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">.</span><span class=\"token function\">encode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"字符串转换字符数组\"><a class=\"anchor\" href=\"#字符串转换字符数组\">#</a> 字符串转换字符数组</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>char_array <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"your_string\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>string <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>char_array<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"交换大小写\"><a class=\"anchor\" href=\"#交换大小写\">#</a> 交换大小写</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token string\">\"asb\"</span><span class=\"token punctuation\">.</span>swapcase<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><code>c.isalpha()</code> ：判断  <code>c</code>  是否是字母。</p>\n<p><code>c.isupper()</code> ：判断  <code>c</code>  是否是大写字母。</p>\n<p><code>c.islower()</code> ：判断  <code>c</code>  是否是小写字母</p>\n<h3 id=\"base64\"><a class=\"anchor\" href=\"#base64\">#</a> base64</h3>\n<p>shell</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>base64 <span class=\"token parameter variable\">-d</span> xxx</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"c3ludCB2ZiA6IGEwX29icWxfczBldHJnX2RlX3BicXI=\"</span> <span class=\"token operator\">|</span> base64 <span class=\"token parameter variable\">-d</span></pre></td></tr></table></figure><p>python</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> base64 <span class=\"token keyword\">import</span> decodebytes</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>s <span class=\"token operator\">=</span> decodebytes<span class=\"token punctuation\">(</span><span class=\"token string\">\"Q1RGe0ZsYWdneVdhZ2d5UmFnZ3l9\"</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>cyberchef 的 label 和 jump 可以实现循环解密</p>\n<p>原理：</p>\n<p><strong>将二进制数据转换为 6 位块：</strong></p>\n<ul>\n<li>每个字节有 8 位，3 个字节一共是 24 位。</li>\n<li>将这 24 位拆分为 4 个 6 位的块。</li>\n</ul>\n<p><strong>将 6 位的数据映射到 Base64 字符表：</strong></p>\n<ul>\n<li><code>A-Za-z0-9+/</code></li>\n</ul>\n<p>如果输入数据的字节数不是 3 的倍数，编码过程会用  <code>=</code>  字符进行填充，使输出数据的长度是 4 字节的倍数。</p>\n<p>在后面每次填一个 byte (0) 直到是 3 的倍数，然后 base64 加密，最后把由加入新 0 产生的 A 换成 = 就好了</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">b64en</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">,</span> table<span class=\"token operator\">=</span><span class=\"token string\">\"default\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">if</span> table <span class=\"token operator\">==</span> <span class=\"token string\">\"default\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        table <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            table <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'A'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            table <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            table <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        table <span class=\"token operator\">+=</span> <span class=\"token string\">\"+/\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    s <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    lens <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    s <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">.</span>from_bytes<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    s <span class=\"token operator\">=</span> <span class=\"token builtin\">bin</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> lens<span class=\"token operator\">*</span><span class=\"token number\">8</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        s <span class=\"token operator\">=</span> <span class=\"token string\">\"0\"</span> <span class=\"token operator\">+</span> s</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    needed <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> <span class=\"token number\">3</span> <span class=\"token operator\">!=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        s <span class=\"token operator\">+=</span> <span class=\"token string\">\"00000000\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        needed <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    s <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    i <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    ans <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">while</span> i <span class=\"token operator\">&lt;</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        x <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            x <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x<span class=\"token operator\">&lt;&lt;</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> s<span class=\"token punctuation\">[</span>i<span class=\"token operator\">+</span>j<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        ans<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>table<span class=\"token punctuation\">[</span>x<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        i <span class=\"token operator\">+=</span> <span class=\"token number\">6</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>needed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        ans<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>needed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        ans <span class=\"token operator\">+=</span> <span class=\"token string\">\"=\"</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>ans<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">b64de</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">,</span> table<span class=\"token operator\">=</span><span class=\"token string\">\"default\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token keyword\">if</span> table <span class=\"token operator\">==</span> <span class=\"token string\">\"default\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        table <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            table <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'A'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">26</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            table <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>            table <span class=\"token operator\">+=</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>        table <span class=\"token operator\">+=</span> <span class=\"token string\">\"+/\"</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    s <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    needed <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token keyword\">while</span> s<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"=\"</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>        s<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>        needed <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>needed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        s <span class=\"token operator\">+=</span> table<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    a <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>        x <span class=\"token operator\">=</span> table<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        toa <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>            <span class=\"token keyword\">if</span> x<span class=\"token operator\">>></span>j<span class=\"token operator\">&amp;</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>                toa <span class=\"token operator\">=</span> <span class=\"token string\">\"1\"</span> <span class=\"token operator\">+</span> toa</pre></td></tr><tr><td data-num=\"63\"></td><td><pre>            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>                toa <span class=\"token operator\">=</span> <span class=\"token string\">\"0\"</span> <span class=\"token operator\">+</span> toa</pre></td></tr><tr><td data-num=\"65\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"66\"></td><td><pre>        a <span class=\"token operator\">+=</span> toa</pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>    a <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>needed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>        <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>            a<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    i <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>    ans <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    <span class=\"token keyword\">while</span> i <span class=\"token operator\">&lt;</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>        x <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>        <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>            x <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x<span class=\"token operator\">&lt;&lt;</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> a<span class=\"token punctuation\">[</span>i<span class=\"token operator\">+</span>j<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>        ans<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>        i <span class=\"token operator\">+=</span> <span class=\"token number\">8</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>    ans <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>ans<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    <span class=\"token keyword\">return</span> ans</pre></td></tr></table></figure><h4 id=\"dtmf-声调\"><a class=\"anchor\" href=\"#dtmf-声调\">#</a> DTMF 声调</h4>\n<p><a href=\"https://dtmf.netlify.app/\">https://dtmf.netlify.app/</a></p>\n<h2 id=\"不同种类的密码\"><a class=\"anchor\" href=\"#不同种类的密码\">#</a> 不同种类的密码</h2>\n<h4 id=\"vigenere-cipher\"><a class=\"anchor\" href=\"#vigenere-cipher\">#</a> Vigenere Cipher</h4>\n<p>一种凯撒密码</p>\n<p>key 是  <code>OCU</code>  那么第一个字符被移动了 O (14) 次，第二个字符被移动了  <code>C</code>  (2) 次</p>\n<h4 id=\"caesar-cipher\"><a class=\"anchor\" href=\"#caesar-cipher\">#</a> CAESAR Cipher</h4>\n<p>在线暴力破解</p>\n<p><a href=\"https://www.dcode.fr/caesar-cipher\">https://www.dcode.fr/caesar-cipher</a></p>\n<h4 id=\"keyboard-shift\"><a class=\"anchor\" href=\"#keyboard-shift\">#</a> keyboard shift</h4>\n<p><code>BUH'tdy,|Bim5y~Bdt76yQ</code>  长这样，有可能下划线不被解密</p>\n<p><a href=\"https://www.dcode.fr/keyboard-shift-cipher\">https://www.dcode.fr/keyboard-shift-cipher</a></p>\n<h4 id=\"bacon-cipher\"><a class=\"anchor\" href=\"#bacon-cipher\">#</a> bacon cipher</h4>\n<h4 id=\"与佛论禅\"><a class=\"anchor\" href=\"#与佛论禅\">#</a> 与佛论禅</h4>\n<p><a href=\"https://www.keyfc.net/bbs/tools/tudoucode.aspx\">https://www.keyfc.net/bbs/tools/tudoucode.aspx</a></p>\n<p>密语是 <code>佛曰：</code>  开头的</p>\n<h4 id=\"rot13\"><a class=\"anchor\" href=\"#rot13\">#</a> rot13</h4>\n<p><a href=\"https://www.rot13.de/index.php\">https://www.rot13.de/index.php</a></p>\n<h3 id=\"enigma-cryptogarphy\"><a class=\"anchor\" href=\"#enigma-cryptogarphy\">#</a> enigma cryptogarphy</h3>\n<p><a href=\"https://cryptii.com/pipes/enigma-machine\">https://cryptii.com/pipes/enigma-machine</a></p>\n<h4 id=\"playfair-cipher\"><a class=\"anchor\" href=\"#playfair-cipher\">#</a> Playfair cipher</h4>\n<p>通常有一个表格表示密钥</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.16em\" columnalign=\"left left left left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>Q</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>W</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>E</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>R</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>T</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>Y</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>U</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>I</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>O</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>P</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>A</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>S</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>D</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>F</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>G</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>H</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>K</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>L</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>Z</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>X</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>C</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>V</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>B</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>N</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>M</mi></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{array}{lllll}\nQ &amp; W &amp; E &amp; R &amp; T \\\\\nY &amp; U &amp; I &amp; O &amp; P \\\\\nA &amp; S &amp; D &amp; F &amp; G \\\\\nH &amp; K &amp; L &amp; Z &amp; X \\\\\nC &amp; V &amp; B &amp; N &amp; M\n\\end{array}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:6em;vertical-align:-2.75em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">K</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.25em;\"><span style=\"top:-5.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span><span style=\"top:-4.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span></span></span><span style=\"top:-1.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span><span style=\"top:-0.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.75em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span></span></span></span></span></span></span></p>\n<p><a href=\"https://www.boxentriq.com/code-breaking/playfair-cipher\">https://www.boxentriq.com/code-breaking/playfair-cipher</a></p>\n<h3 id=\"brute-force\"><a class=\"anchor\" href=\"#brute-force\">#</a> brute force</h3>\n<p>暴力 key 的长度，然后暴力，使得 xor 后的 string 有  <code>flag</code></p>\n<h4 id=\"sha1\"><a class=\"anchor\" href=\"#sha1\">#</a> sha1</h4>\n<p>这个里面的  <code>0x8004u</code>  就是 sha1 加密的标志</p>\n<p><a href=\"http://www.ttmd5.com/hash.php?type=5\">http://www.ttmd5.com/hash.php?type=5</a></p>\n<h4 id=\"md5\"><a class=\"anchor\" href=\"#md5\">#</a> Md5</h4>\n<p>这个里面的  <code>0x8003u</code>  就是 sha1 加密的标志</p>\n<p><a href=\"https://hashes.com/en/decrypt/hash\">https://hashes.com/en/decrypt/hash</a></p>\n<p><a href=\"https://md5.gromweb.com/?md5=b74dec4f39d35b6a2e6c48e637c8aedb\">https://md5.gromweb.com/?md5=b74dec4f39d35b6a2e6c48e637c8aedb</a></p>\n<p><a href=\"https://www.somd5.com/\">https://www.somd5.com/</a></p>\n<p>可以直接 google MD5 值，看有没有解密</p>\n<h3 id=\"discrete-logarithm\"><a class=\"anchor\" href=\"#discrete-logarithm\">#</a> Discrete logarithm</h3>\n<p>如果 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">p-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> 的质数分解比较小，那么可以解出来</p>\n<p><a href=\"https://github.com/idekctf/idekctf-2024/blob/main/crypto/goldenticket/debug/solve.py\">https://github.com/idekctf/idekctf-2024/blob/main/crypto/goldenticket/debug/solve.py</a></p>\n<p>sage 有一个函数  <code>discrete_log_lambda</code>  可以对一个区间计算答案，复杂度是 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msqrt><mrow><mi>l</mi><mi>e</mi><mi>n</mi></mrow></msqrt><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(\\sqrt{len})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1822em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9322em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-2.8922em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.08em\" viewbox=\"0 0 400000 1080\" preserveaspectratio=\"xMinYMin slice\"><path d=\"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1078em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 级别，之后再用 CRT 合并出大答案</p>\n<figure class=\"highlight py\"><figcaption data-lang=\"Python\"><span>y</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">PH_partial</span><span class=\"token punctuation\">(</span>h<span class=\"token punctuation\">,</span> g<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">,</span> fact_phi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token triple-quoted-string string\">\"\"\"Returns (x, m), where</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    - x is the dlog of h in base g, mod m</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    - m = lcm(pi^ei) for (pi, ei) in fact_phi</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    \"\"\"</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    res <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    mod <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    F <span class=\"token operator\">=</span> GF<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    phi <span class=\"token operator\">=</span> p<span class=\"token operator\">-</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">for</span> pi<span class=\"token punctuation\">,</span> ei <span class=\"token keyword\">in</span> fact_phi<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        gi <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">,</span> phi<span class=\"token operator\">//</span><span class=\"token punctuation\">(</span>pi<span class=\"token operator\">**</span>ei<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        hi <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>h<span class=\"token punctuation\">,</span> phi<span class=\"token operator\">//</span><span class=\"token punctuation\">(</span>pi<span class=\"token operator\">**</span>ei<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        xi <span class=\"token operator\">=</span> discrete_log_lambda<span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">(</span>hi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> F<span class=\"token punctuation\">(</span>gi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> bounds <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> pi<span class=\"token operator\">**</span>ei<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        res<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>xi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        mod<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>pi<span class=\"token operator\">**</span>ei<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    x<span class=\"token punctuation\">,</span> m <span class=\"token operator\">=</span> CRT<span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> mod<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> lcm<span class=\"token punctuation\">(</span>mod<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">assert</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">,</span> x <span class=\"token operator\">*</span> phi<span class=\"token operator\">//</span>m<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>h<span class=\"token punctuation\">,</span> phi<span class=\"token operator\">//</span>m<span class=\"token punctuation\">,</span> p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token keyword\">return</span> x<span class=\"token punctuation\">,</span> m</pre></td></tr></table></figure><h1 id=\"web\"><a class=\"anchor\" href=\"#web\">#</a> Web</h1>\n<h4 id=\"信息收集\"><a class=\"anchor\" href=\"#信息收集\">#</a> 信息收集</h4>\n<p>从 HTTP 头中的 Server 字段可以了解用了什么服务器</p>\n<p>敏感目录：</p>\n<ul>\n<li><code>.git</code></li>\n<li><code>svn</code></li>\n<li><code>idea</code></li>\n</ul>\n<p>工具</p>\n<ul>\n<li>dirsearch</li>\n<li>ffuf</li>\n</ul>\n<h3 id=\"sql-注入\"><a class=\"anchor\" href=\"#sql-注入\">#</a> SQL 注入</h3>\n<h4 id=\"数字型注入\"><a class=\"anchor\" href=\"#数字型注入\">#</a> 数字型注入</h4>\n<p><code>?id=1</code>  和  <code>?id=2-1</code>  是一样的</p>\n<h2 id=\"pwn\"><a class=\"anchor\" href=\"#pwn\">#</a> PWN</h2>\n<h4 id=\"pwn-tool\"><a class=\"anchor\" href=\"#pwn-tool\">#</a> pwn tool</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pip <span class=\"token function\">install</span> pwmtools</pre></td></tr></table></figure><h4 id=\"recv\"><a class=\"anchor\" href=\"#recv\">#</a> recv</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>con<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"ready? Y/N : \"</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>con<span class=\"token punctuation\">.</span>recvline_startswith<span class=\"token punctuation\">(</span><span class=\"token string\">\"Computer\"</span><span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 一直到有一个符合的</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>con<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"send\"><a class=\"anchor\" href=\"#send\">#</a> send</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>con<span class=\"token punctuation\">.</span>sendline<span class=\"token punctuation\">(</span><span class=\"token string\">b'Y'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"连接\"><a class=\"anchor\" href=\"#连接\">#</a> 连接</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> pwn</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>con <span class=\"token operator\">=</span> pwn<span class=\"token punctuation\">.</span>remote<span class=\"token punctuation\">(</span><span class=\"token string\">\"thekidofarcrania.com\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10001</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>s <span class=\"token operator\">=</span> con<span class=\"token punctuation\">.</span>recvuntil<span class=\"token punctuation\">(</span><span class=\"token string\">\"ready? Y/N : \"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"post-request\"><a class=\"anchor\" href=\"#post-request\">#</a> Post Request</h3>\n<h4 id=\"curl\"><a class=\"anchor\" href=\"#curl\">#</a> curl</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">curl</span> <span class=\"token parameter variable\">-X</span> POST <span class=\"token parameter variable\">-d</span> <span class=\"token string\">\"username=admin&amp;password=71urlkufpsdnlkadsf\"</span> http://165.227.106.113/post.php</pre></td></tr></table></figure><h3 id=\"burpsuite\"><a class=\"anchor\" href=\"#burpsuite\">#</a> Burpsuite</h3>\n<p>install</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> burpsuite</pre></td></tr></table></figure><p>打开之后点 Proxy, 然后点 intercept on, 然后 open browser 打开连接就可以获得对应的请求</p>\n<h4 id=\"header\"><a class=\"anchor\" href=\"#header\">#</a> header</h4>\n<p>可以右键发送到 repeater 里面</p>\n<p>然后在里面改 header</p>\n<h4 id=\"referer\"><a class=\"anchor\" href=\"#referer\">#</a> referer</h4>\n<p>表示从哪里来的</p>\n<figure class=\"highlight html\"><figcaption data-lang=\"HTML\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Referer:awesomesauce.com</pre></td></tr></table></figure><h4 id=\"python插件\"><a class=\"anchor\" href=\"#python插件\">#</a> python 插件</h4>\n<p>Repeater 里面右键，extension，里面可以复制为 python 的 request</p>\n<h3 id=\"开发者工具\"><a class=\"anchor\" href=\"#开发者工具\">#</a> 开发者工具</h3>\n<h4 id=\"storage\"><a class=\"anchor\" href=\"#storage\">#</a> Storage</h4>\n<p>可以看到存储的信息</p>\n<h2 id=\"网站\"><a class=\"anchor\" href=\"#网站\">#</a> 网站</h2>\n<h3 id=\"robotstxt\"><a class=\"anchor\" href=\"#robotstxt\">#</a>  <code>robots.txt</code></h3>\n<p>去网站的 <a href=\"https://ctflearn.com/robots.txt\">https://ctflearn.com/robots.txt</a> 可以看到不允许的网页</p>\n<h4 id=\"wikipedia\"><a class=\"anchor\" href=\"#wikipedia\">#</a> wikipedia</h4>\n<p><a href=\"https://en.wikipedia.org/\">https://en.wikipedia.org/</a></p>\n<p>用 diff 可以看到修改的信息</p>\n<h4 id=\"备份文件名\"><a class=\"anchor\" href=\"#备份文件名\">#</a> 备份文件名</h4>\n<p><code>.git .svn .swp .svn .~ .bak .bash_history</code></p>\n<h3 id=\"dirsearch\"><a class=\"anchor\" href=\"#dirsearch\">#</a> dirsearch</h3>\n<p>可以看网页的目录</p>\n<p><a href=\"https://github.com/maurosoria/dirsearch\">https://github.com/maurosoria/dirsearch</a></p>\n<h4 id=\"更改网页源代码\"><a class=\"anchor\" href=\"#更改网页源代码\">#</a> 更改网页源代码</h4>\n<p>可以把 disable 的按钮改成可以按下去</p>\n<p>用 hackbar 可以发送 post 请求</p>\n<h4 id=\"查找网站的隐藏连接\"><a class=\"anchor\" href=\"#查找网站的隐藏连接\">#</a> 查找网站的隐藏连接</h4>\n<h4 id=\"gobuster\"><a class=\"anchor\" href=\"#gobuster\">#</a> gobuster</h4>\n<h4 id=\"查找历史网页状态\"><a class=\"anchor\" href=\"#查找历史网页状态\">#</a> 查找历史网页状态</h4>\n<p>wayback machinehttps://web.archive.org/</p>\n<h2 id=\"php\"><a class=\"anchor\" href=\"#php\">#</a> PHP</h2>\n<h4 id=\"判断相等\"><a class=\"anchor\" href=\"#判断相等\">#</a> 判断相等</h4>\n<p><code>==, &gt;</code>  是弱类型判断，会先转换类型再判断，所以  <code>a=123abc</code>  会变成  <code>123</code></p>\n<h4 id=\"反序列化\"><a class=\"anchor\" href=\"#反序列化\">#</a> 反序列化</h4>\n<p>序列化：把对象转成字符串存储。反序列化：把字符串转成对象</p>\n<p><code>__wakeup()</code>  是在序列化的时候执行的</p>\n<pre><code class=\"language-php+HTML\">&lt;?php \nclass xctf&#123;\npublic $flag = '111';\npublic function __wakeup()&#123;\nexit('bad requests');\n&#125;\n&#125;\n$a = new xctf();\n$c = serialize($a);\necho $c\n?&gt; \n</code></pre>\n<p>输出是  <code>O:4:&quot;xctf&quot;:1:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code>  现在要绕过这个 exit 方法，改成 2 就行</p>\n<h4 id=\"think-php-rce\"><a class=\"anchor\" href=\"#think-php-rce\">#</a> THINK PHP RCE</h4>\n<p>RCE 是 remote code execution，在 github 上搜索 think php5 可以找到漏洞</p>\n<h3 id=\"文件上传\"><a class=\"anchor\" href=\"#文件上传\">#</a> 文件上传</h3>\n<p><a href=\"https://www.cnblogs.com/xhds/p/12218471.html\">https://www.cnblogs.com/xhds/p/12218471.html</a></p>\n<h1 id=\"misc\"><a class=\"anchor\" href=\"#misc\">#</a> misc</h1>\n<h4 id=\"在线工具\"><a class=\"anchor\" href=\"#在线工具\">#</a> 在线工具</h4>\n<p><a href=\"https://www.ilovepdf.com/zh-cn\">https://www.ilovepdf.com/zh-cn</a> , <a href=\"https://pdf2doc.com/\">https://pdf2doc.com/</a> PDF 转换</p>\n<p><a href=\"https://georgeom.net/StegOnline/checklist\">https://georgeom.net/StegOnline/checklist</a> checklist steg</p>\n<h3 id=\"隐写术\"><a class=\"anchor\" href=\"#隐写术\">#</a> 隐写术</h3>\n<h4 id=\"文件附加\"><a class=\"anchor\" href=\"#文件附加\">#</a> 文件附加</h4>\n<h4 id=\"png\"><a class=\"anchor\" href=\"#png\">#</a> PNG</h4>\n<p>开头是</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"><span>t</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>89 50 4E 47 0D 0A 1A 0A</pre></td></tr></table></figure><p>IEND 是</p>\n<figure class=\"highlight text\"><figcaption data-lang=\"text\"><span>t</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>00 00 00 00 49 45 4E AE 42 60 82</pre></td></tr></table></figure><p>查看 metadata 在 linux 上:</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>exiftool xxx.png</pre></td></tr></table></figure><h4 id=\"jpeg\"><a class=\"anchor\" href=\"#jpeg\">#</a> JPEG</h4>\n<ul>\n<li>头  <code>FF D8 FF</code></li>\n<li>尾  <code>FF D9</code></li>\n</ul>\n<h4 id=\"gif\"><a class=\"anchor\" href=\"#gif\">#</a> GIF</h4>\n<p>拆分图片工具：stegsolve 分离图片（先 open 再 analyse-frame browser）</p>\n<ul>\n<li><code>47 49 46 38</code></li>\n<li><code>00 3B</code></li>\n</ul>\n<h4 id=\"zip\"><a class=\"anchor\" href=\"#zip\">#</a> ZIP</h4>\n<ul>\n<li><code>50 4B 03 04</code></li>\n<li><code>50 4B</code></li>\n</ul>\n<h4 id=\"rar\"><a class=\"anchor\" href=\"#rar\">#</a> RAR</h4>\n<ul>\n<li><code>52 61 72 21</code></li>\n</ul>\n<h4 id=\"wave\"><a class=\"anchor\" href=\"#wave\">#</a> WAVE</h4>\n<ul>\n<li><code>57 41 56 45</code></li>\n</ul>\n<h4 id=\"avi\"><a class=\"anchor\" href=\"#avi\">#</a> AVI</h4>\n<ul>\n<li><code>41 56 49 20</code></li>\n</ul>\n<h3 id=\"lsb\"><a class=\"anchor\" href=\"#lsb\">#</a> LSB</h3>\n<p>Least significant bit 在图片的最低有效位上写入信息</p>\n<p>Stegsolve , zsteg 工具可以识别</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> zsteg</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>zsteg cats.png</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>zsteg xx.bmp <span class=\"token parameter variable\">-b</span> <span class=\"token number\">1</span> <span class=\"token parameter variable\">-a</span> yx <span class=\"token parameter variable\">-v</span></pre></td></tr></table></figure><p>python 脚本</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> bitarray <span class=\"token keyword\">import</span> bitarray</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> cv2</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">LSBtoBytes</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\"># index 0,1,2 = r,g,b</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    im <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>imread<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    data <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">for</span> row <span class=\"token keyword\">in</span> im<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">for</span> col <span class=\"token keyword\">in</span> row<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            data<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>col<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">return</span> bitarray<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>tobytes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">LSBtoImg</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    im <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>imread<span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span>row <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">for</span> j<span class=\"token punctuation\">,</span>col <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>row<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token keyword\">if</span> col<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>                im<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span><span class=\"token number\">255</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>                im<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token comment\"># cv2.imwrite(\"out.png\",im)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">return</span> im</pre></td></tr></table></figure><p>LSB 可能 RG， GB 之类的组合使用</p>\n<h4 id=\"隐写思路\"><a class=\"anchor\" href=\"#隐写思路\">#</a> 隐写思路</h4>\n<ul>\n<li>\n<p>图片结构改变： 结尾加东西， <code>zsteg</code></p>\n<p>提取文件：  <code>zsteg -e &quot;b1,rgb,lsb,xy&quot; xx.png &gt; flag.png</code></p>\n<p>Chunks 改变：用  <code>pngcheck</code>  检查</p>\n</li>\n<li>\n<p>LSB 隐写： 对应工具</p>\n</li>\n</ul>\n<h3 id=\"盲水印\"><a class=\"anchor\" href=\"#盲水印\">#</a> 盲水印</h3>\n<p>在不同与域上隐藏信息，在图片傅里叶变换后。把信息添加到 “噪声” 中，再逆变换回去就不会对原图片产生大变化</p>\n<p>工具:  <code>BlindWaterMark</code></p>\n<h4 id=\"现成的隐写工具\"><a class=\"anchor\" href=\"#现成的隐写工具\">#</a> 现成的隐写工具</h4>\n<ul>\n<li>\n<p>Jphide: JPG</p>\n</li>\n<li>\n<p>Outguess: JPG</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>outguess <span class=\"token parameter variable\">-k</span> <span class=\"token string\">\"key\"</span> <span class=\"token parameter variable\">-r</span> file.jpg out.txt <span class=\"token comment\"># decode</span></pre></td></tr></table></figure></li>\n<li>\n<p>Steghide: support for JPEG, BMP, WAV and AU files</p>\n</li>\n<li>\n<p>F5-steganography: BMP, GIF, or JPEG</p>\n</li>\n<li>\n<p>invisible secrets</p>\n</li>\n<li>\n<p>wbs43open</p>\n</li>\n<li>\n<p>stegosuite</p>\n</li>\n<li>\n<p>cloacked-pixel</p>\n</li>\n<li>\n<p>Slient-Eye</p>\n</li>\n</ul>\n<p>暴力工具</p>\n<p><code>DominicBreuker/stego-toolkit</code></p>\n<h3 id=\"压缩文件\"><a class=\"anchor\" href=\"#压缩文件\">#</a> 压缩文件</h3>\n<h4 id=\"zip-文件\"><a class=\"anchor\" href=\"#zip-文件\">#</a> ZIP 文件</h4>\n<ul>\n<li>数据区 (504B0304)\n<ul>\n<li>解压要的版本</li>\n<li>flags</li>\n<li>压缩算法</li>\n<li>文件修改时间</li>\n<li>CRC32</li>\n<li>压缩前与后大小</li>\n<li>文件名长度和内容</li>\n<li>文件数据</li>\n</ul>\n</li>\n<li>核心目录区 (504B0102)</li>\n<li>核心目录结束区 (504B0506)</li>\n</ul>\n<h4 id=\"pdf-文件\"><a class=\"anchor\" href=\"#pdf-文件\">#</a> PDF 文件</h4>\n<p>可能藏在图片后面，转 word 或者全选可以看</p>\n<h4 id=\"rar-文件\"><a class=\"anchor\" href=\"#rar-文件\">#</a> RAR 文件</h4>\n<p><code>RAR &lt;=4</code>  的签名  <code>5261172211A0700</code></p>\n<p><code>RAR5</code>  的签名  <code>526172211A070100</code></p>\n<h4 id=\"暴力破解工具\"><a class=\"anchor\" href=\"#暴力破解工具\">#</a> 暴力破解工具</h4>\n<p>windows: ARCHPR</p>\n<p>Linux: fcrackzip, RarCrack</p>\n<p>也可以通过爆破 CRC32 来获得</p>\n<p><code>zip-crc-cracker</code>  ， <code>crc32</code></p>\n<h4 id=\"伪加密\"><a class=\"anchor\" href=\"#伪加密\">#</a> 伪加密</h4>\n<p>ZIP 里面有个通用标记位</p>\n<p>距离  <code>504B0102</code>  偏移 8 byte, 本身占 2 byte，最低位标识是否被加密。只要改回 0 就可以正常打开</p>\n<p>RAR 里面也有</p>\n<p>HeadFlags 从低位起第 3bit 是，但是要重新计算 CRC ( <code>HEAD_CRC</code> )</p>\n<h4 id=\"zip-明文攻击\"><a class=\"anchor\" href=\"#zip-明文攻击\">#</a> ZIP 明文攻击</h4>\n<p>知道内容一些字节可以用，要先确认把呢不能</p>\n<p>可以用  <code>ARCHPR</code>  , 非完整明文  <code>bkcrack</code></p>\n<h3 id=\"音频隐写\"><a class=\"anchor\" href=\"#音频隐写\">#</a> 音频隐写</h3>\n<h4 id=\"工具\"><a class=\"anchor\" href=\"#工具\">#</a> 工具</h4>\n<ul>\n<li>audacity 查看音频</li>\n</ul>\n<h3 id=\"流量分析\"><a class=\"anchor\" href=\"#流量分析\">#</a> 流量分析</h3>\n<p>Wireshark</p>\n<p>统计里面，协议分级可以看流量包的比例</p>\n<p>会话里面会有地址</p>\n<p>过滤器</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ip.src <span class=\"token operator\">==</span> xxx.xx.xx.xx</pre></td></tr></table></figure><p>也可以右键作为过滤器应用</p>\n<h4 id=\"http\"><a class=\"anchor\" href=\"#http\">#</a> HTTP</h4>\n<p>明文传输的</p>\n<h4 id=\"https\"><a class=\"anchor\" href=\"#https\">#</a> HTTPS</h4>\n<p>添加 TLS，要导入密钥才能看到内容</p>\n<h4 id=\"ftp\"><a class=\"anchor\" href=\"#ftp\">#</a> FTP</h4>\n<p>20，21 端口</p>\n<h4 id=\"dns\"><a class=\"anchor\" href=\"#dns\">#</a> DNS</h4>\n<p>解析网址</p>\n<h3 id=\"usb流量分析\"><a class=\"anchor\" href=\"#usb流量分析\">#</a> USB 流量分析</h3>\n<p>通过 USB 协议传输，从一个地址发送到 host</p>\n<p>键盘是 8 字节，鼠标是 4 字节</p>\n<ul>\n<li>第一个字节是按键按下\n<ul>\n<li><code>00</code>  没有按下， <code>01</code>  按左键， <code>02</code>  按右键</li>\n</ul>\n</li>\n<li>第二个字节是左右偏移\n<ul>\n<li>正是向右移动  <code>n</code>  个像素位</li>\n</ul>\n</li>\n<li>第三个字节是上下偏移\n<ul>\n<li>正是向上移动</li>\n</ul>\n</li>\n</ul>\n<p>键盘流量</p>\n<ul>\n<li>Byte1：控制信息\n<ul>\n<li><code>[Right gui,Right alt,Right shift,Right control,Left Gui,Left Alt,left shift,Left Control]</code></li>\n</ul>\n</li>\n<li>byte3：击键信息</li>\n</ul>\n<h3 id=\"wireshark\"><a class=\"anchor\" href=\"#wireshark\">#</a> wireshark</h3>\n<p>提取流量数据</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> pyshark</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> pyshark<span class=\"token punctuation\">.</span>packet</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> binascii <span class=\"token keyword\">import</span> unhexlify</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>capture <span class=\"token operator\">=</span> pyshark<span class=\"token punctuation\">.</span>FileCapture<span class=\"token punctuation\">(</span><span class=\"token string\">'justapcap.pcap'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>hexstr <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>cnt <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">for</span> packet <span class=\"token keyword\">in</span> capture<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    s <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>packet<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    cur <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\"Name:\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\".\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\"1m \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    hexstr <span class=\"token operator\">+=</span> cur</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>hexstr <span class=\"token operator\">=</span> hexstr<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\"exam\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">with</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"a.png\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"wb\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    f<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>unhexlify<span class=\"token punctuation\">(</span>hexstr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h3 id=\"内存取证\"><a class=\"anchor\" href=\"#内存取证\">#</a> 内存取证</h3>\n<h4 id=\"volatility\"><a class=\"anchor\" href=\"#volatility\">#</a> volatility</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> snap <span class=\"token function\">install</span> volatility-phocean</pre></td></tr></table></figure><h4 id=\"确定信息\"><a class=\"anchor\" href=\"#确定信息\">#</a> 确定信息</h4>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>vol.py <span class=\"token parameter variable\">-f</span> memory imageinfo</pre></td></tr></table></figure><p>psxview 查看内存</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>vol.py <span class=\"token parameter variable\">-f</span> memory <span class=\"token parameter variable\">--profile</span><span class=\"token operator\">=</span>Win7SPx86 psxview</pre></td></tr></table></figure><p>pslist 查看运行的进程</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>volatility <span class=\"token parameter variable\">-f</span> mem.mem <span class=\"token parameter variable\">--profile</span><span class=\"token operator\">=</span>Win10x64_1231 pslist</pre></td></tr></table></figure><p>filescan 是打开的文件对象</p>\n<p>dumpfile</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>vol.py <span class=\"token parameter variable\">-f</span> memory <span class=\"token parameter variable\">--profile</span><span class=\"token operator\">=</span>Win7SPx86 prodump <span class=\"token parameter variable\">-p</span> <span class=\"token number\">1384</span> --dump-dir ./dump/</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">file</span> dump/executable.i384.exe</pre></td></tr></table></figure><p>PEB 会保存 PEB 信息</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>vol.py <span class=\"token parameter variable\">-f</span> memory <span class=\"token parameter variable\">--profile</span><span class=\"token operator\">=</span>Win7SPx86 cmdline</pre></td></tr></table></figure><p>是命令行信息</p>\n<p>sockets</p>\n<p>hivelist, hivescan 是注册表</p>\n<p>hashdump 获取用户密码的 hash， mimikatz 插件可以还原 hash</p>\n<h4 id=\"volatitlity-3\"><a class=\"anchor\" href=\"#volatitlity-3\">#</a> volatitlity 3</h4>\n<p>确定信息</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>vol <span class=\"token parameter variable\">-f</span> x.mem windows.info</pre></td></tr></table></figure><h3 id=\"磁盘取证\"><a class=\"anchor\" href=\"#磁盘取证\">#</a> 磁盘取证</h3>\n<h4 id=\"文件系统\"><a class=\"anchor\" href=\"#文件系统\">#</a> 文件系统</h4>\n<p>windows: FAT16, FAT32, NTFS</p>\n<p>Linux: Ext2, Ext3, Ext4</p>\n<h4 id=\"fat1632\"><a class=\"anchor\" href=\"#fat1632\">#</a> Fat16/32</h4>\n<p>16bit 来表示一个簇</p>\n<p>DBR 扇区</p>\n<p><img src=\"/CTF%E7%9F%A5%E8%AF%86%E7%82%B9/image-20240819191436093.png\" alt=\"image-20240819191436093\"></p>\n<h4 id=\"ntfs\"><a class=\"anchor\" href=\"#ntfs\">#</a> NTFS</h4>\n<p>性能优秀，安全性高，可恢复性，文件压缩</p>\n<h1 id=\"osint\"><a class=\"anchor\" href=\"#osint\">#</a> OSINT</h1>\n<p>时光机 web archive</p>\n<h1 id=\"区块链blockchain\"><a class=\"anchor\" href=\"#区块链blockchain\">#</a> 区块链 blockchain</h1>\n<p>IDE：REMIX</p>\n<h4 id=\"windows-安装nc\"><a class=\"anchor\" href=\"#windows-安装nc\">#</a> windows 安装 nc</h4>\n<p>去 nmap 官网下载就行</p>\n<h3 id=\"msgsender\"><a class=\"anchor\" href=\"#msgsender\">#</a> msg.sender</h3>\n<p>当一个外部账户（例如，用户的钱包地址）调用合约中的函数时， <code>msg.sender</code>  会是该外部账户的地址。</p>\n<p>如果一个合约调用另一个合约的函数，那么  <code>msg.sender</code>  将是调用方合约的地址，而不是最终的外部账户。</p>\n<p>例如，如果合约 A 调用合约 B 的函数，合约 B 中的  <code>msg.sender</code>  会是合约 A 的地址，而不是最初发起调用的外部账户。</p>\n<p>当一个函数从合约内部调用另一个合约的函数时， <code>msg.sender</code>  仍然是直接发起调用的那个地址。如果函数调用链中有多个合约调用， <code>msg.sender</code>  始终代表的是当前执行上下文中的调用者。</p>\n<h3 id=\"storage-2\"><a class=\"anchor\" href=\"#storage-2\">#</a> storage</h3>\n<p>在 Solidity 中， <code>storage</code>  是用于存储智能合约中状态变量的数据位置。它是智能合约中非常重要的一部分，用来持久化存储数据，也就是存储在以太坊区块链上的数据。与其他数据存储位置（如  <code>memory</code>  和  <code>stack</code> ）不同， <code>storage</code>  中的数据是持久的，意味着它们在交易执行后会一直存在，直到被更新或删除。每个合约都有自己的  <code>storage</code>  空间。</p>\n<h4 id=\"1-storage-的特点\"><a class=\"anchor\" href=\"#1-storage-的特点\">#</a> 1. <strong> <code>storage</code>  的特点</strong></h4>\n<ul>\n<li><strong>持久性</strong>： <code>storage</code>  中的数据在合约的生命周期内是持久的，意味着它们会被保存在区块链中。即使合约函数执行完成后，数据仍然保留，并且在下一次函数调用时可以访问。</li>\n<li><strong>费用</strong>：在 Solidity 中，将数据写入  <code>storage</code>  是昂贵的操作，因为这需要改变区块链状态并消耗  <code>gas</code> 。相对而言，从  <code>storage</code>  中读取数据的费用要比写入便宜一些。</li>\n<li><strong>每个合约的  <code>storage</code>  空间独立</strong>：每个智能合约都有自己的  <code>storage</code>  空间，且  <code>storage</code>  中的数据可以通过合约的状态变量来访问</li>\n</ul>\n<h4 id=\"slot\"><a class=\"anchor\" href=\"#slot\">#</a> slot</h4>\n<p>Solidity 会将每个状态变量存储在固定的槽（slot）中。每个状态变量占据一定的存储槽，状态变量的存储位置由其在合约中声明的顺序决定。这些槽位在区块链上是固定的</p>\n<h3 id=\"合约交互python\"><a class=\"anchor\" href=\"#合约交互python\">#</a> 合约交互 python</h3>\n<p>先要安装 solc, 然后 pip 安装 <code>web3</code> , <code>py-solc-x</code>  下面是基本配置</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>w3 <span class=\"token operator\">=</span> Web3<span class=\"token punctuation\">(</span>Web3<span class=\"token punctuation\">.</span>HTTPProvider<span class=\"token punctuation\">(</span><span class=\"token string\">'http://94.237.59.45:52415'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">create_abi</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    temp_file <span class=\"token operator\">=</span> solcx<span class=\"token punctuation\">.</span>compile_files<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>name<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">.sol'</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    abi <span class=\"token operator\">=</span> temp_file<span class=\"token punctuation\">[</span><span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>name<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">.sol:</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>name<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'abi'</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">return</span> abi</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>setup_abi <span class=\"token operator\">=</span> create_abi<span class=\"token punctuation\">(</span><span class=\"token string\">'Setup'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>fNFT_abi <span class=\"token operator\">=</span> create_abi<span class=\"token punctuation\">(</span><span class=\"token string\">'FrontierNFT'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>fMarket_abi <span class=\"token operator\">=</span> create_abi<span class=\"token punctuation\">(</span><span class=\"token string\">'FrontierMarketplace'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">if</span> w3<span class=\"token punctuation\">.</span>is_connected<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Connected to Ethereum network\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Failed to connect\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>private_key <span class=\"token operator\">=</span> <span class=\"token string\">\"1249bb2c45202146bbe401b6b29848c5f0345e418434eeedaade8dd8bdbb437a\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>my_address <span class=\"token operator\">=</span> <span class=\"token string\">\"0x41b34Fe0b213FF5300D648F875F84B0F016295cc\"</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>fmarket_address <span class=\"token operator\">=</span> <span class=\"token string\">\"0x899c356B0489472c99EF4A46b3893B62Fd73F349\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>setup_address <span class=\"token operator\">=</span> <span class=\"token string\">\"0xD984cF86bfEbb01E62f0729c2Dd5562a852038f4\"</span></pre></td></tr></table></figure><h4 id=\"调用函数\"><a class=\"anchor\" href=\"#调用函数\">#</a> 调用函数</h4>\n<p>不创建新节点</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>setup <span class=\"token operator\">=</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>contract<span class=\"token punctuation\">(</span>address<span class=\"token operator\">=</span>setup_address<span class=\"token punctuation\">,</span> abi<span class=\"token operator\">=</span>setup_abi<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>setup<span class=\"token punctuation\">.</span>functions<span class=\"token punctuation\">.</span>isSolved<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>call<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>setup<span class=\"token punctuation\">.</span>functions<span class=\"token punctuation\">.</span>paramfunc<span class=\"token punctuation\">(</span>param<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>call<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 有参数的写法</span></pre></td></tr></table></figure><p>读取值，可以把值当成函数</p>\n<h4 id=\"查询block-chain\"><a class=\"anchor\" href=\"#查询block-chain\">#</a> 查询 block chain</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>latest_block <span class=\"token operator\">=</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>get_block<span class=\"token punctuation\">(</span><span class=\"token string\">'latest'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># block_number = 10000000  #</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># latest_block = w3.eth.get_block(0)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># print(block['number']) </span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Latest Block Info:\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Block Number: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'number'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Block Hash: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'hash'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Parent Hash: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'parentHash'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Timestamp: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'timestamp'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Miner: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'miner'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Gas Used: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'gasUsed'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Gas Limit: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'gasLimit'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Transactions Count: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'transactions'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h5 id=\"查询balance\"><a class=\"anchor\" href=\"#查询balance\">#</a> 查询 balance</h5>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 查询该地址的余额（返回值是以 wei 为单位）</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>balance_wei <span class=\"token operator\">=</span> web3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>get_balance<span class=\"token punctuation\">(</span>address<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># 将 wei 转换为 ether</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>balance_ether <span class=\"token operator\">=</span> web3<span class=\"token punctuation\">.</span>from_wei<span class=\"token punctuation\">(</span>balance_wei<span class=\"token punctuation\">,</span> <span class=\"token string\">'ether'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"查询transactions\"><a class=\"anchor\" href=\"#查询transactions\">#</a> 查询 transactions</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 查询某个区块范围内的交易</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>block_start <span class=\"token operator\">=</span> <span class=\"token number\">10000000</span>  <span class=\"token comment\"># 起始区块</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>block_end <span class=\"token operator\">=</span> <span class=\"token number\">10001000</span>    <span class=\"token comment\"># 结束区块</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\"># 获取区块范围内的交易</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">for</span> block_number <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>block_start<span class=\"token punctuation\">,</span> block_end <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    block <span class=\"token operator\">=</span> web3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>getBlock<span class=\"token punctuation\">(</span>block_number<span class=\"token punctuation\">,</span> full_transactions<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token comment\"># 遍历区块中的所有交易</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">for</span> tx <span class=\"token keyword\">in</span> block<span class=\"token punctuation\">.</span>transactions<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\"># 如果交易是发送到合约地址</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">if</span> tx<span class=\"token punctuation\">.</span>to <span class=\"token operator\">==</span> contract_address<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token comment\"># 解析交易的 input 数据，检查是否是函数调用</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            input_data <span class=\"token operator\">=</span> tx<span class=\"token punctuation\">.</span><span class=\"token builtin\">input</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Transaction Hash: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>tx<span class=\"token punctuation\">.</span><span class=\"token builtin\">hash</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            <span class=\"token comment\"># 使用 ABI 来解码交易数据</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            decoded_input <span class=\"token operator\">=</span> contract<span class=\"token punctuation\">.</span>decode_function_input<span class=\"token punctuation\">(</span>input_data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            function_name <span class=\"token operator\">=</span> decoded_input<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>fn<span class=\"token punctuation\">.</span>__name__</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Called function: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>function_name<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Function Arguments: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>decoded_input<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            </pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\"># 遍历</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">for</span> tx_hash <span class=\"token keyword\">in</span> latest_block<span class=\"token punctuation\">[</span><span class=\"token string\">'transactions'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    tx <span class=\"token operator\">=</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>get_transaction<span class=\"token punctuation\">(</span>tx_hash<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"from: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>tx<span class=\"token punctuation\">[</span><span class=\"token string\">'from'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token comment\"># </span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">if</span> tx<span class=\"token punctuation\">[</span><span class=\"token string\">'to'</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Transaction </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>tx_hash<span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> is a contract deployment.\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Transaction </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>tx_hash<span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> is a contract function call to </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>tx<span class=\"token punctuation\">[</span><span class=\"token string\">'to'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">.\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token comment\"># </span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    receipt <span class=\"token operator\">=</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>get_transaction_receipt<span class=\"token punctuation\">(</span>tx_hash<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token comment\"># </span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token keyword\">if</span> receipt<span class=\"token punctuation\">[</span><span class=\"token string\">'contractAddress'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Contract deployed at address </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>receipt<span class=\"token punctuation\">[</span><span class=\"token string\">'contractAddress'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"No contract deployed in this transaction.\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token comment\"># print(f\"Transaction Input Data: &#123;tx['input']&#125;\")</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token comment\"># decoded_input = setup.decode_function_input(tx['input'])</span></pre></td></tr></table></figure><h5 id=\"交易信息\"><a class=\"anchor\" href=\"#交易信息\">#</a> 交易信息</h5>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 打印交易的详细信息</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">for</span> tx_hash <span class=\"token keyword\">in</span> transactions<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    transaction <span class=\"token operator\">=</span> web3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>get_transaction<span class=\"token punctuation\">(</span>tx_hash<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Transaction Hash: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>tx_hash<span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"From: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>transaction<span class=\"token punctuation\">[</span><span class=\"token string\">'from'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"To: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>transaction<span class=\"token punctuation\">[</span><span class=\"token string\">'to'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Value: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>web3<span class=\"token punctuation\">.</span>fromWei<span class=\"token punctuation\">(</span>transaction<span class=\"token punctuation\">[</span><span class=\"token string\">'value'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'ether'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> ETH\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Gas: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>transaction<span class=\"token punctuation\">[</span><span class=\"token string\">'gas'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Gas Price: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>web3<span class=\"token punctuation\">.</span>fromWei<span class=\"token punctuation\">(</span>transaction<span class=\"token punctuation\">[</span><span class=\"token string\">'gasPrice'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'gwei'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> Gwei\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-\"</span> <span class=\"token operator\">*</span> <span class=\"token number\">40</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"查询事件\"><a class=\"anchor\" href=\"#查询事件\">#</a> 查询事件</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>event_filter <span class=\"token operator\">=</span> setup<span class=\"token punctuation\">.</span>events<span class=\"token punctuation\">.</span>DeployedTarget<span class=\"token punctuation\">.</span>create_filter<span class=\"token punctuation\">(</span>from_block<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> to_block<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#DeployedTarget 是函数名字</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>events <span class=\"token operator\">=</span> event_filter<span class=\"token punctuation\">.</span>get_all_entries<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># print event</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">for</span> event <span class=\"token keyword\">in</span> events<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Event: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>event<span class=\"token punctuation\">.</span>event<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Arguments: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>event<span class=\"token punctuation\">.</span>args<span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"发送transaction\"><a class=\"anchor\" href=\"#发送transaction\">#</a> 发送 transaction</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># send transactions</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>tx <span class=\"token operator\">=</span> forgotten<span class=\"token punctuation\">.</span>functions<span class=\"token punctuation\">.</span>discover<span class=\"token punctuation\">(</span>hashed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>build_transaction<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token string\">'from'</span><span class=\"token punctuation\">:</span> my_address<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token string\">\"gasPrice\"</span><span class=\"token punctuation\">:</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>gas_price<span class=\"token punctuation\">,</span>  <span class=\"token comment\"># two ******* hours it took to figure out this was needed.</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token string\">'nonce'</span><span class=\"token punctuation\">:</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>get_transaction_count<span class=\"token punctuation\">(</span><span class=\"token string\">\"0xEB4B81DE5738a22d24631ABD62f62cEECC268e71\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\"># needs to be signed as we are executing/writing not just reading</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>tx_create <span class=\"token operator\">=</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>account<span class=\"token punctuation\">.</span>sign_transaction<span class=\"token punctuation\">(</span>tx<span class=\"token punctuation\">,</span> private_key<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>tx_hash <span class=\"token operator\">=</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>send_raw_transaction<span class=\"token punctuation\">(</span>tx_create<span class=\"token punctuation\">.</span>raw_transaction<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>tx_receipt <span class=\"token operator\">=</span> w3<span class=\"token punctuation\">.</span>eth<span class=\"token punctuation\">.</span>wait_for_transaction_receipt<span class=\"token punctuation\">(</span>tx_hash<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'Tx successful with hash: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span> tx_receipt<span class=\"token punctuation\">.</span>transactionHash<span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h4 id=\"计算keccak哈希\"><a class=\"anchor\" href=\"#计算keccak哈希\">#</a> 计算 keccak 哈希</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hashed <span class=\"token operator\">=</span> w3<span class=\"token punctuation\">.</span>solidity_keccak<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token punctuation\">[</span><span class=\"token string\">'uint256'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'uint256'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'address'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1734258030</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"0x3E698Aba19B29C3fB625966A9631e6cf5C79505e\"</span><span class=\"token punctuation\">]</span>  </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"Keccak256 Hash: </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>hashed<span class=\"token punctuation\">.</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"hack-思维\"><a class=\"anchor\" href=\"#hack-思维\">#</a> Hack 思维</h2>\n<h3 id=\"数据范围\"><a class=\"anchor\" href=\"#数据范围\">#</a> 数据范围</h3>\n<p>输入不合法数据范围</p>\n"},{"title":"x3ctf2025 Write Up","date":"2025-02-03T16:39:31.000Z","math":true,"_content":"\n# x3ctf Write Up\n\n\n\n## 1. Misc\n\n### p11n-trophy（签到题）:\n\n题目描述：\n![image-20250127165738440](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127165738440.png)\n\n我们首先会得到这样一份证书：\n\n![trophy](https://raw.githubusercontent.com/Lycorisby/Picture/main/trophy.png)\n\n\n\n第一题签到题的答案就是证书下面正中间的“This certificate does not grant the rank of Master\"。\n\n### trophy-plus + trophy-plus64:\n\n这两道目描述一模一样\n\n### ![image-20250127165834982](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127165834982.png)\n\n![](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127165903642.png)\n\n其中一个flag是藏在certificate周围一圈的位置：\n\n![image-20250127170254595](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127170254595.png)\n\n![image-20250127170344389](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127170344389.png)\n\n人工将这些内容识别，再翻译成二进制然后解码就会得到flag\n```python\ndef decode_binary(content, mapping):\n    # Convert content to binary using the mapping\n    binary_str = ''.join(mapping[char] for char in content if char in mapping)\n\n    # Split the binary string into 8-bit chunks\n    bytes_list = [binary_str[i:i+8] for i in range(0, len(binary_str), 8)]\n\n    # Convert each 8-bit chunk to a character\n    decoded_text = ''.join(chr(int(byte, 2)) for byte in bytes_list if len(byte) == 8)\n\n    return decoded_text\n\n# Input string\nc_1 = \"MVVVVMMMMMVVMMVVMVVMMMVVMVVVVMVVMVVM VMMV MV MVVVVVMVVMM VMM MMVVMMMV\"\nc_2 =   \"MVVMM VMMMVVMVVVMMM VMMVVVMVVVMV MMM VMVVVVVMVVM VMVVMVVMVVVMMMVVMMMMMVVVMVVVM VMVVVVV\"\nc_3 = \"VMMMVVMMM VMMMVVMVVVVVM VMMV MMVVVMMMMMVVMMMVVMMVVMVVVVVM VMMM VMMVVMVVMMVVMMVVMMVVVM VMV MVVVMVVVVVM VM VM VMMVVMMV MMMVVMVVVVVMV MMMV MMVVMMMVVMVVM VMV MVVVMMMMMVVMMVVMMMVVMVVVVVM VMV MVVMVVMMVVMVVVM VMVVMVVM\"\nreversed_c_3 = c_3[::-1]\nc_4 = \"MMV MMVVMMMMMVVMMVVMMMVVMMVVVMVVMVVMMVVMMVVVVVM VMV MMVVVVMMV MMVVVMMM VMVVMMMVVVMVVM\"\nreversed_c_4 = c_4[::-1]\nc_5 = \"MMVVMMM VMVVMVVVMMVVMMVVVM VMVVVVVMVVMVVMMMMVVMMMMMVVMVVMMMVVVVVMV\"\n\n# mapping = {'M': '0', 'V': '1'}\n\nmapping1 = {'M': '1', 'V': '0'}\nmapping2 = {'M': '0', 'V': '1'}\n\n\n# print(decode_binary(c_1, mapping2)+decode_binary(c_2, mapping2) + decode_binary(c_3, mapping2) + decode_binary(c_4, mapping2) + decode_binary(c_5, mapping2) )\nprint(decode_binary(c_1, mapping2)+decode_binary(c_2, mapping2) + decode_binary(reversed_c_3, mapping2) + decode_binary(reversed_c_4, mapping2) + decode_binary(c_5, mapping2) )\n\n# 输出结果：x3c{i_d1dn't_kn0w_mvm_c0uld_be_us3d_f0r_b1n4ry_3nc0d1ng_l0l}\n\n```\n\n另外一个flag则是藏在右下角的勋章里：\n![屏幕截图 2025-01-25 210727](https://raw.githubusercontent.com/Lycorisby/Picture/main/屏幕截图 2025-01-25 210727.png)\n\n人工将这些内容识别出来然后用base64进行解码即可。\n\n内容大概为：\n\n```\n-----BEGIN CERTIFICATE-----\nMIIDyjCCAlCgAwIBAgISBKmF/S4TYSXpTzcor9eZJ/GrMAoGCC\nqGSM49BAMDMDIxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEwlMZXQn\ncyBFbmNyeXB0MQswOQYDVQQDEwJFNjAeFw0yNTAxMDYyMDM2MD\nFaFw0yNTA0MDYyMDM2MDBaMEAxPjA8BgNVBAMMNXgzY3ttdTV0\nX2IzX2Zlbl90eXAxbmdfdGgxcl9ieV9oNG5kXzEzNzUxMDUzMD\nQyNDgzNjF9MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcYu3\nflnEI2dttI5lQQmzRld72SDdBqCDtfto9pg5t/NFFIolkY8W8C\nryM9XlJEx3NAOGTgBoeUNTuWgiCseQeaOCAjYwggIyMA4GA1Ud\nDwEB/wQEAwIHgDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQ\nUHAwIwDAYDVR0TAQH/BAIwADAdBgNVRQ4EFgQUrbtyF28hjw8o\nIqwXpakw8t7J9jQwHwYDVR0jBBgwFoAUkydGmAOpUWiOmNbEQk\njbI79YlNIwVQYIKwYBBQUHAQEESTBHMCEGCCsGAQUFBzABhhVo\ndHRwOi8vZTYuby5sZW5jci5vcmcwIgYIKwYBBQUHMAKGFmh0dH\nA6Ly91Ni5pLmxlbmNyLm9yZy8wQAYDVR0RBDkwN4IleDNje2ll\nNXRfYjNfZnVuX3R5cDFuZl90aDFzX2J5X2g0bmRfMTM3NTEwNT\nMwNDI0ODM2MX0wEwYDVR0gBAwwCjAIBgZngQwBAgEwggEDBgor\nBgEEAdZ5AgQCBIH0BIHxAO8AdQB9WR4S4XggexxhZ3xe/fjQhl\nw0oE6VnrkDL9kOjC55uAAAAZQ9inTEAAAEAwBGMEQCIENpWRg9\n8SQo5JdzyjgnyFeUY0WnNVzn5NkdDA3bzeKbAiBsAkk3fe5esm\n7A0efsLN/EyFjEK/NBGqYxgOucgZheQwB2ABNK3xglmEIjeAxv\n70x6kaQWtyNJzlhXat+u2qfCq+AiAAAB1D2KdXoAAAQDAEcwRQ\nIgBfU4pkiNyNsl+I6skjXz6qqu+mNoI4JvtDsoYxoI+ZoCIQCR\niMQSCEwahN0ImXu3cwDeyM+AbNeve0VgSLMSUBdxvTAKBggghk\njOPQQDAwNoADBlAjEAvxa6nSpUMl7NuDB/+LJfzTskR498vLoe\ntnZuHo14J6d9zuFRGQ8Dk4w2aQNsbuVsAjB9fE6GJYBiebb4aH\nu/J2amych3KP//D951/CdmiV5PKZqXWWdpaQZL+pbmsXRa8rM=\n-----END CERTIFICATE-----\n```\n\n会有一些误差，所以最后提交flag时需要多试几次。\n\n\n\n### foundations （Osint）：\n\n题目描述：\n\n![image-20250127171132744](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171132744.png)\n\n\n\n使用https://archive.org/来搜索这个比赛网站的历史纪录内容\n\n![image-20250127171253342](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171253342.png)\n\n可以在这里发现最早的纪录是在2024年7月14日：\n\n![image-20250127171328034](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171328034.png)\n\n点进去会发现：\n![image-20250127171419684](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171419684.png)\n\nx3CTF{m4yb3_w3ll_m4ke_4_ch4ll3nge_0u7_0f_7h1s}\n\n\n\n### mvm：\n\n![image-20250127171618699](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171618699.png)\n\n打开下载文件会得到\n```\nMMVMVMVVMMVMVMVVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVMVMMVMVVVMMMVMVMVVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVMVVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVVVMMMVVVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMMVMVVMVMVMVVMVVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMVMVVMVVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVVVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVMVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMMVMVVVMMMVMVMVVMMVMVMVVMVMVVMVVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVVVVVMMMVMVVMVMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVM\n\n```\n\n跟之前一样，将其转成二进制再解码会得到\n\n```\n++[---------->+<]>.+++++++++.---------.-[->+++++<]>-.+[----->+<]>+.+++++++++.---------.-[---->+++++<]>.+[--->++<]>++.>-[--->+<]>---.--[->++++<]>+.++++++++.+++++.[-->+++++++++<]>.[--->+++++<]>.++++++++++.++++++++++++.-[----->+<]>.>-[--->+<]>.-[----->+<]>-.++++++++.------.-.++[->+++++<]>+.[----->++++<]>+.+++++++++.---------.>--[-->+++<]>.\n```\n\n很显然这是Brainfuck,所以找个在线的intepreter运行一下就可以得到flag：\n\n\n![image-20250127172039130](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127172039130.png)\n\nMVM{MVM_BRAIN_IS_FUCKED_MVM}\n\n\n\n### count-the-mvms\n\n主要是数背景的mvm个数，发现它们的像素点是一样的。所以写个图像匹配脚本即可.\n\n首先要把pdf转换成 png，推荐 adobe acrobat \n\n``` python\nimport cvlib\n# cvlib 是自己写的库\nim = cvlib.read_img(\"certificate_h4tum.png\")\nsim = cvlib.subrectimg(im, 605, 516, 837, 665)\nsim2 = cvlib.subrectimg(sim, 44, 32, 79, 48)\nmvm = cvlib.subrectimg(sim2, 2, 2, 32, 13)\nprint(\"read success\")\n\n\ndef match(im, x,y):\n    if x+len(mvm) > len(im):\n        return False\n    if y+len(mvm[0]) > len(im[0]):\n        return False\n    \n    for i in range(len(mvm)):\n        for j in range(len(mvm[i])):\n            [r,g,b] = mvm[i][j]\n            [ri,gi,bi] = im[x+i][y+j]        \n            if r != ri or g != gi or b != bi:\n                return False\n    return True\n            \ndef count_matches(im):\n    cnt = 0\n    for i in range(len(im)):\n        print(i)\n        for j in range(len(im[i])):\n            if match(im, i,j):\n                cnt += 1\n                j += len(mvm[0]) - 1\n    return cnt\n\nprint(count_matches(im))\nprint(\"finish\")\n\n```\n\n\n\n## 2. Crypto\n\n### man-vs-matrix:\n\n题目描述：\n\n![image-20250127172638257](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127172638257.png)\n\n打开下载文件会看到：\n\n```python\nfrom sage.all import *\nfrom Crypto.Util.number import bytes_to_long\n\nclass RNG:\n\n    def __init__(self, seed):\n        self.p = next_prime(2**24)          # 16777259\n        self.F = GF(self.p)\n        self.M = matrix(self.F, 3,3, [bytes_to_long(seed[i:i+3]) for i in range(0, len(seed), 3)])\n        self.state = vector(self.F, map(ord, \"Mvm\"))        # [77, 118, 109]\n        self.gen = self.F(2)\n\n    def get_random_num(self):\n        out = self.M * self.state\n\n        for i in range(len(self.state)):        # len = 3\n            self.state[i] = self.gen**self.state[i]\n\n        return out * self.state\n\nflag = b\"MVM{???????????????????????????}\"\nseed = flag[4:-1]               # 27位，27/3=9\n\nrng = RNG(seed)\nsamples = []\n\nfor i in range(9):\n    samples.append(rng.get_random_num())\n\nprint(f\"{samples = }\")\n# samples = [6192533, 82371, 86024, 4218430, 12259879, 16442850, 6736271, 7418630, 15483781]\n\n```\n\n是几个随机数的生成器（RNG），但生成逻辑非常简单。\n\n每次会计算\n$$\n(M \\cdot state) \\cdot new\\_state\n$$\n(括号外的乘法是内积。在sage里，矩阵与矩阵/向量的乘法和向量与向量的内积都是用*)。并且有\n$$\nnew\\_state[i] = 2^{state[i]}.\n$$\n这里的初始state是已知的，所以我们只需要建立一个9元1次线性方程组即可。\n\n我们可以写一段sagemath的代码来通过解方程逆推出matrix以及flag内容：\n\n```python\np = 16777259\t\t# = next_prime(2**24)\nF = GF(p)\n\nsamples = [6192533, 82371, 86024, 4218430, 12259879, 16442850, 6736271, 7418630, 15483781]\n\n# 初始状态 S0 = [77, 118, 109]\nS0 = vector(F, [77, 118, 109])\n\ndef next_state(st):\n    return vector(F, [F(2)^int(x) for x in st])\n\n# 求出 S0 ~ S9\nS = [None]*10\nS[0] = S0\nfor i in range(1, 10):\n    S[i] = next_state(S[i-1])\n\n# 构造线性方程组 X * M_vec = Y\nX = matrix(F, 9, 9)\nY = vector(F, 9)\n\nfor i in range(9):\n    row_coeffs = []\n    # M_vec 的顺序: M[0,0], M[0,1], M[0,2], M[1,0], ..., M[2,2]\n    for k in range(3):\n        for j in range(3):\n            row_coeffs.append(S[i][j] * S[i+1][k])\n    X[i] = row_coeffs\n    Y[i] = samples[i]\n\n# 求解 9 个未知量\nM_vec = X.solve_right(Y)\nM_mat = matrix(F, 3, 3, M_vec)\nprint(\"Recovered M =\")\nprint(M_mat)\n\n\n# 将 3x3 矩阵以行优先顺序（row-major）展开成 9 个元素\n# 对应当初 [bytes_to_long(seed[0:3]), bytes_to_long(seed[3:6]), ..., bytes_to_long(seed[24:27])]\nm_ints = []\nfor i in range(3):\n    for j in range(3):\n        # Sage 返回的是 GF(p) 的元素，先转成普通整型\n        val = int(M_mat[i, j])\n        m_ints.append(val)\n\n# 将每个 val 转成 3 字节后依次拼接\nseed_recovered = b\"\".join(val.to_bytes(3, \"big\") for val in m_ints)\n\n# 最终还原 flag = b\"MVM{\" + seed_recovered + b\"}\"\nflag_recovered = b\"MVM{\" + seed_recovered + b\"}\"\n\nprint(\"Recovered seed  =\", seed_recovered)\nprint(\"Recovered flag  =\", flag_recovered)\n\n#最后得到的结果：\n# Recovered M =\n# [7090542 3355762 6252149]\n# [5137236 3223662 3497780]\n# [7484255 7174495 6698102]\n# Recovered seed  = b'l1n34r_fuNcT10n5_4r3_my_f4v'\n# Recovered flag  = b'MVM{l1n34r_fuNcT10n5_4r3_my_f4v}'\n```\n\n","source":"_posts/x3ctf2025 Write Up.md","raw":"---\ntitle: x3ctf2025 Write Up\ndate: 2025-02-03 17:39:31\ntags:\nmath: true\n---\n\n# x3ctf Write Up\n\n\n\n## 1. Misc\n\n### p11n-trophy（签到题）:\n\n题目描述：\n![image-20250127165738440](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127165738440.png)\n\n我们首先会得到这样一份证书：\n\n![trophy](https://raw.githubusercontent.com/Lycorisby/Picture/main/trophy.png)\n\n\n\n第一题签到题的答案就是证书下面正中间的“This certificate does not grant the rank of Master\"。\n\n### trophy-plus + trophy-plus64:\n\n这两道目描述一模一样\n\n### ![image-20250127165834982](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127165834982.png)\n\n![](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127165903642.png)\n\n其中一个flag是藏在certificate周围一圈的位置：\n\n![image-20250127170254595](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127170254595.png)\n\n![image-20250127170344389](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127170344389.png)\n\n人工将这些内容识别，再翻译成二进制然后解码就会得到flag\n```python\ndef decode_binary(content, mapping):\n    # Convert content to binary using the mapping\n    binary_str = ''.join(mapping[char] for char in content if char in mapping)\n\n    # Split the binary string into 8-bit chunks\n    bytes_list = [binary_str[i:i+8] for i in range(0, len(binary_str), 8)]\n\n    # Convert each 8-bit chunk to a character\n    decoded_text = ''.join(chr(int(byte, 2)) for byte in bytes_list if len(byte) == 8)\n\n    return decoded_text\n\n# Input string\nc_1 = \"MVVVVMMMMMVVMMVVMVVMMMVVMVVVVMVVMVVM VMMV MV MVVVVVMVVMM VMM MMVVMMMV\"\nc_2 =   \"MVVMM VMMMVVMVVVMMM VMMVVVMVVVMV MMM VMVVVVVMVVM VMVVMVVMVVVMMMVVMMMMMVVVMVVVM VMVVVVV\"\nc_3 = \"VMMMVVMMM VMMMVVMVVVVVM VMMV MMVVVMMMMMVVMMMVVMMVVMVVVVVM VMMM VMMVVMVVMMVVMMVVMMVVVM VMV MVVVMVVVVVM VM VM VMMVVMMV MMMVVMVVVVVMV MMMV MMVVMMMVVMVVM VMV MVVVMMMMMVVMMVVMMMVVMVVVVVM VMV MVVMVVMMVVMVVVM VMVVMVVM\"\nreversed_c_3 = c_3[::-1]\nc_4 = \"MMV MMVVMMMMMVVMMVVMMMVVMMVVVMVVMVVMMVVMMVVVVVM VMV MMVVVVMMV MMVVVMMM VMVVMMMVVVMVVM\"\nreversed_c_4 = c_4[::-1]\nc_5 = \"MMVVMMM VMVVMVVVMMVVMMVVVM VMVVVVVMVVMVVMMMMVVMMMMMVVMVVMMMVVVVVMV\"\n\n# mapping = {'M': '0', 'V': '1'}\n\nmapping1 = {'M': '1', 'V': '0'}\nmapping2 = {'M': '0', 'V': '1'}\n\n\n# print(decode_binary(c_1, mapping2)+decode_binary(c_2, mapping2) + decode_binary(c_3, mapping2) + decode_binary(c_4, mapping2) + decode_binary(c_5, mapping2) )\nprint(decode_binary(c_1, mapping2)+decode_binary(c_2, mapping2) + decode_binary(reversed_c_3, mapping2) + decode_binary(reversed_c_4, mapping2) + decode_binary(c_5, mapping2) )\n\n# 输出结果：x3c{i_d1dn't_kn0w_mvm_c0uld_be_us3d_f0r_b1n4ry_3nc0d1ng_l0l}\n\n```\n\n另外一个flag则是藏在右下角的勋章里：\n![屏幕截图 2025-01-25 210727](https://raw.githubusercontent.com/Lycorisby/Picture/main/屏幕截图 2025-01-25 210727.png)\n\n人工将这些内容识别出来然后用base64进行解码即可。\n\n内容大概为：\n\n```\n-----BEGIN CERTIFICATE-----\nMIIDyjCCAlCgAwIBAgISBKmF/S4TYSXpTzcor9eZJ/GrMAoGCC\nqGSM49BAMDMDIxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEwlMZXQn\ncyBFbmNyeXB0MQswOQYDVQQDEwJFNjAeFw0yNTAxMDYyMDM2MD\nFaFw0yNTA0MDYyMDM2MDBaMEAxPjA8BgNVBAMMNXgzY3ttdTV0\nX2IzX2Zlbl90eXAxbmdfdGgxcl9ieV9oNG5kXzEzNzUxMDUzMD\nQyNDgzNjF9MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcYu3\nflnEI2dttI5lQQmzRld72SDdBqCDtfto9pg5t/NFFIolkY8W8C\nryM9XlJEx3NAOGTgBoeUNTuWgiCseQeaOCAjYwggIyMA4GA1Ud\nDwEB/wQEAwIHgDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQ\nUHAwIwDAYDVR0TAQH/BAIwADAdBgNVRQ4EFgQUrbtyF28hjw8o\nIqwXpakw8t7J9jQwHwYDVR0jBBgwFoAUkydGmAOpUWiOmNbEQk\njbI79YlNIwVQYIKwYBBQUHAQEESTBHMCEGCCsGAQUFBzABhhVo\ndHRwOi8vZTYuby5sZW5jci5vcmcwIgYIKwYBBQUHMAKGFmh0dH\nA6Ly91Ni5pLmxlbmNyLm9yZy8wQAYDVR0RBDkwN4IleDNje2ll\nNXRfYjNfZnVuX3R5cDFuZl90aDFzX2J5X2g0bmRfMTM3NTEwNT\nMwNDI0ODM2MX0wEwYDVR0gBAwwCjAIBgZngQwBAgEwggEDBgor\nBgEEAdZ5AgQCBIH0BIHxAO8AdQB9WR4S4XggexxhZ3xe/fjQhl\nw0oE6VnrkDL9kOjC55uAAAAZQ9inTEAAAEAwBGMEQCIENpWRg9\n8SQo5JdzyjgnyFeUY0WnNVzn5NkdDA3bzeKbAiBsAkk3fe5esm\n7A0efsLN/EyFjEK/NBGqYxgOucgZheQwB2ABNK3xglmEIjeAxv\n70x6kaQWtyNJzlhXat+u2qfCq+AiAAAB1D2KdXoAAAQDAEcwRQ\nIgBfU4pkiNyNsl+I6skjXz6qqu+mNoI4JvtDsoYxoI+ZoCIQCR\niMQSCEwahN0ImXu3cwDeyM+AbNeve0VgSLMSUBdxvTAKBggghk\njOPQQDAwNoADBlAjEAvxa6nSpUMl7NuDB/+LJfzTskR498vLoe\ntnZuHo14J6d9zuFRGQ8Dk4w2aQNsbuVsAjB9fE6GJYBiebb4aH\nu/J2amych3KP//D951/CdmiV5PKZqXWWdpaQZL+pbmsXRa8rM=\n-----END CERTIFICATE-----\n```\n\n会有一些误差，所以最后提交flag时需要多试几次。\n\n\n\n### foundations （Osint）：\n\n题目描述：\n\n![image-20250127171132744](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171132744.png)\n\n\n\n使用https://archive.org/来搜索这个比赛网站的历史纪录内容\n\n![image-20250127171253342](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171253342.png)\n\n可以在这里发现最早的纪录是在2024年7月14日：\n\n![image-20250127171328034](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171328034.png)\n\n点进去会发现：\n![image-20250127171419684](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171419684.png)\n\nx3CTF{m4yb3_w3ll_m4ke_4_ch4ll3nge_0u7_0f_7h1s}\n\n\n\n### mvm：\n\n![image-20250127171618699](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171618699.png)\n\n打开下载文件会得到\n```\nMMVMVMVVMMVMVMVVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVMVMMVMVVVMMMVMVMVVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVMVVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVVVMMMVVVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMMVMVVMVMVMVVMVVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMVMVVMVVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVVVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVMVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMMVMVVVMMMVMVMVVMMVMVMVVMVMVVMVVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVVVVVMMMVMVVMVMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVM\n\n```\n\n跟之前一样，将其转成二进制再解码会得到\n\n```\n++[---------->+<]>.+++++++++.---------.-[->+++++<]>-.+[----->+<]>+.+++++++++.---------.-[---->+++++<]>.+[--->++<]>++.>-[--->+<]>---.--[->++++<]>+.++++++++.+++++.[-->+++++++++<]>.[--->+++++<]>.++++++++++.++++++++++++.-[----->+<]>.>-[--->+<]>.-[----->+<]>-.++++++++.------.-.++[->+++++<]>+.[----->++++<]>+.+++++++++.---------.>--[-->+++<]>.\n```\n\n很显然这是Brainfuck,所以找个在线的intepreter运行一下就可以得到flag：\n\n\n![image-20250127172039130](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127172039130.png)\n\nMVM{MVM_BRAIN_IS_FUCKED_MVM}\n\n\n\n### count-the-mvms\n\n主要是数背景的mvm个数，发现它们的像素点是一样的。所以写个图像匹配脚本即可.\n\n首先要把pdf转换成 png，推荐 adobe acrobat \n\n``` python\nimport cvlib\n# cvlib 是自己写的库\nim = cvlib.read_img(\"certificate_h4tum.png\")\nsim = cvlib.subrectimg(im, 605, 516, 837, 665)\nsim2 = cvlib.subrectimg(sim, 44, 32, 79, 48)\nmvm = cvlib.subrectimg(sim2, 2, 2, 32, 13)\nprint(\"read success\")\n\n\ndef match(im, x,y):\n    if x+len(mvm) > len(im):\n        return False\n    if y+len(mvm[0]) > len(im[0]):\n        return False\n    \n    for i in range(len(mvm)):\n        for j in range(len(mvm[i])):\n            [r,g,b] = mvm[i][j]\n            [ri,gi,bi] = im[x+i][y+j]        \n            if r != ri or g != gi or b != bi:\n                return False\n    return True\n            \ndef count_matches(im):\n    cnt = 0\n    for i in range(len(im)):\n        print(i)\n        for j in range(len(im[i])):\n            if match(im, i,j):\n                cnt += 1\n                j += len(mvm[0]) - 1\n    return cnt\n\nprint(count_matches(im))\nprint(\"finish\")\n\n```\n\n\n\n## 2. Crypto\n\n### man-vs-matrix:\n\n题目描述：\n\n![image-20250127172638257](https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127172638257.png)\n\n打开下载文件会看到：\n\n```python\nfrom sage.all import *\nfrom Crypto.Util.number import bytes_to_long\n\nclass RNG:\n\n    def __init__(self, seed):\n        self.p = next_prime(2**24)          # 16777259\n        self.F = GF(self.p)\n        self.M = matrix(self.F, 3,3, [bytes_to_long(seed[i:i+3]) for i in range(0, len(seed), 3)])\n        self.state = vector(self.F, map(ord, \"Mvm\"))        # [77, 118, 109]\n        self.gen = self.F(2)\n\n    def get_random_num(self):\n        out = self.M * self.state\n\n        for i in range(len(self.state)):        # len = 3\n            self.state[i] = self.gen**self.state[i]\n\n        return out * self.state\n\nflag = b\"MVM{???????????????????????????}\"\nseed = flag[4:-1]               # 27位，27/3=9\n\nrng = RNG(seed)\nsamples = []\n\nfor i in range(9):\n    samples.append(rng.get_random_num())\n\nprint(f\"{samples = }\")\n# samples = [6192533, 82371, 86024, 4218430, 12259879, 16442850, 6736271, 7418630, 15483781]\n\n```\n\n是几个随机数的生成器（RNG），但生成逻辑非常简单。\n\n每次会计算\n$$\n(M \\cdot state) \\cdot new\\_state\n$$\n(括号外的乘法是内积。在sage里，矩阵与矩阵/向量的乘法和向量与向量的内积都是用*)。并且有\n$$\nnew\\_state[i] = 2^{state[i]}.\n$$\n这里的初始state是已知的，所以我们只需要建立一个9元1次线性方程组即可。\n\n我们可以写一段sagemath的代码来通过解方程逆推出matrix以及flag内容：\n\n```python\np = 16777259\t\t# = next_prime(2**24)\nF = GF(p)\n\nsamples = [6192533, 82371, 86024, 4218430, 12259879, 16442850, 6736271, 7418630, 15483781]\n\n# 初始状态 S0 = [77, 118, 109]\nS0 = vector(F, [77, 118, 109])\n\ndef next_state(st):\n    return vector(F, [F(2)^int(x) for x in st])\n\n# 求出 S0 ~ S9\nS = [None]*10\nS[0] = S0\nfor i in range(1, 10):\n    S[i] = next_state(S[i-1])\n\n# 构造线性方程组 X * M_vec = Y\nX = matrix(F, 9, 9)\nY = vector(F, 9)\n\nfor i in range(9):\n    row_coeffs = []\n    # M_vec 的顺序: M[0,0], M[0,1], M[0,2], M[1,0], ..., M[2,2]\n    for k in range(3):\n        for j in range(3):\n            row_coeffs.append(S[i][j] * S[i+1][k])\n    X[i] = row_coeffs\n    Y[i] = samples[i]\n\n# 求解 9 个未知量\nM_vec = X.solve_right(Y)\nM_mat = matrix(F, 3, 3, M_vec)\nprint(\"Recovered M =\")\nprint(M_mat)\n\n\n# 将 3x3 矩阵以行优先顺序（row-major）展开成 9 个元素\n# 对应当初 [bytes_to_long(seed[0:3]), bytes_to_long(seed[3:6]), ..., bytes_to_long(seed[24:27])]\nm_ints = []\nfor i in range(3):\n    for j in range(3):\n        # Sage 返回的是 GF(p) 的元素，先转成普通整型\n        val = int(M_mat[i, j])\n        m_ints.append(val)\n\n# 将每个 val 转成 3 字节后依次拼接\nseed_recovered = b\"\".join(val.to_bytes(3, \"big\") for val in m_ints)\n\n# 最终还原 flag = b\"MVM{\" + seed_recovered + b\"}\"\nflag_recovered = b\"MVM{\" + seed_recovered + b\"}\"\n\nprint(\"Recovered seed  =\", seed_recovered)\nprint(\"Recovered flag  =\", flag_recovered)\n\n#最后得到的结果：\n# Recovered M =\n# [7090542 3355762 6252149]\n# [5137236 3223662 3497780]\n# [7484255 7174495 6698102]\n# Recovered seed  = b'l1n34r_fuNcT10n5_4r3_my_f4v'\n# Recovered flag  = b'MVM{l1n34r_fuNcT10n5_4r3_my_f4v}'\n```\n\n","slug":"x3ctf2025 Write Up","published":1,"updated":"2025-02-04T17:12:24.645Z","comments":1,"layout":"post","photos":[],"_id":"cm6qr0i9k0001yokj6jidcpxn","content":"<h1 id=\"x3ctf-write-up\"><a class=\"anchor\" href=\"#x3ctf-write-up\">#</a> x3ctf Write Up</h1>\n<h2 id=\"1-misc\"><a class=\"anchor\" href=\"#1-misc\">#</a> 1. Misc</h2>\n<h3 id=\"p11n-trophy签到题\"><a class=\"anchor\" href=\"#p11n-trophy签到题\">#</a> p11n-trophy（签到题）:</h3>\n<p>题目描述：<br>\n<img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127165738440.png\" alt=\"image-20250127165738440\"></p>\n<p>我们首先会得到这样一份证书：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/trophy.png\" alt=\"trophy\"></p>\n<p>第一题签到题的答案就是证书下面正中间的 “This certificate does not grant the rank of Master&quot;。</p>\n<h3 id=\"trophy-plus-trophy-plus64\"><a class=\"anchor\" href=\"#trophy-plus-trophy-plus64\">#</a> trophy-plus + trophy-plus64:</h3>\n<p>这两道目描述一模一样</p>\n<h3 id=\"image-20250127165834982\"><a class=\"anchor\" href=\"#image-20250127165834982\">#</a> <img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127165834982.png\" alt=\"image-20250127165834982\"></h3>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127165903642.png\" alt></p>\n<p>其中一个 flag 是藏在 certificate 周围一圈的位置：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127170254595.png\" alt=\"image-20250127170254595\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127170344389.png\" alt=\"image-20250127170344389\"></p>\n<p>人工将这些内容识别，再翻译成二进制然后解码就会得到 flag</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">decode_binary</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">,</span> mapping<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\"># Convert content to binary using the mapping</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    binary_str <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>mapping<span class=\"token punctuation\">[</span>char<span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> char <span class=\"token keyword\">in</span> content <span class=\"token keyword\">if</span> char <span class=\"token keyword\">in</span> mapping<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\"># Split the binary string into 8-bit chunks</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    bytes_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>binary_str<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">:</span>i<span class=\"token operator\">+</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>binary_str<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token comment\"># Convert each 8-bit chunk to a character</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    decoded_text <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>byte<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> byte <span class=\"token keyword\">in</span> bytes_list <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>byte<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">return</span> decoded_text</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># Input string</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>c_1 <span class=\"token operator\">=</span> <span class=\"token string\">\"MVVVVMMMMMVVMMVVMVVMMMVVMVVVVMVVMVVM VMMV MV MVVVVVMVVMM VMM MMVVMMMV\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>c_2 <span class=\"token operator\">=</span>   <span class=\"token string\">\"MVVMM VMMMVVMVVVMMM VMMVVVMVVVMV MMM VMVVVVVMVVM VMVVMVVMVVVMMMVVMMMMMVVVMVVVM VMVVVVV\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>c_3 <span class=\"token operator\">=</span> <span class=\"token string\">\"VMMMVVMMM VMMMVVMVVVVVM VMMV MMVVVMMMMMVVMMMVVMMVVMVVVVVM VMMM VMMVVMVVMMVVMMVVMMVVVM VMV MVVVMVVVVVM VM VM VMMVVMMV MMMVVMVVVVVMV MMMV MMVVMMMVVMVVM VMV MVVVMMMMMVVMMVVMMMVVMVVVVVM VMV MVVMVVMMVVMVVVM VMVVMVVM\"</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>reversed_c_3 <span class=\"token operator\">=</span> c_3<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>c_4 <span class=\"token operator\">=</span> <span class=\"token string\">\"MMV MMVVMMMMMVVMMVVMMMVVMMVVVMVVMVVMMVVMMVVVVVM VMV MMVVVVMMV MMVVVMMM VMVVMMMVVVMVVM\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>reversed_c_4 <span class=\"token operator\">=</span> c_4<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>c_5 <span class=\"token operator\">=</span> <span class=\"token string\">\"MMVVMMM VMVVMVVVMMVVMMVVVM VMVVVVVMVVMVVMMMMVVMMMMMVVMVVMMMVVVVVMV\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\"># mapping = &#123;'M': '0', 'V': '1'&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>mapping1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'M'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'V'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>mapping2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'M'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'V'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\"># print(decode_binary(c_1, mapping2)+decode_binary(c_2, mapping2) + decode_binary(c_3, mapping2) + decode_binary(c_4, mapping2) + decode_binary(c_5, mapping2) )</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>decode_binary<span class=\"token punctuation\">(</span>c_1<span class=\"token punctuation\">,</span> mapping2<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>decode_binary<span class=\"token punctuation\">(</span>c_2<span class=\"token punctuation\">,</span> mapping2<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> decode_binary<span class=\"token punctuation\">(</span>reversed_c_3<span class=\"token punctuation\">,</span> mapping2<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> decode_binary<span class=\"token punctuation\">(</span>reversed_c_4<span class=\"token punctuation\">,</span> mapping2<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> decode_binary<span class=\"token punctuation\">(</span>c_5<span class=\"token punctuation\">,</span> mapping2<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\"># 输出结果：x3c &#123;i_d1dn't_kn0w_mvm_c0uld_be_us3d_f0r_b1n4ry_3nc0d1ng_l0l&#125;</span></pre></td></tr></table></figure><p>另外一个 flag 则是藏在右下角的勋章里：<br>\n![屏幕截图 2025-01-25 210727](<a href=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE\">https://raw.githubusercontent.com/Lycorisby/Picture/main/ 屏幕截图</a> 2025-01-25 210727.png)</p>\n<p>人工将这些内容识别出来然后用 base64 进行解码即可。</p>\n<p>内容大概为：</p>\n<pre><code>-----BEGIN CERTIFICATE-----\nMIIDyjCCAlCgAwIBAgISBKmF/S4TYSXpTzcor9eZJ/GrMAoGCC\nqGSM49BAMDMDIxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEwlMZXQn\ncyBFbmNyeXB0MQswOQYDVQQDEwJFNjAeFw0yNTAxMDYyMDM2MD\nFaFw0yNTA0MDYyMDM2MDBaMEAxPjA8BgNVBAMMNXgzY3ttdTV0\nX2IzX2Zlbl90eXAxbmdfdGgxcl9ieV9oNG5kXzEzNzUxMDUzMD\nQyNDgzNjF9MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcYu3\nflnEI2dttI5lQQmzRld72SDdBqCDtfto9pg5t/NFFIolkY8W8C\nryM9XlJEx3NAOGTgBoeUNTuWgiCseQeaOCAjYwggIyMA4GA1Ud\nDwEB/wQEAwIHgDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQ\nUHAwIwDAYDVR0TAQH/BAIwADAdBgNVRQ4EFgQUrbtyF28hjw8o\nIqwXpakw8t7J9jQwHwYDVR0jBBgwFoAUkydGmAOpUWiOmNbEQk\njbI79YlNIwVQYIKwYBBQUHAQEESTBHMCEGCCsGAQUFBzABhhVo\ndHRwOi8vZTYuby5sZW5jci5vcmcwIgYIKwYBBQUHMAKGFmh0dH\nA6Ly91Ni5pLmxlbmNyLm9yZy8wQAYDVR0RBDkwN4IleDNje2ll\nNXRfYjNfZnVuX3R5cDFuZl90aDFzX2J5X2g0bmRfMTM3NTEwNT\nMwNDI0ODM2MX0wEwYDVR0gBAwwCjAIBgZngQwBAgEwggEDBgor\nBgEEAdZ5AgQCBIH0BIHxAO8AdQB9WR4S4XggexxhZ3xe/fjQhl\nw0oE6VnrkDL9kOjC55uAAAAZQ9inTEAAAEAwBGMEQCIENpWRg9\n8SQo5JdzyjgnyFeUY0WnNVzn5NkdDA3bzeKbAiBsAkk3fe5esm\n7A0efsLN/EyFjEK/NBGqYxgOucgZheQwB2ABNK3xglmEIjeAxv\n70x6kaQWtyNJzlhXat+u2qfCq+AiAAAB1D2KdXoAAAQDAEcwRQ\nIgBfU4pkiNyNsl+I6skjXz6qqu+mNoI4JvtDsoYxoI+ZoCIQCR\niMQSCEwahN0ImXu3cwDeyM+AbNeve0VgSLMSUBdxvTAKBggghk\njOPQQDAwNoADBlAjEAvxa6nSpUMl7NuDB/+LJfzTskR498vLoe\ntnZuHo14J6d9zuFRGQ8Dk4w2aQNsbuVsAjB9fE6GJYBiebb4aH\nu/J2amych3KP//D951/CdmiV5PKZqXWWdpaQZL+pbmsXRa8rM=\n-----END CERTIFICATE-----\n</code></pre>\n<p>会有一些误差，所以最后提交 flag 时需要多试几次。</p>\n<h3 id=\"foundations-osint\"><a class=\"anchor\" href=\"#foundations-osint\">#</a> foundations （Osint）：</h3>\n<p>题目描述：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171132744.png\" alt=\"image-20250127171132744\"></p>\n<p>使用<a href=\"https://archive.org/%E6%9D%A5%E6%90%9C%E7%B4%A2%E8%BF%99%E4%B8%AA%E6%AF%94%E8%B5%9B%E7%BD%91%E7%AB%99%E7%9A%84%E5%8E%86%E5%8F%B2%E7%BA%AA%E5%BD%95%E5%86%85%E5%AE%B9\"> https://archive.org/ 来搜索这个比赛网站的历史纪录内容</a></p>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171253342.png\" alt=\"image-20250127171253342\"></p>\n<p>可以在这里发现最早的纪录是在 2024 年 7 月 14 日：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171328034.png\" alt=\"image-20250127171328034\"></p>\n<p>点进去会发现：<br>\n<img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171419684.png\" alt=\"image-20250127171419684\"></p>\n<p m4yb3_w3ll_m4ke_4_ch4ll3nge_0u7_0f_7h1s>x3CTF</p>\n<h3 id=\"mvm\"><a class=\"anchor\" href=\"#mvm\">#</a> mvm：</h3>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171618699.png\" alt=\"image-20250127171618699\"></p>\n<p>打开下载文件会得到</p>\n<pre><code>MMVMVMVVMMVMVMVVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVMVMMVMVVVMMMVMVMVVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVMVVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVVVMMMVVVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMMVMVVMVMVMVVMVVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMVMVVMVVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVVVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVMVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMMVMVVVMMMVMVMVVMMVMVMVVMVMVVMVVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVVVVVMMMVMVVMVMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVM\n\n</code></pre>\n<p>跟之前一样，将其转成二进制再解码会得到</p>\n<pre><code>++[----------&gt;+&lt;]&gt;.+++++++++.---------.-[-&gt;+++++&lt;]&gt;-.+[-----&gt;+&lt;]&gt;+.+++++++++.---------.-[----&gt;+++++&lt;]&gt;.+[---&gt;++&lt;]&gt;++.&gt;-[---&gt;+&lt;]&gt;---.--[-&gt;++++&lt;]&gt;+.++++++++.+++++.[--&gt;+++++++++&lt;]&gt;.[---&gt;+++++&lt;]&gt;.++++++++++.++++++++++++.-[-----&gt;+&lt;]&gt;.&gt;-[---&gt;+&lt;]&gt;.-[-----&gt;+&lt;]&gt;-.++++++++.------.-.++[-&gt;+++++&lt;]&gt;+.[-----&gt;++++&lt;]&gt;+.+++++++++.---------.&gt;--[--&gt;+++&lt;]&gt;.\n</code></pre>\n<p>很显然这是 Brainfuck, 所以找个在线的 intepreter 运行一下就可以得到 flag：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127172039130.png\" alt=\"image-20250127172039130\"></p>\n<p mvm_brain_is_fucked_mvm>MVM</p>\n<h3 id=\"count-the-mvms\"><a class=\"anchor\" href=\"#count-the-mvms\">#</a> count-the-mvms</h3>\n<p>主要是数背景的 mvm 个数，发现它们的像素点是一样的。所以写个图像匹配脚本即可.</p>\n<p>首先要把 pdf 转换成 png，推荐 adobe acrobat</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> cvlib</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># cvlib 是自己写的库</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>im <span class=\"token operator\">=</span> cvlib<span class=\"token punctuation\">.</span>read_img<span class=\"token punctuation\">(</span><span class=\"token string\">\"certificate_h4tum.png\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>sim <span class=\"token operator\">=</span> cvlib<span class=\"token punctuation\">.</span>subrectimg<span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">,</span> <span class=\"token number\">605</span><span class=\"token punctuation\">,</span> <span class=\"token number\">516</span><span class=\"token punctuation\">,</span> <span class=\"token number\">837</span><span class=\"token punctuation\">,</span> <span class=\"token number\">665</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>sim2 <span class=\"token operator\">=</span> cvlib<span class=\"token punctuation\">.</span>subrectimg<span class=\"token punctuation\">(</span>sim<span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">79</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>mvm <span class=\"token operator\">=</span> cvlib<span class=\"token punctuation\">.</span>subrectimg<span class=\"token punctuation\">(</span>sim2<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"read success\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">match</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">if</span> x<span class=\"token operator\">+</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>mvm<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">if</span> y<span class=\"token operator\">+</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>mvm<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>mvm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>mvm<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token punctuation\">[</span>r<span class=\"token punctuation\">,</span>g<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> mvm<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token punctuation\">[</span>ri<span class=\"token punctuation\">,</span>gi<span class=\"token punctuation\">,</span>bi<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> im<span class=\"token punctuation\">[</span>x<span class=\"token operator\">+</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>y<span class=\"token operator\">+</span>j<span class=\"token punctuation\">]</span>        </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token keyword\">if</span> r <span class=\"token operator\">!=</span> ri <span class=\"token keyword\">or</span> g <span class=\"token operator\">!=</span> gi <span class=\"token keyword\">or</span> b <span class=\"token operator\">!=</span> bi<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            </pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">count_matches</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    cnt <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token keyword\">match</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span>j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                cnt <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                j <span class=\"token operator\">+=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>mvm<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">return</span> cnt</pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>count_matches<span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"finish\"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"2-crypto\"><a class=\"anchor\" href=\"#2-crypto\">#</a> 2. Crypto</h2>\n<h3 id=\"man-vs-matrix\"><a class=\"anchor\" href=\"#man-vs-matrix\">#</a> man-vs-matrix:</h3>\n<p>题目描述：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127172638257.png\" alt=\"image-20250127172638257\"></p>\n<p>打开下载文件会看到：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> sage<span class=\"token punctuation\">.</span><span class=\"token builtin\">all</span> <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> bytes_to_long</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">RNG</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> seed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        self<span class=\"token punctuation\">.</span>p <span class=\"token operator\">=</span> next_prime<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">**</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span>          <span class=\"token comment\"># 16777259</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        self<span class=\"token punctuation\">.</span>F <span class=\"token operator\">=</span> GF<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        self<span class=\"token punctuation\">.</span>M <span class=\"token operator\">=</span> matrix<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>F<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>bytes_to_long<span class=\"token punctuation\">(</span>seed<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">:</span>i<span class=\"token operator\">+</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>seed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        self<span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> vector<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>F<span class=\"token punctuation\">,</span> <span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Mvm\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>        <span class=\"token comment\"># [77, 118, 109]</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        self<span class=\"token punctuation\">.</span>gen <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>F<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">get_random_num</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        out <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>M <span class=\"token operator\">*</span> self<span class=\"token punctuation\">.</span>state</pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>        <span class=\"token comment\"># len = 3</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            self<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>gen<span class=\"token operator\">**</span>self<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">return</span> out <span class=\"token operator\">*</span> self<span class=\"token punctuation\">.</span>state</pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token string\">b\"MVM&#123;???????????????????????????&#125;\"</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>seed <span class=\"token operator\">=</span> flag<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>               <span class=\"token comment\"># 27 位，27/3=9</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>rng <span class=\"token operator\">=</span> RNG<span class=\"token punctuation\">(</span>seed<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>samples <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    samples<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>rng<span class=\"token punctuation\">.</span>get_random_num<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>samples <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\"># samples = [6192533, 82371, 86024, 4218430, 12259879, 16442850, 6736271, 7418630, 15483781]</span></pre></td></tr></table></figure><p>是几个随机数的生成器（RNG），但生成逻辑非常简单。</p>\n<p>每次会计算</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>M</mi><mo>⋅</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>n</mi><mi>e</mi><mi>w</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">(M \\cdot state) \\cdot new\\_state\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9251em;vertical-align:-0.31em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span></span></span></span></span></p>\n<p>(括号外的乘法是内积。在 sage 里，矩阵与矩阵 / 向量的乘法和向量与向量的内积都是用 *)。并且有</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>n</mi><mi>e</mi><mi>w</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo>=</mo><msup><mn>2</mn><mrow><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo></mrow></msup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">new\\_state[i] = 2^{state[i]}.\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.938em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mopen mtight\">[</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mclose mtight\">]</span></span></span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span></p>\n<p>这里的初始 state 是已知的，所以我们只需要建立一个 9 元 1 次线性方程组即可。</p>\n<p>我们可以写一段 sagemath 的代码来通过解方程逆推出 matrix 以及 flag 内容：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>p <span class=\"token operator\">=</span> <span class=\"token number\">16777259</span>\t\t<span class=\"token comment\"># = next_prime(2**24)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>F <span class=\"token operator\">=</span> GF<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>samples <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">6192533</span><span class=\"token punctuation\">,</span> <span class=\"token number\">82371</span><span class=\"token punctuation\">,</span> <span class=\"token number\">86024</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4218430</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12259879</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16442850</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6736271</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7418630</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15483781</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 初始状态 S0 = [77, 118, 109]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>S0 <span class=\"token operator\">=</span> vector<span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">77</span><span class=\"token punctuation\">,</span> <span class=\"token number\">118</span><span class=\"token punctuation\">,</span> <span class=\"token number\">109</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">next_state</span><span class=\"token punctuation\">(</span>st<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">return</span> vector<span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>F<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> st<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># 求出 S0 ~ S9</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>S <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>S<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> S0</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    S<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> next_state<span class=\"token punctuation\">(</span>S<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\"># 构造线性方程组 X * M_vec = Y</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>X <span class=\"token operator\">=</span> matrix<span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>Y <span class=\"token operator\">=</span> vector<span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    row_coeffs <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token comment\"># M_vec 的顺序: M [0,0], M [0,1], M [0,2], M [1,0], ..., M [2,2]</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">for</span> k <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            row_coeffs<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>S<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> S<span class=\"token punctuation\">[</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    X<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> row_coeffs</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    Y<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> samples<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\"># 求解 9 个未知量</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>M_vec <span class=\"token operator\">=</span> X<span class=\"token punctuation\">.</span>solve_right<span class=\"token punctuation\">(</span>Y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>M_mat <span class=\"token operator\">=</span> matrix<span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> M_vec<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Recovered M =\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>M_mat<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token comment\"># 将 3x3 矩阵以行优先顺序（row-major）展开成 9 个元素</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token comment\"># 对应当初 [bytes_to_long (seed [0:3]), bytes_to_long (seed [3:6]), ..., bytes_to_long (seed [24:27])]</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>m_ints <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token comment\"># Sage 返回的是 GF (p) 的元素，先转成普通整型</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        val <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>M_mat<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        m_ints<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token comment\"># 将每个 val 转成 3 字节后依次拼接</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>seed_recovered <span class=\"token operator\">=</span> <span class=\"token string\">b\"\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">.</span>to_bytes<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"big\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> val <span class=\"token keyword\">in</span> m_ints<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token comment\"># 最终还原 flag = b\"MVM &#123;\" + seed_recovered + b\"&#125;\"</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>flag_recovered <span class=\"token operator\">=</span> <span class=\"token string\">b\"MVM&#123;\"</span> <span class=\"token operator\">+</span> seed_recovered <span class=\"token operator\">+</span> <span class=\"token string\">b\"&#125;\"</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Recovered seed  =\"</span><span class=\"token punctuation\">,</span> seed_recovered<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Recovered flag  =\"</span><span class=\"token punctuation\">,</span> flag_recovered<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token comment\">#最后得到的结果：</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token comment\"># Recovered M =</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token comment\"># [7090542 3355762 6252149]</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token comment\"># [5137236 3223662 3497780]</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token comment\"># [7484255 7174495 6698102]</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token comment\"># Recovered seed  = b'l1n34r_fuNcT10n5_4r3_my_f4v'</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token comment\"># Recovered flag  = b'MVM&#123;l1n34r_fuNcT10n5_4r3_my_f4v&#125;'</span></pre></td></tr></table></figure>","length":9490,"excerpt":"","more":"<h1 id=\"x3ctf-write-up\"><a class=\"anchor\" href=\"#x3ctf-write-up\">#</a> x3ctf Write Up</h1>\n<h2 id=\"1-misc\"><a class=\"anchor\" href=\"#1-misc\">#</a> 1. Misc</h2>\n<h3 id=\"p11n-trophy签到题\"><a class=\"anchor\" href=\"#p11n-trophy签到题\">#</a> p11n-trophy（签到题）:</h3>\n<p>题目描述：<br>\n<img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127165738440.png\" alt=\"image-20250127165738440\"></p>\n<p>我们首先会得到这样一份证书：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/trophy.png\" alt=\"trophy\"></p>\n<p>第一题签到题的答案就是证书下面正中间的 “This certificate does not grant the rank of Master&quot;。</p>\n<h3 id=\"trophy-plus-trophy-plus64\"><a class=\"anchor\" href=\"#trophy-plus-trophy-plus64\">#</a> trophy-plus + trophy-plus64:</h3>\n<p>这两道目描述一模一样</p>\n<h3 id=\"image-20250127165834982\"><a class=\"anchor\" href=\"#image-20250127165834982\">#</a> <img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127165834982.png\" alt=\"image-20250127165834982\"></h3>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127165903642.png\" alt></p>\n<p>其中一个 flag 是藏在 certificate 周围一圈的位置：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127170254595.png\" alt=\"image-20250127170254595\"></p>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127170344389.png\" alt=\"image-20250127170344389\"></p>\n<p>人工将这些内容识别，再翻译成二进制然后解码就会得到 flag</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">decode_binary</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">,</span> mapping<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\"># Convert content to binary using the mapping</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    binary_str <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>mapping<span class=\"token punctuation\">[</span>char<span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> char <span class=\"token keyword\">in</span> content <span class=\"token keyword\">if</span> char <span class=\"token keyword\">in</span> mapping<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\"># Split the binary string into 8-bit chunks</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    bytes_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>binary_str<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">:</span>i<span class=\"token operator\">+</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>binary_str<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token comment\"># Convert each 8-bit chunk to a character</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    decoded_text <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>byte<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> byte <span class=\"token keyword\">in</span> bytes_list <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>byte<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">8</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">return</span> decoded_text</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\"># Input string</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>c_1 <span class=\"token operator\">=</span> <span class=\"token string\">\"MVVVVMMMMMVVMMVVMVVMMMVVMVVVVMVVMVVM VMMV MV MVVVVVMVVMM VMM MMVVMMMV\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>c_2 <span class=\"token operator\">=</span>   <span class=\"token string\">\"MVVMM VMMMVVMVVVMMM VMMVVVMVVVMV MMM VMVVVVVMVVM VMVVMVVMVVVMMMVVMMMMMVVVMVVVM VMVVVVV\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>c_3 <span class=\"token operator\">=</span> <span class=\"token string\">\"VMMMVVMMM VMMMVVMVVVVVM VMMV MMVVVMMMMMVVMMMVVMMVVMVVVVVM VMMM VMMVVMVVMMVVMMVVMMVVVM VMV MVVVMVVVVVM VM VM VMMVVMMV MMMVVMVVVVVMV MMMV MMVVMMMVVMVVM VMV MVVVMMMMMVVMMVVMMMVVMVVVVVM VMV MVVMVVMMVVMVVVM VMVVMVVM\"</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>reversed_c_3 <span class=\"token operator\">=</span> c_3<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>c_4 <span class=\"token operator\">=</span> <span class=\"token string\">\"MMV MMVVMMMMMVVMMVVMMMVVMMVVVMVVMVVMMVVMMVVVVVM VMV MMVVVVMMV MMVVVMMM VMVVMMMVVVMVVM\"</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>reversed_c_4 <span class=\"token operator\">=</span> c_4<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>c_5 <span class=\"token operator\">=</span> <span class=\"token string\">\"MMVVMMM VMVVMVVVMMVVMMVVVM VMVVVVVMVVMVVMMMMVVMMMMMVVMVVMMMVVVVVMV\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\"># mapping = &#123;'M': '0', 'V': '1'&#125;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>mapping1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'M'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'V'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>mapping2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token string\">'M'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'V'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\"># print(decode_binary(c_1, mapping2)+decode_binary(c_2, mapping2) + decode_binary(c_3, mapping2) + decode_binary(c_4, mapping2) + decode_binary(c_5, mapping2) )</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>decode_binary<span class=\"token punctuation\">(</span>c_1<span class=\"token punctuation\">,</span> mapping2<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span>decode_binary<span class=\"token punctuation\">(</span>c_2<span class=\"token punctuation\">,</span> mapping2<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> decode_binary<span class=\"token punctuation\">(</span>reversed_c_3<span class=\"token punctuation\">,</span> mapping2<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> decode_binary<span class=\"token punctuation\">(</span>reversed_c_4<span class=\"token punctuation\">,</span> mapping2<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> decode_binary<span class=\"token punctuation\">(</span>c_5<span class=\"token punctuation\">,</span> mapping2<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\"># 输出结果：x3c &#123;i_d1dn't_kn0w_mvm_c0uld_be_us3d_f0r_b1n4ry_3nc0d1ng_l0l&#125;</span></pre></td></tr></table></figure><p>另外一个 flag 则是藏在右下角的勋章里：<br>\n![屏幕截图 2025-01-25 210727](<a href=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE\">https://raw.githubusercontent.com/Lycorisby/Picture/main/ 屏幕截图</a> 2025-01-25 210727.png)</p>\n<p>人工将这些内容识别出来然后用 base64 进行解码即可。</p>\n<p>内容大概为：</p>\n<pre><code>-----BEGIN CERTIFICATE-----\nMIIDyjCCAlCgAwIBAgISBKmF/S4TYSXpTzcor9eZJ/GrMAoGCC\nqGSM49BAMDMDIxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEwlMZXQn\ncyBFbmNyeXB0MQswOQYDVQQDEwJFNjAeFw0yNTAxMDYyMDM2MD\nFaFw0yNTA0MDYyMDM2MDBaMEAxPjA8BgNVBAMMNXgzY3ttdTV0\nX2IzX2Zlbl90eXAxbmdfdGgxcl9ieV9oNG5kXzEzNzUxMDUzMD\nQyNDgzNjF9MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcYu3\nflnEI2dttI5lQQmzRld72SDdBqCDtfto9pg5t/NFFIolkY8W8C\nryM9XlJEx3NAOGTgBoeUNTuWgiCseQeaOCAjYwggIyMA4GA1Ud\nDwEB/wQEAwIHgDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQ\nUHAwIwDAYDVR0TAQH/BAIwADAdBgNVRQ4EFgQUrbtyF28hjw8o\nIqwXpakw8t7J9jQwHwYDVR0jBBgwFoAUkydGmAOpUWiOmNbEQk\njbI79YlNIwVQYIKwYBBQUHAQEESTBHMCEGCCsGAQUFBzABhhVo\ndHRwOi8vZTYuby5sZW5jci5vcmcwIgYIKwYBBQUHMAKGFmh0dH\nA6Ly91Ni5pLmxlbmNyLm9yZy8wQAYDVR0RBDkwN4IleDNje2ll\nNXRfYjNfZnVuX3R5cDFuZl90aDFzX2J5X2g0bmRfMTM3NTEwNT\nMwNDI0ODM2MX0wEwYDVR0gBAwwCjAIBgZngQwBAgEwggEDBgor\nBgEEAdZ5AgQCBIH0BIHxAO8AdQB9WR4S4XggexxhZ3xe/fjQhl\nw0oE6VnrkDL9kOjC55uAAAAZQ9inTEAAAEAwBGMEQCIENpWRg9\n8SQo5JdzyjgnyFeUY0WnNVzn5NkdDA3bzeKbAiBsAkk3fe5esm\n7A0efsLN/EyFjEK/NBGqYxgOucgZheQwB2ABNK3xglmEIjeAxv\n70x6kaQWtyNJzlhXat+u2qfCq+AiAAAB1D2KdXoAAAQDAEcwRQ\nIgBfU4pkiNyNsl+I6skjXz6qqu+mNoI4JvtDsoYxoI+ZoCIQCR\niMQSCEwahN0ImXu3cwDeyM+AbNeve0VgSLMSUBdxvTAKBggghk\njOPQQDAwNoADBlAjEAvxa6nSpUMl7NuDB/+LJfzTskR498vLoe\ntnZuHo14J6d9zuFRGQ8Dk4w2aQNsbuVsAjB9fE6GJYBiebb4aH\nu/J2amych3KP//D951/CdmiV5PKZqXWWdpaQZL+pbmsXRa8rM=\n-----END CERTIFICATE-----\n</code></pre>\n<p>会有一些误差，所以最后提交 flag 时需要多试几次。</p>\n<h3 id=\"foundations-osint\"><a class=\"anchor\" href=\"#foundations-osint\">#</a> foundations （Osint）：</h3>\n<p>题目描述：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171132744.png\" alt=\"image-20250127171132744\"></p>\n<p>使用<a href=\"https://archive.org/%E6%9D%A5%E6%90%9C%E7%B4%A2%E8%BF%99%E4%B8%AA%E6%AF%94%E8%B5%9B%E7%BD%91%E7%AB%99%E7%9A%84%E5%8E%86%E5%8F%B2%E7%BA%AA%E5%BD%95%E5%86%85%E5%AE%B9\"> https://archive.org/ 来搜索这个比赛网站的历史纪录内容</a></p>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171253342.png\" alt=\"image-20250127171253342\"></p>\n<p>可以在这里发现最早的纪录是在 2024 年 7 月 14 日：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171328034.png\" alt=\"image-20250127171328034\"></p>\n<p>点进去会发现：<br>\n<img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171419684.png\" alt=\"image-20250127171419684\"></p>\n<p m4yb3_w3ll_m4ke_4_ch4ll3nge_0u7_0f_7h1s>x3CTF</p>\n<h3 id=\"mvm\"><a class=\"anchor\" href=\"#mvm\">#</a> mvm：</h3>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127171618699.png\" alt=\"image-20250127171618699\"></p>\n<p>打开下载文件会得到</p>\n<pre><code>MMVMVMVVMMVMVMVVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVMVMMVMVVVMMMVMVMVVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVMVVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVVVMMMVVVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMMVMVVMVMVMVVMVVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMVMVVMVVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVVVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVMVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMMVMVVVMMMVMVMVVMMVMVMVVMVMVVMVVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVVVVVMMMVMVVMVMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVM\n\n</code></pre>\n<p>跟之前一样，将其转成二进制再解码会得到</p>\n<pre><code>++[----------&gt;+&lt;]&gt;.+++++++++.---------.-[-&gt;+++++&lt;]&gt;-.+[-----&gt;+&lt;]&gt;+.+++++++++.---------.-[----&gt;+++++&lt;]&gt;.+[---&gt;++&lt;]&gt;++.&gt;-[---&gt;+&lt;]&gt;---.--[-&gt;++++&lt;]&gt;+.++++++++.+++++.[--&gt;+++++++++&lt;]&gt;.[---&gt;+++++&lt;]&gt;.++++++++++.++++++++++++.-[-----&gt;+&lt;]&gt;.&gt;-[---&gt;+&lt;]&gt;.-[-----&gt;+&lt;]&gt;-.++++++++.------.-.++[-&gt;+++++&lt;]&gt;+.[-----&gt;++++&lt;]&gt;+.+++++++++.---------.&gt;--[--&gt;+++&lt;]&gt;.\n</code></pre>\n<p>很显然这是 Brainfuck, 所以找个在线的 intepreter 运行一下就可以得到 flag：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127172039130.png\" alt=\"image-20250127172039130\"></p>\n<p mvm_brain_is_fucked_mvm>MVM</p>\n<h3 id=\"count-the-mvms\"><a class=\"anchor\" href=\"#count-the-mvms\">#</a> count-the-mvms</h3>\n<p>主要是数背景的 mvm 个数，发现它们的像素点是一样的。所以写个图像匹配脚本即可.</p>\n<p>首先要把 pdf 转换成 png，推荐 adobe acrobat</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> cvlib</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># cvlib 是自己写的库</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>im <span class=\"token operator\">=</span> cvlib<span class=\"token punctuation\">.</span>read_img<span class=\"token punctuation\">(</span><span class=\"token string\">\"certificate_h4tum.png\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>sim <span class=\"token operator\">=</span> cvlib<span class=\"token punctuation\">.</span>subrectimg<span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">,</span> <span class=\"token number\">605</span><span class=\"token punctuation\">,</span> <span class=\"token number\">516</span><span class=\"token punctuation\">,</span> <span class=\"token number\">837</span><span class=\"token punctuation\">,</span> <span class=\"token number\">665</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>sim2 <span class=\"token operator\">=</span> cvlib<span class=\"token punctuation\">.</span>subrectimg<span class=\"token punctuation\">(</span>sim<span class=\"token punctuation\">,</span> <span class=\"token number\">44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">79</span><span class=\"token punctuation\">,</span> <span class=\"token number\">48</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>mvm <span class=\"token operator\">=</span> cvlib<span class=\"token punctuation\">.</span>subrectimg<span class=\"token punctuation\">(</span>sim2<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"read success\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">match</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">if</span> x<span class=\"token operator\">+</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>mvm<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">if</span> y<span class=\"token operator\">+</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>mvm<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>mvm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>mvm<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token punctuation\">[</span>r<span class=\"token punctuation\">,</span>g<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> mvm<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token punctuation\">[</span>ri<span class=\"token punctuation\">,</span>gi<span class=\"token punctuation\">,</span>bi<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> im<span class=\"token punctuation\">[</span>x<span class=\"token operator\">+</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>y<span class=\"token operator\">+</span>j<span class=\"token punctuation\">]</span>        </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token keyword\">if</span> r <span class=\"token operator\">!=</span> ri <span class=\"token keyword\">or</span> g <span class=\"token operator\">!=</span> gi <span class=\"token keyword\">or</span> b <span class=\"token operator\">!=</span> bi<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            </pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">count_matches</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    cnt <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>        <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token keyword\">match</span><span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span>j<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                cnt <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                j <span class=\"token operator\">+=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>mvm<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">return</span> cnt</pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>count_matches<span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"finish\"</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"2-crypto\"><a class=\"anchor\" href=\"#2-crypto\">#</a> 2. Crypto</h2>\n<h3 id=\"man-vs-matrix\"><a class=\"anchor\" href=\"#man-vs-matrix\">#</a> man-vs-matrix:</h3>\n<p>题目描述：</p>\n<p><img src=\"https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250127172638257.png\" alt=\"image-20250127172638257\"></p>\n<p>打开下载文件会看到：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> sage<span class=\"token punctuation\">.</span><span class=\"token builtin\">all</span> <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> bytes_to_long</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">RNG</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> seed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        self<span class=\"token punctuation\">.</span>p <span class=\"token operator\">=</span> next_prime<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token operator\">**</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span>          <span class=\"token comment\"># 16777259</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        self<span class=\"token punctuation\">.</span>F <span class=\"token operator\">=</span> GF<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        self<span class=\"token punctuation\">.</span>M <span class=\"token operator\">=</span> matrix<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>F<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>bytes_to_long<span class=\"token punctuation\">(</span>seed<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">:</span>i<span class=\"token operator\">+</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>seed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        self<span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> vector<span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>F<span class=\"token punctuation\">,</span> <span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Mvm\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>        <span class=\"token comment\"># [77, 118, 109]</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        self<span class=\"token punctuation\">.</span>gen <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>F<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">get_random_num</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        out <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>M <span class=\"token operator\">*</span> self<span class=\"token punctuation\">.</span>state</pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>        <span class=\"token comment\"># len = 3</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            self<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>gen<span class=\"token operator\">**</span>self<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">return</span> out <span class=\"token operator\">*</span> self<span class=\"token punctuation\">.</span>state</pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>flag <span class=\"token operator\">=</span> <span class=\"token string\">b\"MVM&#123;???????????????????????????&#125;\"</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>seed <span class=\"token operator\">=</span> flag<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>               <span class=\"token comment\"># 27 位，27/3=9</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>rng <span class=\"token operator\">=</span> RNG<span class=\"token punctuation\">(</span>seed<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>samples <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    samples<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>rng<span class=\"token punctuation\">.</span>get_random_num<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span>samples <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\"># samples = [6192533, 82371, 86024, 4218430, 12259879, 16442850, 6736271, 7418630, 15483781]</span></pre></td></tr></table></figure><p>是几个随机数的生成器（RNG），但生成逻辑非常简单。</p>\n<p>每次会计算</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>M</mi><mo>⋅</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>n</mi><mi>e</mi><mi>w</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">(M \\cdot state) \\cdot new\\_state\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">M</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9251em;vertical-align:-0.31em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span></span></span></span></span></p>\n<p>(括号外的乘法是内积。在 sage 里，矩阵与矩阵 / 向量的乘法和向量与向量的内积都是用 *)。并且有</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>n</mi><mi>e</mi><mi>w</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mo>=</mo><msup><mn>2</mn><mrow><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo></mrow></msup><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">new\\_state[i] = 2^{state[i]}.\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.938em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mopen mtight\">[</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mclose mtight\">]</span></span></span></span></span></span></span></span></span><span class=\"mord\">.</span></span></span></span></span></p>\n<p>这里的初始 state 是已知的，所以我们只需要建立一个 9 元 1 次线性方程组即可。</p>\n<p>我们可以写一段 sagemath 的代码来通过解方程逆推出 matrix 以及 flag 内容：</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>p <span class=\"token operator\">=</span> <span class=\"token number\">16777259</span>\t\t<span class=\"token comment\"># = next_prime(2**24)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>F <span class=\"token operator\">=</span> GF<span class=\"token punctuation\">(</span>p<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>samples <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">6192533</span><span class=\"token punctuation\">,</span> <span class=\"token number\">82371</span><span class=\"token punctuation\">,</span> <span class=\"token number\">86024</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4218430</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12259879</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16442850</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6736271</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7418630</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15483781</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\"># 初始状态 S0 = [77, 118, 109]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>S0 <span class=\"token operator\">=</span> vector<span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">77</span><span class=\"token punctuation\">,</span> <span class=\"token number\">118</span><span class=\"token punctuation\">,</span> <span class=\"token number\">109</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">def</span> <span class=\"token function\">next_state</span><span class=\"token punctuation\">(</span>st<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">return</span> vector<span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>F<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token operator\">^</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> st<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\"># 求出 S0 ~ S9</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>S <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token boolean\">None</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span><span class=\"token number\">10</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>S<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> S0</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    S<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> next_state<span class=\"token punctuation\">(</span>S<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\"># 构造线性方程组 X * M_vec = Y</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>X <span class=\"token operator\">=</span> matrix<span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>Y <span class=\"token operator\">=</span> vector<span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    row_coeffs <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token comment\"># M_vec 的顺序: M [0,0], M [0,1], M [0,2], M [1,0], ..., M [2,2]</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">for</span> k <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            row_coeffs<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>S<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> S<span class=\"token punctuation\">[</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    X<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> row_coeffs</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    Y<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> samples<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\"># 求解 9 个未知量</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>M_vec <span class=\"token operator\">=</span> X<span class=\"token punctuation\">.</span>solve_right<span class=\"token punctuation\">(</span>Y<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>M_mat <span class=\"token operator\">=</span> matrix<span class=\"token punctuation\">(</span>F<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> M_vec<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Recovered M =\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>M_mat<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token comment\"># 将 3x3 矩阵以行优先顺序（row-major）展开成 9 个元素</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token comment\"># 对应当初 [bytes_to_long (seed [0:3]), bytes_to_long (seed [3:6]), ..., bytes_to_long (seed [24:27])]</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>m_ints <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token comment\"># Sage 返回的是 GF (p) 的元素，先转成普通整型</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        val <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>M_mat<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>        m_ints<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token comment\"># 将每个 val 转成 3 字节后依次拼接</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>seed_recovered <span class=\"token operator\">=</span> <span class=\"token string\">b\"\"</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">.</span>to_bytes<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"big\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> val <span class=\"token keyword\">in</span> m_ints<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token comment\"># 最终还原 flag = b\"MVM &#123;\" + seed_recovered + b\"&#125;\"</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>flag_recovered <span class=\"token operator\">=</span> <span class=\"token string\">b\"MVM&#123;\"</span> <span class=\"token operator\">+</span> seed_recovered <span class=\"token operator\">+</span> <span class=\"token string\">b\"&#125;\"</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Recovered seed  =\"</span><span class=\"token punctuation\">,</span> seed_recovered<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Recovered flag  =\"</span><span class=\"token punctuation\">,</span> flag_recovered<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token comment\">#最后得到的结果：</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token comment\"># Recovered M =</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token comment\"># [7090542 3355762 6252149]</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token comment\"># [5137236 3223662 3497780]</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token comment\"># [7484255 7174495 6698102]</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token comment\"># Recovered seed  = b'l1n34r_fuNcT10n5_4r3_my_f4v'</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token comment\"># Recovered flag  = b'MVM&#123;l1n34r_fuNcT10n5_4r3_my_f4v&#125;'</span></pre></td></tr></table></figure>"},{"title":"E-CTF比赛 Write Up.md","date":"2025-02-04T17:22:39.000Z","_content":"","source":"_posts/E-CTF比赛-Write-Up-md.md","raw":"---\ntitle: E-CTF比赛 Write Up.md\ndate: 2025-02-04 18:22:39\ntags:\n---\n","slug":"E-CTF比赛-Write-Up-md","published":1,"updated":"2025-02-04T17:22:39.160Z","comments":1,"layout":"post","photos":[],"_id":"cm6qr0i9l0002yokj6mgvgw8y","content":"","length":0,"excerpt":"","more":""},{"title":"Hello World","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","slug":"hello-world","published":1,"date":"2025-02-04T17:12:24.645Z","updated":"2025-02-04T17:12:24.645Z","comments":1,"layout":"post","photos":[],"_id":"cm6qr0i9m0003yokjhtifbgfp","content":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"quick-start\"><a class=\"anchor\" href=\"#quick-start\">#</a> Quick Start</h2>\n<h3 id=\"create-a-new-post\"><a class=\"anchor\" href=\"#create-a-new-post\">#</a> Create a new post</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo new <span class=\"token string\">\"My New Post\"</span></pre></td></tr></table></figure><p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"run-server\"><a class=\"anchor\" href=\"#run-server\">#</a> Run server</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo server</pre></td></tr></table></figure><p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"generate-static-files\"><a class=\"anchor\" href=\"#generate-static-files\">#</a> Generate static files</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo generate</pre></td></tr></table></figure><p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"deploy-to-remote-sites\"><a class=\"anchor\" href=\"#deploy-to-remote-sites\">#</a> Deploy to remote sites</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo deploy</pre></td></tr></table></figure><p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n","length":362,"excerpt":"","more":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"quick-start\"><a class=\"anchor\" href=\"#quick-start\">#</a> Quick Start</h2>\n<h3 id=\"create-a-new-post\"><a class=\"anchor\" href=\"#create-a-new-post\">#</a> Create a new post</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo new <span class=\"token string\">\"My New Post\"</span></pre></td></tr></table></figure><p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"run-server\"><a class=\"anchor\" href=\"#run-server\">#</a> Run server</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo server</pre></td></tr></table></figure><p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"generate-static-files\"><a class=\"anchor\" href=\"#generate-static-files\">#</a> Generate static files</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo generate</pre></td></tr></table></figure><p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"deploy-to-remote-sites\"><a class=\"anchor\" href=\"#deploy-to-remote-sites\">#</a> Deploy to remote sites</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"><span>h</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ hexo deploy</pre></td></tr></table></figure><p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n"},{"title":"哈希长度与碰撞情况","date":"2025-02-03T22:12:51.000Z","_content":"\n\n# 哈希长度与碰撞情况\n\n以下是各种常见长度的哈希函数及其碰撞情况分析：\n\n| 哈希长度 (bit) | 常见算法                 | 碰撞情况                    | 碰撞年份       | 发明年份         | 状态                      |\n| -------------- | ------------------------ | --------------------------- | -------------- | ---------------- | ------------------------- |\n| **128-bit**    | MD5                      | 存在已知有效碰撞攻击        | 2004 年        | 1992 年          | 已过时，不推荐使用        |\n| **160-bit**    | SHA-0, SHA-1, RIPEMD-160 | SHA-0: 存在已知有效碰撞攻击 | SHA-0: 2004 年 | SHA-0: 1993 年   | SHA-0: 已弃用，不推荐使用 |\n|                |                          | SHA-1: 存在已知有效碰撞攻击 | SHA-1: 2017 年 | SHA-1: 1995 年   | 已过时，不推荐使用        |\n| **256-bit**    | SHA-256, SHA-3-256       | 暂无已知有效碰撞攻击        | -              | SHA-256: 2001 年 | 安全，广泛使用            |\n| **384-bit**    | SHA-384                  | 暂无已知有效碰撞攻击        | -              | 2001 年          | 安全，高安全性需求        |\n| **512-bit**    | SHA-512, SHA-3-512       | 暂无已知有效碰撞攻击        | -              | SHA-512: 2001 年 | 非常安全，高性能需求      |\n\n## 碰撞情况说明\n\n- **128-bit (MD5)**:\n  - MD5 是一种输出为 128 位的哈希算法，但由于其设计的安全性不足，早在 2004 年就被发现可以有效制造碰撞。\n  - MD5 于 1992 年被发明，不适合任何需要密码学安全性的场景，仅可用于低安全性完整性校验。\n\n- **160-bit (SHA-0, SHA-1, RIPEMD-160)**:\n  - SHA-0 是 SHA 系列的初代版本，存在严重的设计缺陷，在 2004 年被证明可以制造碰撞。SHA-0 于 1993 年发明。\n  - SHA-1 作为输出 160 位的主流算法，在 2017 年被证实可以通过理论和实践攻击制造碰撞。SHA-1 于 1995 年发明。\n  - RIPEMD-160 虽尚未有公开的碰撞记录，但不如更高位算法安全。\n\n- **256-bit (SHA-256, SHA-3-256)**:\n  - 目前没有已知的碰撞攻击。\n  - SHA-256 于 2001 年被发明，适合绝大多数场景，如数字签名、区块链和数据完整性验证。\n\n- **384-bit (SHA-384)**:\n  - 为高安全需求设计，未有任何已知的碰撞攻击。\n  - SHA-384 于 2001 年发明，适用于密钥交换、长时间数据存储等高安全性应用。\n\n- **512-bit (SHA-512, SHA-3-512)**:\n  - 提供极高的安全性，特别适用于对抗潜在的量子计算威胁。\n  - SHA-512 于 2001 年发明，性能消耗较高，适合长期存储的场景。\n\n\n\n\n\n## MD5 哈希碰撞\n\n\n\nb\"TEXTCOLLBYfGiJUETHQ4hAcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak\" b\"TEXTCOLLBYfGiJUETHQ4hEcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak\" \n\nmd5计算结果均为：faad49866e9498fc1719f5289e7a0269\n","source":"_posts/哈希长度与碰撞情况.md","raw":"---\ntitle: 哈希长度与碰撞情况\ndate: 2025-02-03 23:12:51\ntags:\n  - CTF文章\n---\n\n\n# 哈希长度与碰撞情况\n\n以下是各种常见长度的哈希函数及其碰撞情况分析：\n\n| 哈希长度 (bit) | 常见算法                 | 碰撞情况                    | 碰撞年份       | 发明年份         | 状态                      |\n| -------------- | ------------------------ | --------------------------- | -------------- | ---------------- | ------------------------- |\n| **128-bit**    | MD5                      | 存在已知有效碰撞攻击        | 2004 年        | 1992 年          | 已过时，不推荐使用        |\n| **160-bit**    | SHA-0, SHA-1, RIPEMD-160 | SHA-0: 存在已知有效碰撞攻击 | SHA-0: 2004 年 | SHA-0: 1993 年   | SHA-0: 已弃用，不推荐使用 |\n|                |                          | SHA-1: 存在已知有效碰撞攻击 | SHA-1: 2017 年 | SHA-1: 1995 年   | 已过时，不推荐使用        |\n| **256-bit**    | SHA-256, SHA-3-256       | 暂无已知有效碰撞攻击        | -              | SHA-256: 2001 年 | 安全，广泛使用            |\n| **384-bit**    | SHA-384                  | 暂无已知有效碰撞攻击        | -              | 2001 年          | 安全，高安全性需求        |\n| **512-bit**    | SHA-512, SHA-3-512       | 暂无已知有效碰撞攻击        | -              | SHA-512: 2001 年 | 非常安全，高性能需求      |\n\n## 碰撞情况说明\n\n- **128-bit (MD5)**:\n  - MD5 是一种输出为 128 位的哈希算法，但由于其设计的安全性不足，早在 2004 年就被发现可以有效制造碰撞。\n  - MD5 于 1992 年被发明，不适合任何需要密码学安全性的场景，仅可用于低安全性完整性校验。\n\n- **160-bit (SHA-0, SHA-1, RIPEMD-160)**:\n  - SHA-0 是 SHA 系列的初代版本，存在严重的设计缺陷，在 2004 年被证明可以制造碰撞。SHA-0 于 1993 年发明。\n  - SHA-1 作为输出 160 位的主流算法，在 2017 年被证实可以通过理论和实践攻击制造碰撞。SHA-1 于 1995 年发明。\n  - RIPEMD-160 虽尚未有公开的碰撞记录，但不如更高位算法安全。\n\n- **256-bit (SHA-256, SHA-3-256)**:\n  - 目前没有已知的碰撞攻击。\n  - SHA-256 于 2001 年被发明，适合绝大多数场景，如数字签名、区块链和数据完整性验证。\n\n- **384-bit (SHA-384)**:\n  - 为高安全需求设计，未有任何已知的碰撞攻击。\n  - SHA-384 于 2001 年发明，适用于密钥交换、长时间数据存储等高安全性应用。\n\n- **512-bit (SHA-512, SHA-3-512)**:\n  - 提供极高的安全性，特别适用于对抗潜在的量子计算威胁。\n  - SHA-512 于 2001 年发明，性能消耗较高，适合长期存储的场景。\n\n\n\n\n\n## MD5 哈希碰撞\n\n\n\nb\"TEXTCOLLBYfGiJUETHQ4hAcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak\" b\"TEXTCOLLBYfGiJUETHQ4hEcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak\" \n\nmd5计算结果均为：faad49866e9498fc1719f5289e7a0269\n","slug":"哈希长度与碰撞情况","published":1,"updated":"2025-02-04T17:12:24.646Z","comments":1,"layout":"post","photos":[],"_id":"cm6qr0i9m0004yokjdhhhdjct","content":"<h1 id=\"哈希长度与碰撞情况\"><a class=\"anchor\" href=\"#哈希长度与碰撞情况\">#</a> 哈希长度与碰撞情况</h1>\n<p>以下是各种常见长度的哈希函数及其碰撞情况分析：</p>\n<table>\n<thead>\n<tr>\n<th>哈希长度 (bit)</th>\n<th>常见算法</th>\n<th>碰撞情况</th>\n<th>碰撞年份</th>\n<th>发明年份</th>\n<th>状态</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>128-bit</strong></td>\n<td>MD5</td>\n<td>存在已知有效碰撞攻击</td>\n<td>2004 年</td>\n<td>1992 年</td>\n<td>已过时，不推荐使用</td>\n</tr>\n<tr>\n<td><strong>160-bit</strong></td>\n<td>SHA-0, SHA-1, RIPEMD-160</td>\n<td>SHA-0: 存在已知有效碰撞攻击</td>\n<td>SHA-0: 2004 年</td>\n<td>SHA-0: 1993 年</td>\n<td>SHA-0: 已弃用，不推荐使用</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>SHA-1: 存在已知有效碰撞攻击</td>\n<td>SHA-1: 2017 年</td>\n<td>SHA-1: 1995 年</td>\n<td>已过时，不推荐使用</td>\n</tr>\n<tr>\n<td><strong>256-bit</strong></td>\n<td>SHA-256, SHA-3-256</td>\n<td>暂无已知有效碰撞攻击</td>\n<td>-</td>\n<td>SHA-256: 2001 年</td>\n<td>安全，广泛使用</td>\n</tr>\n<tr>\n<td><strong>384-bit</strong></td>\n<td>SHA-384</td>\n<td>暂无已知有效碰撞攻击</td>\n<td>-</td>\n<td>2001 年</td>\n<td>安全，高安全性需求</td>\n</tr>\n<tr>\n<td><strong>512-bit</strong></td>\n<td>SHA-512, SHA-3-512</td>\n<td>暂无已知有效碰撞攻击</td>\n<td>-</td>\n<td>SHA-512: 2001 年</td>\n<td>非常安全，高性能需求</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"碰撞情况说明\"><a class=\"anchor\" href=\"#碰撞情况说明\">#</a> 碰撞情况说明</h2>\n<ul>\n<li>\n<p><strong>128-bit (MD5)</strong>:</p>\n<ul>\n<li>MD5 是一种输出为 128 位的哈希算法，但由于其设计的安全性不足，早在 2004 年就被发现可以有效制造碰撞。</li>\n<li>MD5 于 1992 年被发明，不适合任何需要密码学安全性的场景，仅可用于低安全性完整性校验。</li>\n</ul>\n</li>\n<li>\n<p><strong>160-bit (SHA-0, SHA-1, RIPEMD-160)</strong>:</p>\n<ul>\n<li>SHA-0 是 SHA 系列的初代版本，存在严重的设计缺陷，在 2004 年被证明可以制造碰撞。SHA-0 于 1993 年发明。</li>\n<li>SHA-1 作为输出 160 位的主流算法，在 2017 年被证实可以通过理论和实践攻击制造碰撞。SHA-1 于 1995 年发明。</li>\n<li>RIPEMD-160 虽尚未有公开的碰撞记录，但不如更高位算法安全。</li>\n</ul>\n</li>\n<li>\n<p><strong>256-bit (SHA-256, SHA-3-256)</strong>:</p>\n<ul>\n<li>目前没有已知的碰撞攻击。</li>\n<li>SHA-256 于 2001 年被发明，适合绝大多数场景，如数字签名、区块链和数据完整性验证。</li>\n</ul>\n</li>\n<li>\n<p><strong>384-bit (SHA-384)</strong>:</p>\n<ul>\n<li>为高安全需求设计，未有任何已知的碰撞攻击。</li>\n<li>SHA-384 于 2001 年发明，适用于密钥交换、长时间数据存储等高安全性应用。</li>\n</ul>\n</li>\n<li>\n<p><strong>512-bit (SHA-512, SHA-3-512)</strong>:</p>\n<ul>\n<li>提供极高的安全性，特别适用于对抗潜在的量子计算威胁。</li>\n<li>SHA-512 于 2001 年发明，性能消耗较高，适合长期存储的场景。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"md5-哈希碰撞\"><a class=\"anchor\" href=\"#md5-哈希碰撞\">#</a> MD5 哈希碰撞</h2>\n<p>b&quot;TEXTCOLLBYfGiJUETHQ4hAcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak&quot; b&quot;TEXTCOLLBYfGiJUETHQ4hEcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak&quot;</p>\n<p>md5 计算结果均为：faad49866e9498fc1719f5289e7a0269</p>\n","length":1142,"excerpt":"","more":"<h1 id=\"哈希长度与碰撞情况\"><a class=\"anchor\" href=\"#哈希长度与碰撞情况\">#</a> 哈希长度与碰撞情况</h1>\n<p>以下是各种常见长度的哈希函数及其碰撞情况分析：</p>\n<table>\n<thead>\n<tr>\n<th>哈希长度 (bit)</th>\n<th>常见算法</th>\n<th>碰撞情况</th>\n<th>碰撞年份</th>\n<th>发明年份</th>\n<th>状态</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>128-bit</strong></td>\n<td>MD5</td>\n<td>存在已知有效碰撞攻击</td>\n<td>2004 年</td>\n<td>1992 年</td>\n<td>已过时，不推荐使用</td>\n</tr>\n<tr>\n<td><strong>160-bit</strong></td>\n<td>SHA-0, SHA-1, RIPEMD-160</td>\n<td>SHA-0: 存在已知有效碰撞攻击</td>\n<td>SHA-0: 2004 年</td>\n<td>SHA-0: 1993 年</td>\n<td>SHA-0: 已弃用，不推荐使用</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n<td>SHA-1: 存在已知有效碰撞攻击</td>\n<td>SHA-1: 2017 年</td>\n<td>SHA-1: 1995 年</td>\n<td>已过时，不推荐使用</td>\n</tr>\n<tr>\n<td><strong>256-bit</strong></td>\n<td>SHA-256, SHA-3-256</td>\n<td>暂无已知有效碰撞攻击</td>\n<td>-</td>\n<td>SHA-256: 2001 年</td>\n<td>安全，广泛使用</td>\n</tr>\n<tr>\n<td><strong>384-bit</strong></td>\n<td>SHA-384</td>\n<td>暂无已知有效碰撞攻击</td>\n<td>-</td>\n<td>2001 年</td>\n<td>安全，高安全性需求</td>\n</tr>\n<tr>\n<td><strong>512-bit</strong></td>\n<td>SHA-512, SHA-3-512</td>\n<td>暂无已知有效碰撞攻击</td>\n<td>-</td>\n<td>SHA-512: 2001 年</td>\n<td>非常安全，高性能需求</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"碰撞情况说明\"><a class=\"anchor\" href=\"#碰撞情况说明\">#</a> 碰撞情况说明</h2>\n<ul>\n<li>\n<p><strong>128-bit (MD5)</strong>:</p>\n<ul>\n<li>MD5 是一种输出为 128 位的哈希算法，但由于其设计的安全性不足，早在 2004 年就被发现可以有效制造碰撞。</li>\n<li>MD5 于 1992 年被发明，不适合任何需要密码学安全性的场景，仅可用于低安全性完整性校验。</li>\n</ul>\n</li>\n<li>\n<p><strong>160-bit (SHA-0, SHA-1, RIPEMD-160)</strong>:</p>\n<ul>\n<li>SHA-0 是 SHA 系列的初代版本，存在严重的设计缺陷，在 2004 年被证明可以制造碰撞。SHA-0 于 1993 年发明。</li>\n<li>SHA-1 作为输出 160 位的主流算法，在 2017 年被证实可以通过理论和实践攻击制造碰撞。SHA-1 于 1995 年发明。</li>\n<li>RIPEMD-160 虽尚未有公开的碰撞记录，但不如更高位算法安全。</li>\n</ul>\n</li>\n<li>\n<p><strong>256-bit (SHA-256, SHA-3-256)</strong>:</p>\n<ul>\n<li>目前没有已知的碰撞攻击。</li>\n<li>SHA-256 于 2001 年被发明，适合绝大多数场景，如数字签名、区块链和数据完整性验证。</li>\n</ul>\n</li>\n<li>\n<p><strong>384-bit (SHA-384)</strong>:</p>\n<ul>\n<li>为高安全需求设计，未有任何已知的碰撞攻击。</li>\n<li>SHA-384 于 2001 年发明，适用于密钥交换、长时间数据存储等高安全性应用。</li>\n</ul>\n</li>\n<li>\n<p><strong>512-bit (SHA-512, SHA-3-512)</strong>:</p>\n<ul>\n<li>提供极高的安全性，特别适用于对抗潜在的量子计算威胁。</li>\n<li>SHA-512 于 2001 年发明，性能消耗较高，适合长期存储的场景。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"md5-哈希碰撞\"><a class=\"anchor\" href=\"#md5-哈希碰撞\">#</a> MD5 哈希碰撞</h2>\n<p>b&quot;TEXTCOLLBYfGiJUETHQ4hAcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak&quot; b&quot;TEXTCOLLBYfGiJUETHQ4hEcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak&quot;</p>\n<p>md5 计算结果均为：faad49866e9498fc1719f5289e7a0269</p>\n"},{"title":"逆向工程","date":"2025-02-03T22:17:06.000Z","_content":"\n\n\n\n\n# IDA的使用\n\n根据程序的位数选择对应位数的 IDA 打开程序。（附件是 64 位的\n一般没有特殊需求，我们直接默认点击 OK 就好了\n\n![image-20240929110409063](逆向工程/image-20240929110409063.png)\n\n在 functions windows里面找到main\n\n然后在右边的窗口里按 F5 就可以跳出反汇编窗口\n\n> buuctf-easyre\n\n![image-20240929110715802](逆向工程/image-20240929110715802.png)\n\nhttps://blog.csdn.net/weixin_45723661/category_11348511.html\n\n### IDA 功能界面介绍\n\n![image-20240929112232598](逆向工程/image-20240929112232598.png)\n\n\\- 蓝色 : `.text section`\n\\- 深蓝 : 用户写的函数编译后的代码区\n\\- 浅蓝 : 编译器自己添加的函数，像启动函数，异常函数等等 ..\n\\- 粉红色 : `.idata section`\n有关输入表的一些数据信息\n\\- 军绿色： `.rdata section`\n纯数据，只读\n\\- 灰色 : 为了段对齐而留下的空隙\n\\- 黑色 : 禁区\n\n#### 汇编代码界面注释\n\n`shift + ;`\n\n伪代码注释\n\n`/`\n\n* G跳转\n* N改名\n\n#### imports\n\n程序从动态链接库中导入的要使用的函数\n\n#### exports\n\n程序导出给其它程序使用的函数\n\n### 字符串窗口\n\n`shift + F12`\n\n双击字符串找到位置\n\n在DATA XREF里面可以找到谁访问了这个地址\n\n> buuctf-reverse_1\n\n![image-20240929113449816](逆向工程/image-20240929113449816.png)\n\n在数字上按R可以转换成字符\n\n#### 这个是带换行的\n\n![image-20240930190521829](逆向工程/image-20240930190521829.png)\n\n* 按A转换成字符串\n* D 转换成数据\n* C 转换成汇编代码\n* U 转换成原始字节\n\n### export data\n\nshift + E 可以导出\n\n![image-20240930191508047](逆向工程/image-20240930191508047.png)\n\nTODO: \n\n总结 SimpleRev\n\n### 调整基地址\n\nEdit 里面 Segment 里面 Rebase Program, 然后输入基地址就可以和 x64dbg 地址对齐\n\n#### 跳转地址\n\n按 G 跳转\n\n\n\n## Linux 调试\n\n使用windows下面的ida pro 调试Linux下面的程序需要使用ida的远程调试功能。\n首先将ida文件夹中的dbgsrv/linux_serverx64文件放入需要调试程序的同级文件夹中。再使用chmod a+x linux_serverx64 改变该文件的权限。\n\n把要调试的文件也要+x运行权限\n\n然后连接\n\n再application和inputfile里填入要调试的**绝对路径** ，host里面填ip地址，密码不用填，然后就可以了\n\n> buuctf-level3\n\n下断点进调试看 base64数组被改变的值\n\n\n\n### RSA\n\n> buuctf - signin\n\n``` cpp\n  __gmpz_init_set_str(v7, \"ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35\", 16LL);\n  __gmpz_init_set_str(v6, v9, 16LL);\n  __gmpz_init_set_str(v4, \"103461035900816914121390101299049044413950405173712170434161686539878160984549\", 10LL);\n  __gmpz_init_set_str(v5, \"65537\", 10LL);\n```\n\n看到这些整数可能是RSA `E=65537, N = 1034....` \n\n`__gmpz_init_set_str`这是一个 GNU 高精度算法库\n\n这三个参数分别是多精度整数变量，字符串，进制 \n\n`__gmpz_powm(v6, v6, v5, v4) `这个的意思其实就是 计算v6的v5次方并对v4取模，结果写入v6。\n\n10346103590081691412139010129904904441395040517371217043416168653\n\nhttp://www.factordb.com/index.php 这个可以查质数分解\n\n\n\n整数到bytes\n\n``` python\nprint(unhexlify(hex(M)[2:]))\n# si = int.from_bytes(s) # byte to int\n# rsa.transform.int2bytes(c) # alternative\n```\n\n题解\n\n``` python\nimport math\nfrom Crypto.Util.number import inverse\nfrom binascii import unhexlify\n\ne = 65537\nn = 103461035900816914121390101299049044413950405173712170434161686539878160984549\np = 282164587459512124844245113950593348271\nq = 366669102002966856876605669837014229419\nc = 0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35\n\nd = inverse(e, math.lcm(p-1,q-1))\n\nM = pow(c, d, n)\nprint(rsa.transform.int2bytes(M))\t\n# 或者\ndecrypted = rsa.PrivateKey(n,e,d,p,q).blinded_decrypt(c)\nprint(rsa.transform.int2bytes(decrypted))\n```\n\n从 key 文件里面读取\n\n``` python\nfrom Crypto.PublicKey import RSA\n\nf = open(\"pub.key\", \"rb\")\npkdata = f.read()\npk = RSA.import_key(pkdata)\n\nn = pk.n\ne = pk.e\nprint(n)\nprint(e)\n```\n\n\n\n## 壳\n\n用 exeinfope 可以看有没有壳， 或者用file指令\n\n### UPX\n\n> buuctf-新年快乐\n\n可以看出来是UPX的壳\n\n![image-20240929125830292](逆向工程/image-20240929125830292.png)\n\nfile指令会有\n\n![image-20240929130135608](逆向工程/image-20240929130135608.png)\n\n解壳\n\n``` shell\nupx -d xx.exe\n```\n\n\n\n\n\n\n\n# 安卓/JAVA\n\njdk安装https://www.oracle.com/java/technologies/downloads/#jdk22-windows\n\n### jadx\n\n安装https://github.com/skylot/jadx/releases/tag/v1.5.0\n\n可以打开文件, 把 APK 传进去，在左边可以看到源代码\n\n打开windows gui的那个\n\n\n\n\n\n# IOS逆向\n\nhttps://www.i4.cn/\n\n装爱思助手\n\n越狱，要制作启动盘\n\nhttps://www.bilibili.com/video/BV1or421G7vo/?spm_id_from=333.788.videopod.sections&vd_source=2c1227d0a7d29725db75d3fc52e6089b\n\n\n\n### Frida\n\n``` shell\npip install frida-tools\n```\n\n\n\n\n\n### Ghigra\n\n\n\n#### x64dbg\n\ngitbub 上有\n\n# Unity\n\n> BUUCTF [BJDCTF2020]BJD hamburger competition \n\n第一次接触 Unity的逆向题\n这种关键代码一般都在 `assembly-csharp.dll` 里面，加载到dnspy里面，左边点开可以看到源代码\n\n\n\n\n\n# Python\n\n``` shell\npip install uncompyle6\n```\n\n用这个命令\n\n用online 的比较好https://www.lddgo.net/en/string/pyc-compile-decompile\n\n# GO\n\nhttps://github.com/sibears/IDAGolangHelper\n\n可以装这个插件\n\n\n\n# 代码分析\n\n> buuctf lucky guy\n\n``` cpp\n((((unsigned int)((unsigned __int64)j >> 32) >> 31) + (_BYTE)j) & 1\n  - ((unsigned int)((unsigned __int64)j >> 32) >> 31) == 1\n```\n\n等价于\n\n`j % 2 == 1`\n\n### 复用代码解密\n\n> buuctf 刮开有奖\n\n这里面的函数IDA会判断错误，需要改正, 类型改了代码也要记得改\n\n#### 答案在其他函数里\n\n> buuctf [2019红帽杯]easyRE\n\n往main的下面找找\n\n## 花指令\n\n有时候IDA反编译不了，这个时候要改指令，通常是jnz指令\n\n> buuctf Maze\n\n![img](逆向工程/31f160e7596c17139883c26175af9d24.webp)\n\n如何nop:\n\n1. `Edit/Patch program/Change byte`将要修改的byte改成90，修改完后`Edit/Patch program/Apply patches to input file`保存修改后的文件，\n2. 或者`Edit/Patch program/Assemble`直接输入`nop`，然后同样要保存\n\n![在这里插入图片描述](逆向工程/a3a1c2a23cadd179ee2a5d6c81e3adb2.webp)\n\n#### 把报错的函数编译一下\n\n> [MRCTF2020]Xor\n\n把报错的函数点进去反编译一下，然后再回来编译就可以了\n\n### 数据类型判断\n\n``` cpp\n__int64 v6[6];\nfor ( i = 0; i <= 5; ++i )\n  {\n    printf(\"%s\", \"input: \");\n    a2 = (char **)((char *)v6 + 4 * i);\n    __isoc99_scanf(\"%d\", a2);\n  }\n```\n\n这个v6应该是 4byte, 因为 `(char *)v6 + 4 * i)` 是4字节\n\n\n\n## 加密算法\n\n### TEA加密\n\n``` cpp\nv3 = *a1;\nv4 = a1[1];\nv5 = 0;\nfor ( i = 0; i <= 0x3F; ++i )\n{\n    v5 += 1166789954;\n    v3 += (v4 + v5 + 11) ^ ((v4 << 6) + *a2) ^ ((v4 >> 9) + a2[1]) ^ 0x20;\n    v4 += (v3 + v5 + 20) ^ ((v3 << 6) + a2[2]) ^ ((v3 >> 9) + a2[3]) ^ 0x10;\n}\n*a1 = v3;\nresult = v4;\na1[1] = v4;\nreturn result;\n```\n\n解密\n\n``` cpp\nunsigned int a[6] = {0xDF48EF7E,550153460, 3774025685, 1548802262, 2652626477,0x84F30420};\nunsigned int table[4] = {2,2,3,4};\nunsigned int decoded[6];\nfor (int j = 0;j < 6; j += 2) {\n    int v5 = 0x458BCD42 * 64;\n    unsigned int v3 = a[j], v4 = a[j+1];\n    for (int i = 0;i <= 63; ++i) {\n        v4 -= (v3 + v5 + 20) ^ ((v3 << 6) + table[2]) ^ ((v3 >> 9) + table[3]) ^ 0x10;\n        v3 -= (v4 + v5 + 11) ^ ((v4 << 6) + table[0]) ^ ((v4 >> 9) + table[1]) ^ 0x20;\n        v5 -= 0x458BCD42;\n    }\n    decoded[j] = v3;\n    decoded[j+1] = v4;\n}\n```\n\n要把v3，v4的类型写对，否则计算结果不对\n\n\n\n### 解方程z3\n\n``` shell\npip install z3-solver\n```\n\n> buuctf [ACTF新生赛2020]Universe_final_answer\n\n\n\n### MD5\n\n``` python\nfrom Crypto.Hash.MD5 import MD5Hash\nfrom binascii import hexlify\ntoken = \"1001\"\nprint(hexlify(MD5Hash(token.encode()).digest())[:20].upper())\n```\n\n\n\n\n\n## init 函数修改\n\nhttps://www.cnblogs.com/NozoMizo/articles/17737745.html\n\n\n\n\n\n# Windows API\n\n### FindResourceA\n\n> buuctf CrackRTF\n\n``` c\nhResInfo = FindResourceA(0, (LPCSTR)0x65, \"AAA\");\nif (!hResInfo)\n    return 0;\n```\n\n`FindResourceA` 函数用于查找一个指定的资源。\n\n- 第一个参数是模块句柄，这里为 `0`，表示当前模块。\n- 第二个参数 `(LPCSTR)0x65` 是资源的标识符（ID），这里使用的是资源ID `0x65`。\n- 第三个参数 `\"AAA\"` 是资源的类型名称。\n\n如果 `FindResourceA` 返回 `NULL`，则表示资源没有找到，函数立即返回 `0`。\n\n**用 Resource Hacker 可以提取 exe 的资源**\n\n`SizeofResource` 获取指定资源的大小，结果赋值给 `nNumberOfBytesToWrite`，表示将要写入的字节数\n\n### LoadResource\n\n`LoadResource` 函数将资源加载到内存中，返回资源的句柄 `hResData`。\n\n如果加载失败，返回 `NULL`，函数返回 `0`。\n\n#### LockResource\n\n``` c\nlpBuffer = LockResource(hResData);\n```\n\n`LockResource` 锁定资源并返回一个指向资源数据的指针 `lpBuffer`。通过这个指针可以访问资源内容\n\n### CreateFile\n\n``` c\nhFile = CreateFileA(\"dbapp.rtf\", 0x10000000u, 0, 0, 2u, 0x80u, 0);\nif (hFile == (HANDLE)-1)\n    return 0;\n```\n\n`CreateFileA` 用于创建或打开文件，这里试图创建一个名为 `\"dbapp.rtf\"` 的文件。\n\n- `0x10000000u`：`GENERIC_WRITE`，表示文件以写入模式打开。\n- `0` 和 `0`：表示不使用文件共享和默认安全属性。\n- `2u`：`CREATE_ALWAYS`，表示总是创建文件，即使文件已经存在也会覆盖。\n- `0x80u`：`FILE_ATTRIBUTE_NORMAL`，表示文件的普通属性。\n\n如果文件创建失败，返回 `(HANDLE)-1`，函数返回 `0`。\n\n### WriteFile\n\n``` cpp\nif (!WriteFile(hFile, lpBuffer, nNumberOfBytesToWrite, &NumberOfBytesWritten, 0))\n    return 0;\n```\n\n`WriteFile` 将 `lpBuffer` 中的数据写入到文件 `hFile`，写入的字节数为 `nNumberOfBytesToWrite`。\n\n`&NumberOfBytesWritten` 用于接收实际写入的字节数。\n\n如果 `WriteFile` 失败，函数返回 `0`。\n\n## 多线程\n\n> buuctf Youngter-drive\n>\n> `counter = 29` \n>\n> 最终加密 `TOiZiZtOrYaToUwPnToBsOaOapsyS` \n>\n> 线程1：若counter>-1每次调用对counter位置加密, 并且每次-1\n>\n> 线程2：若counter>-1 每次 -1\n>\n> 所以加密基数或者偶数部分\n>\n> \n\nCreateMutexW:作用是找出当前系统是否已经存在指定进程的实例.\n\nCreateThread:CreateThread是一种微软在Windows API中提供了建立新的线程的函数，该[函数](https://baike.baidu.com/item/函数/301912?fromModule=lemma_inlink)在[主线程](https://baike.baidu.com/item/主线程/9600138?fromModule=lemma_inlink)的基础上创建一个新线程。[线程](https://baike.baidu.com/item/线程/103101?fromModule=lemma_inlink)终止运行后，线程对象仍然在系统中，必须通过CloseHandle函数来关闭该线程对象。\n\nCloseHandle:关闭一个内核对象。其中包括文件、文件映射、进程、线程、安全和同步对象等。在CreateThread成功之后会返回一个hThread的handle，且内核对象的计数加1，CloseHandle之后，引用计数减1，当变为0时，系统删除内核对象。\n\nWaitForSingleObject:WaitForSingleObject函数用来检测hHandle事件的信号状态，在某一线程中调用该函数时，线程暂时挂起，如果在挂起的dwMilliseconds毫秒内，线程所等待的对象变为有信号状态，则该函数立即返回；如果时间已经到达dwMilliseconds毫秒，但hHandle所指向的对象还没有变成有信号状态，函数照样返回。\n\n在这里就相当于，第一个线程调用该函数，然后这里的WaitForSingleObject函数用来检测之前线程的信号状态，暂时挂起\n\n多线程例子：\n\n``` cpp\n#include <iostream>\n#include <windows.h>\n\nHANDLE hMutex;\n\nint arr[100];\nint last = 0;\n\nDWORD WINAPI thread01(LPVOID lvParameter) {\n\tfor (int i = 0; i < 100; ++i) {\n\t\tWaitForSingleObject(hMutex, INFINITE);\n\t\tif (last == 100) break;\n\t\tarr[last] = 1;\n\t\tlast++;\n\t\tstd::cout << \"thread 1 work on \" << last - 1 << std::endl;\n\t\tReleaseMutex(hMutex);\n\t}\n\treturn 0;\n}\n\nDWORD WINAPI thread02(LPVOID lvParameter) {\n\tfor (int i = 0; i < 100; ++i) {\n\t\tWaitForSingleObject(hMutex, INFINITE);\n\t\tif (last == 100) break;\n\t\tarr[last] = 1;\n\t\tlast++;\n\t\tstd::cout << \"thread 2 work on \" << last - 1 << std::endl;\n\t\tReleaseMutex(hMutex);\n\t}\n\treturn 0;\n}\n\nint main()\n{\n\thMutex = CreateMutexA(NULL, FALSE, (LPCSTR)\"Test\");\n\tif (hMutex == NULL) {\n\t\tstd::cout << \"ERROR\" << std::endl;\n\t\treturn 1;\n\t}\n\n\tHANDLE hTread1 = CreateThread(NULL, 0, thread01, NULL, 0, NULL);\n\tif (hTread1 == NULL) {\n\t\tstd::cout << \"ERROR\" << std::endl;\n\t\treturn 1;\n\t}\n\t\n\tHANDLE hTread2 = CreateThread(NULL, 0, thread02, NULL, 0, NULL);\n\tif (hTread2 == NULL) {\n\t\tstd::cout << \"ERROR\" << std::endl;\n\t\treturn 1;\n\t}\n\n\tWaitForSingleObject(hTread1, INFINITE);\n\tWaitForSingleObject(hTread2, INFINITE);\n\n\t\n\tCloseHandle(hTread1);\n\tCloseHandle(hTread2);\n\t\n\tCloseHandle(hMutex);\n\treturn 0;\n}\n```\n\n这题里面\n\n\n\n\n\n\n\n\n\n# 游戏逆向\n\n### 任务管理器找进程\n\n打开任务管理器\n\n<img src=\"逆向工程/image-20240811072446821.png\" alt=\"image-20240811072446821\" style=\"zoom:50%;\" />\n\n然后右键，转到详细信息就有了\n\n\n\n## CE\n\n资源网址:https://wpfx.org/\n\n[CE](D:\\Software\\Cheat_Engine_7.5\\Cheat Engine 7.5)\n\n[ollydbg](‪E:\\Tools\\OD\\OllyICE\\OD.exe)\n\n搜字符串的时候把代码页勾上，可以搜出更多\n\n#### 找血量\n\n可以换装备，被怪打\n\n#### 搜byte\n\n可以勾选快速扫描，4字节对齐，这样可以加快速度\n\n\n\n#### 天龙八部\n\nTODO: p37\n\n记得启动器里面选32位\n\n`axery123@changyou.com`\n\n`123axery`\n\n`岳朋 男 211481198401154411`\n\n##### 人物状态\n\nrcx + 234\n\n1A34D9946D0 + 234\n\nrcx = rax+80\n\nrax=1A30B1C01D0\n\nGame.exe+593935 \n\n## 汇编指令\n\n#### lea\n\n```\nlea eax, dword ptr [ebp-8]\n```\n\n把右边的地址复制给左边\n\n#### pushad, popad\n\n把8个寄存器全部push到栈上面\n\n#### rep movs\n\n循环 ecx 次，每次把 esi 地址的内容复制给 edi 地址的内容，然后esi,edi 增加4\n\n### 栈\n\n#### ebp \n\n栈顶\n\n* $ebp$ 是保持上次的ebp值 $push \\ ebp, mov \\ ebp, esp$\n\n* $[ebp+4]$ 是回去的地址\n\n* $[ebp+8]$ 是传入的第一个参数\n\n## OllyDBG\n\n[ollydbg](E:\\Tools\\OD\\OllyICE\\OD.exe)\n\n汉化包\n\nhttps://github.com/lennylxx/ollydbg-zh/releases\n\n复制到根目录之后，可以在file里面选择gui language为中文\n\n### 快捷键\n\n* 回车: 进入 call\n* F9: 运行\n* F8: 步过 把call运行完\n* F7: 步入： 运行到call的开头\n* `-` 后退\n* `+` 前进\n* F2：断点\n* F4：运行到当前指向的命令\n* Ctrl+F9: 执行到返回\n* Ctrl+G: 查看地址,APT代码 \n\n### x64dbg\n\n* 再选项里吗可以设置关闭断点\n\n* 带参数调试 ： 文件，改变命令行\n* 高亮寄存器：快捷键H，再选项中打开\n\n### 命令\n\n* API断点: `bp MessageBoxA`\n* dd输出地址的值  `dd eax`\n\n### 查找字符串\n\n![image-20240929115846957](逆向工程/image-20240929115846957.png)\n\n\n\n### 附加进程\n\n文件 ,  附加j进程，选择想要的进程\n\n点击三角形让程序运行，\n\n如果卡住了可以按 $T$ , 然后右键 Resume all threads\n\n#### OD界面\n\n$E$ 是模块，选择游戏模块\n\n$C$ 是初始界面\n\n查找注释：\n\n先在E窗口找到主程序，然后右键查找用户定义的注释\n\n#### 跳转\n\nCtrl+G打开调整，输入内存地址或者 `ws2_32.send`\n\nx64dbg是 `game + 2ECE21` 可以加入基地址\n\n可以跳到这个模块的send函数\n\n### OD断点\n\n右键可以下断点\n\n#### 内存断点\n\n内存访问的时候断\n\n#### 硬件断点\n\n只能4个\n\n可以在内存地址右键，硬件断点，硬件写入，Byte\n\n来查找谁写入了这个位置\n\n#### F2断点\n\n可以下任意多个\n\n#### api断点\n\n`bp ws2_32.send`\n\n#### 条件断点\n\nshift + F2\n\n`[76ad5000]==06aa72a0`\n\n\n\n\n\n\n\n### 发包\n\n#### 发包函数\n\n* send\n* sendto\n* WSASend\n* WSPSend: 在 `ws2_32.WEP` 下面有个 `call esi` 这个是\n\n一般是 `ws2_32.send` 在这个模块里，如果不是的话，需要指定模块名字\n\n\n\n\n\n## 易语言\n\nhttps://www.dywt.com.cn/ 产品下载 5.93\n\n下载易语言安装补丁 (`CTF/逆向`)\n\n把 `e.exe` 替换过去, linker 里面的内容也拖过来替换\n\n然后打开替换来的 `link.e` 用易语言打开，然后运行一下就好了 \n\n#### 使用\n\n* ctrl + L: 添加变量\n\n#### 编译\n\n编译，静态编译，\n\n静态的会打包所有需要的dll\n\n#### 常用设置\n\n程序，程序配置对话框：可以配置图标，描述\n\n工具\n\n* 支持库配置里全勾上\n\n* 系统设置，\n  * 通常：可以取消编译时检查死循环\n  * 存根，可以设置请求管理员权限\n\n#### 自定义数据类型\n\n就是c的struct\n\n#### 基本函数\n\n到文本: 转换成字符串\n\n#### if\n\n``` e\n如果 (时间 % 2)\n```\n\n没有else的\n\n``` e\n如果真 ()\n```\n\n判断 是switch\n\n#### for\n\nj 从 1 到 100\n\n``` e\n计次循环首(100, j)\ns = s+j\n计次循环尾()\n```\n\n#### while\n\n``` e\n\na ＝ 1\n判断循环首 (a ＜ 10)\n    a ＝ a ＋ 1\n判断循环尾 ()\n标签1.标题 ＝ 到文本 (a)\n\n```\n\n#### Dll命令\n\n比如 Messagebox\n\n### 组件\n\n#### 时钟\n\n时钟周期\n\n### Visual Studio\n\nhttps://visualstudio.microsoft.com/de/ 下载就行了\n\n然后只勾选c++和windows,扩展开发,在C++桌面开发里面额外勾选MFC\n\n文件，账户选项，搜索字体，可以调整字体大小\n\n#### 反汇编\n\n打个断点运行后，右键选择 `转到反汇编`\n\n右键可以选择是否显示变量名\n\n##### 内存\n\n在调试，窗口，内存里面找\n\n内存里面可以 `&a` 来找到变量 $a$ 的地址内容\n\n#### MFC DLL\n\n选择静态链接\n\n![image-20240811135822371](逆向工程/image-20240811135822371.png)\n\n视图，其他窗口，资源视图，把他选出来\n\n然后右键添加资源，选择Dialog\n\n![image-20240811140259142](逆向工程/image-20240811140259142.png)\n\n确定和取消按钮可以自己删掉\n\n#### 32位程序\n\n可以选择在debug 旁边 选择 x86来写win32程序\n\n#### 项目，TL1属性\n\n可以选择windows sdk版本\n\n使用的字符集\n\n#### 工具箱\n\n视图，工具箱，里面有组件\n\n视图，属性窗口也要选\n\n#### 创建类\n\n右键dialog的空白处，添加类作为创建的这个dialog的类名，可以取名`XXDialog`\n\n在DLL的主cpp文件中\n\n``` cpp\n\nTLDialog* dialog;\n\nDWORD WINAPI ShowDialog(LPARAM lpData) {\n\tdialog = new TLDialog; // 分配空间\n\tdialog->DoModal(); // 阻塞的方式 模态窗口\n\tdelete dialog; // 释放空间\n\tFreeLibraryAndExitThread(theApp.m_hInstance, 1); // 释放DLL 退出线程\n\treturn TRUE;\n}\n\n// CMFCLibrary1App 初始化\n\nBOOL CMFCLibrary1App::InitInstance()\n{\n\tCWinApp::InitInstance();\n\t::CreateThread(NULL, NULL, (LPTHREAD_START_ROUTINE)ShowDialog, NULL, NULL, NULL); // 创建线程\n\treturn TRUE;\n}\n```\n\n![image-20240811144327614](逆向工程/image-20240811144327614.png)\n\n右键重新生成来编译\n\n在CE中查找好基地址和便宜\n\n> 练习：查找新天龙八部怀旧的人物状态\n\n``` cpp\ntry\n{\n    DWORD base_addr = (DWORD)GetModuleHandleA(\"Game.exe\") + 0x5946DC;\n    DWORD offset1 = *(DWORD*)base_addr + 0x0c;\n    DWORD offset2 = *(DWORD*)offset1 + 0x14c;\n    DWORD addr = *(DWORD*)offset2;\n    outputdebug(\"人物信息：人物状态: %d\", addr);\n}\ncatch (const std::exception&)\n{\n    outputdebug(\"Error!\");\n    return;\n}\n```\n\n然后是输出在debug信息的代码\n\n``` cpp\nvoid outputdebug(char* pszFormat, ...) {\n\n#ifdef DEBUG\n\n\tchar szbufFormat[0x1000];\n\tchar szbufFormatGame[0x1100] = \"\";\n\tva_list argList;\n\tva_start(argList, pszFormat);\n\tvsprintf_s(szbufFormat, pszFormat, argList);\n\tstrcat_s(szbufFormatGame, szbufFormat);\n\tOutputDebugStringA(szbufFormatGame);\n\tva_end(argList);\n\n#endif\n\n}\n```\n\n这个dubug信息可以在 DebugView来看\n\n用管理员权限打开DebugView, 然后打开监视核心，可以选择过滤字符串。\n\n#### 汇编代码注入\n\ncall 函数的时候要记得先放在寄存器里\n\nDetach之后再注入\n\n``` asm\npushad\nmov ecx, 0x3F080A28\nmov eax, 0x6a5e60\ncall eax\npopad\n```\n\necx:\n\n``` asm\n[[[Game.exe+5946FC]+ 60]+ 154]\n```\n\n## 天龙八部怀旧\n\n\n\n#### 背包数组\n\ncnt:\n\n``` asm\n[[i*4+[[Game.exe+594724]+181c4]]+0x14]+0x58\n```\n\nbase\n\n``` asm\n[[Game.exe+594724]+181c4]\n```\n\n名字\n\n[[base+i*4]+2c]+18]\n\n* `+2c,+1c` 说明\n* `+2c,+20` 使用等级\n* `+2c,+40` 耐久\n\n#### NPC 遍历\n\n![c45b801d423975f7a189ebf3b9e8db1](逆向工程/c45b801d423975f7a189ebf3b9e8db1.png)\n\n这是一个链表\n\n``` cpp\nesi = [[[edi+1c]+4]+4];\nwhile (esi != [edi+1c]) {\n    call([[[esi+8]]+14])\n    esi = [esi+4];\n}\n```\n\n#### 血量遍历\n\n先用CE搜索浮点数找到血量百分比\n\n``` asm\n[[[[[[[[[0x117CCB8]+0x54]+0x4]]]+0x14]+0x148]+0x10]+0x8]=target\n```\n","source":"_posts/逆向工程.md","raw":"---\ntitle: 逆向工程\ndate: 2025-02-03 23:17:06\ntags:\n  - CTF文章\n---\n\n\n\n\n\n# IDA的使用\n\n根据程序的位数选择对应位数的 IDA 打开程序。（附件是 64 位的\n一般没有特殊需求，我们直接默认点击 OK 就好了\n\n![image-20240929110409063](逆向工程/image-20240929110409063.png)\n\n在 functions windows里面找到main\n\n然后在右边的窗口里按 F5 就可以跳出反汇编窗口\n\n> buuctf-easyre\n\n![image-20240929110715802](逆向工程/image-20240929110715802.png)\n\nhttps://blog.csdn.net/weixin_45723661/category_11348511.html\n\n### IDA 功能界面介绍\n\n![image-20240929112232598](逆向工程/image-20240929112232598.png)\n\n\\- 蓝色 : `.text section`\n\\- 深蓝 : 用户写的函数编译后的代码区\n\\- 浅蓝 : 编译器自己添加的函数，像启动函数，异常函数等等 ..\n\\- 粉红色 : `.idata section`\n有关输入表的一些数据信息\n\\- 军绿色： `.rdata section`\n纯数据，只读\n\\- 灰色 : 为了段对齐而留下的空隙\n\\- 黑色 : 禁区\n\n#### 汇编代码界面注释\n\n`shift + ;`\n\n伪代码注释\n\n`/`\n\n* G跳转\n* N改名\n\n#### imports\n\n程序从动态链接库中导入的要使用的函数\n\n#### exports\n\n程序导出给其它程序使用的函数\n\n### 字符串窗口\n\n`shift + F12`\n\n双击字符串找到位置\n\n在DATA XREF里面可以找到谁访问了这个地址\n\n> buuctf-reverse_1\n\n![image-20240929113449816](逆向工程/image-20240929113449816.png)\n\n在数字上按R可以转换成字符\n\n#### 这个是带换行的\n\n![image-20240930190521829](逆向工程/image-20240930190521829.png)\n\n* 按A转换成字符串\n* D 转换成数据\n* C 转换成汇编代码\n* U 转换成原始字节\n\n### export data\n\nshift + E 可以导出\n\n![image-20240930191508047](逆向工程/image-20240930191508047.png)\n\nTODO: \n\n总结 SimpleRev\n\n### 调整基地址\n\nEdit 里面 Segment 里面 Rebase Program, 然后输入基地址就可以和 x64dbg 地址对齐\n\n#### 跳转地址\n\n按 G 跳转\n\n\n\n## Linux 调试\n\n使用windows下面的ida pro 调试Linux下面的程序需要使用ida的远程调试功能。\n首先将ida文件夹中的dbgsrv/linux_serverx64文件放入需要调试程序的同级文件夹中。再使用chmod a+x linux_serverx64 改变该文件的权限。\n\n把要调试的文件也要+x运行权限\n\n然后连接\n\n再application和inputfile里填入要调试的**绝对路径** ，host里面填ip地址，密码不用填，然后就可以了\n\n> buuctf-level3\n\n下断点进调试看 base64数组被改变的值\n\n\n\n### RSA\n\n> buuctf - signin\n\n``` cpp\n  __gmpz_init_set_str(v7, \"ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35\", 16LL);\n  __gmpz_init_set_str(v6, v9, 16LL);\n  __gmpz_init_set_str(v4, \"103461035900816914121390101299049044413950405173712170434161686539878160984549\", 10LL);\n  __gmpz_init_set_str(v5, \"65537\", 10LL);\n```\n\n看到这些整数可能是RSA `E=65537, N = 1034....` \n\n`__gmpz_init_set_str`这是一个 GNU 高精度算法库\n\n这三个参数分别是多精度整数变量，字符串，进制 \n\n`__gmpz_powm(v6, v6, v5, v4) `这个的意思其实就是 计算v6的v5次方并对v4取模，结果写入v6。\n\n10346103590081691412139010129904904441395040517371217043416168653\n\nhttp://www.factordb.com/index.php 这个可以查质数分解\n\n\n\n整数到bytes\n\n``` python\nprint(unhexlify(hex(M)[2:]))\n# si = int.from_bytes(s) # byte to int\n# rsa.transform.int2bytes(c) # alternative\n```\n\n题解\n\n``` python\nimport math\nfrom Crypto.Util.number import inverse\nfrom binascii import unhexlify\n\ne = 65537\nn = 103461035900816914121390101299049044413950405173712170434161686539878160984549\np = 282164587459512124844245113950593348271\nq = 366669102002966856876605669837014229419\nc = 0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35\n\nd = inverse(e, math.lcm(p-1,q-1))\n\nM = pow(c, d, n)\nprint(rsa.transform.int2bytes(M))\t\n# 或者\ndecrypted = rsa.PrivateKey(n,e,d,p,q).blinded_decrypt(c)\nprint(rsa.transform.int2bytes(decrypted))\n```\n\n从 key 文件里面读取\n\n``` python\nfrom Crypto.PublicKey import RSA\n\nf = open(\"pub.key\", \"rb\")\npkdata = f.read()\npk = RSA.import_key(pkdata)\n\nn = pk.n\ne = pk.e\nprint(n)\nprint(e)\n```\n\n\n\n## 壳\n\n用 exeinfope 可以看有没有壳， 或者用file指令\n\n### UPX\n\n> buuctf-新年快乐\n\n可以看出来是UPX的壳\n\n![image-20240929125830292](逆向工程/image-20240929125830292.png)\n\nfile指令会有\n\n![image-20240929130135608](逆向工程/image-20240929130135608.png)\n\n解壳\n\n``` shell\nupx -d xx.exe\n```\n\n\n\n\n\n\n\n# 安卓/JAVA\n\njdk安装https://www.oracle.com/java/technologies/downloads/#jdk22-windows\n\n### jadx\n\n安装https://github.com/skylot/jadx/releases/tag/v1.5.0\n\n可以打开文件, 把 APK 传进去，在左边可以看到源代码\n\n打开windows gui的那个\n\n\n\n\n\n# IOS逆向\n\nhttps://www.i4.cn/\n\n装爱思助手\n\n越狱，要制作启动盘\n\nhttps://www.bilibili.com/video/BV1or421G7vo/?spm_id_from=333.788.videopod.sections&vd_source=2c1227d0a7d29725db75d3fc52e6089b\n\n\n\n### Frida\n\n``` shell\npip install frida-tools\n```\n\n\n\n\n\n### Ghigra\n\n\n\n#### x64dbg\n\ngitbub 上有\n\n# Unity\n\n> BUUCTF [BJDCTF2020]BJD hamburger competition \n\n第一次接触 Unity的逆向题\n这种关键代码一般都在 `assembly-csharp.dll` 里面，加载到dnspy里面，左边点开可以看到源代码\n\n\n\n\n\n# Python\n\n``` shell\npip install uncompyle6\n```\n\n用这个命令\n\n用online 的比较好https://www.lddgo.net/en/string/pyc-compile-decompile\n\n# GO\n\nhttps://github.com/sibears/IDAGolangHelper\n\n可以装这个插件\n\n\n\n# 代码分析\n\n> buuctf lucky guy\n\n``` cpp\n((((unsigned int)((unsigned __int64)j >> 32) >> 31) + (_BYTE)j) & 1\n  - ((unsigned int)((unsigned __int64)j >> 32) >> 31) == 1\n```\n\n等价于\n\n`j % 2 == 1`\n\n### 复用代码解密\n\n> buuctf 刮开有奖\n\n这里面的函数IDA会判断错误，需要改正, 类型改了代码也要记得改\n\n#### 答案在其他函数里\n\n> buuctf [2019红帽杯]easyRE\n\n往main的下面找找\n\n## 花指令\n\n有时候IDA反编译不了，这个时候要改指令，通常是jnz指令\n\n> buuctf Maze\n\n![img](逆向工程/31f160e7596c17139883c26175af9d24.webp)\n\n如何nop:\n\n1. `Edit/Patch program/Change byte`将要修改的byte改成90，修改完后`Edit/Patch program/Apply patches to input file`保存修改后的文件，\n2. 或者`Edit/Patch program/Assemble`直接输入`nop`，然后同样要保存\n\n![在这里插入图片描述](逆向工程/a3a1c2a23cadd179ee2a5d6c81e3adb2.webp)\n\n#### 把报错的函数编译一下\n\n> [MRCTF2020]Xor\n\n把报错的函数点进去反编译一下，然后再回来编译就可以了\n\n### 数据类型判断\n\n``` cpp\n__int64 v6[6];\nfor ( i = 0; i <= 5; ++i )\n  {\n    printf(\"%s\", \"input: \");\n    a2 = (char **)((char *)v6 + 4 * i);\n    __isoc99_scanf(\"%d\", a2);\n  }\n```\n\n这个v6应该是 4byte, 因为 `(char *)v6 + 4 * i)` 是4字节\n\n\n\n## 加密算法\n\n### TEA加密\n\n``` cpp\nv3 = *a1;\nv4 = a1[1];\nv5 = 0;\nfor ( i = 0; i <= 0x3F; ++i )\n{\n    v5 += 1166789954;\n    v3 += (v4 + v5 + 11) ^ ((v4 << 6) + *a2) ^ ((v4 >> 9) + a2[1]) ^ 0x20;\n    v4 += (v3 + v5 + 20) ^ ((v3 << 6) + a2[2]) ^ ((v3 >> 9) + a2[3]) ^ 0x10;\n}\n*a1 = v3;\nresult = v4;\na1[1] = v4;\nreturn result;\n```\n\n解密\n\n``` cpp\nunsigned int a[6] = {0xDF48EF7E,550153460, 3774025685, 1548802262, 2652626477,0x84F30420};\nunsigned int table[4] = {2,2,3,4};\nunsigned int decoded[6];\nfor (int j = 0;j < 6; j += 2) {\n    int v5 = 0x458BCD42 * 64;\n    unsigned int v3 = a[j], v4 = a[j+1];\n    for (int i = 0;i <= 63; ++i) {\n        v4 -= (v3 + v5 + 20) ^ ((v3 << 6) + table[2]) ^ ((v3 >> 9) + table[3]) ^ 0x10;\n        v3 -= (v4 + v5 + 11) ^ ((v4 << 6) + table[0]) ^ ((v4 >> 9) + table[1]) ^ 0x20;\n        v5 -= 0x458BCD42;\n    }\n    decoded[j] = v3;\n    decoded[j+1] = v4;\n}\n```\n\n要把v3，v4的类型写对，否则计算结果不对\n\n\n\n### 解方程z3\n\n``` shell\npip install z3-solver\n```\n\n> buuctf [ACTF新生赛2020]Universe_final_answer\n\n\n\n### MD5\n\n``` python\nfrom Crypto.Hash.MD5 import MD5Hash\nfrom binascii import hexlify\ntoken = \"1001\"\nprint(hexlify(MD5Hash(token.encode()).digest())[:20].upper())\n```\n\n\n\n\n\n## init 函数修改\n\nhttps://www.cnblogs.com/NozoMizo/articles/17737745.html\n\n\n\n\n\n# Windows API\n\n### FindResourceA\n\n> buuctf CrackRTF\n\n``` c\nhResInfo = FindResourceA(0, (LPCSTR)0x65, \"AAA\");\nif (!hResInfo)\n    return 0;\n```\n\n`FindResourceA` 函数用于查找一个指定的资源。\n\n- 第一个参数是模块句柄，这里为 `0`，表示当前模块。\n- 第二个参数 `(LPCSTR)0x65` 是资源的标识符（ID），这里使用的是资源ID `0x65`。\n- 第三个参数 `\"AAA\"` 是资源的类型名称。\n\n如果 `FindResourceA` 返回 `NULL`，则表示资源没有找到，函数立即返回 `0`。\n\n**用 Resource Hacker 可以提取 exe 的资源**\n\n`SizeofResource` 获取指定资源的大小，结果赋值给 `nNumberOfBytesToWrite`，表示将要写入的字节数\n\n### LoadResource\n\n`LoadResource` 函数将资源加载到内存中，返回资源的句柄 `hResData`。\n\n如果加载失败，返回 `NULL`，函数返回 `0`。\n\n#### LockResource\n\n``` c\nlpBuffer = LockResource(hResData);\n```\n\n`LockResource` 锁定资源并返回一个指向资源数据的指针 `lpBuffer`。通过这个指针可以访问资源内容\n\n### CreateFile\n\n``` c\nhFile = CreateFileA(\"dbapp.rtf\", 0x10000000u, 0, 0, 2u, 0x80u, 0);\nif (hFile == (HANDLE)-1)\n    return 0;\n```\n\n`CreateFileA` 用于创建或打开文件，这里试图创建一个名为 `\"dbapp.rtf\"` 的文件。\n\n- `0x10000000u`：`GENERIC_WRITE`，表示文件以写入模式打开。\n- `0` 和 `0`：表示不使用文件共享和默认安全属性。\n- `2u`：`CREATE_ALWAYS`，表示总是创建文件，即使文件已经存在也会覆盖。\n- `0x80u`：`FILE_ATTRIBUTE_NORMAL`，表示文件的普通属性。\n\n如果文件创建失败，返回 `(HANDLE)-1`，函数返回 `0`。\n\n### WriteFile\n\n``` cpp\nif (!WriteFile(hFile, lpBuffer, nNumberOfBytesToWrite, &NumberOfBytesWritten, 0))\n    return 0;\n```\n\n`WriteFile` 将 `lpBuffer` 中的数据写入到文件 `hFile`，写入的字节数为 `nNumberOfBytesToWrite`。\n\n`&NumberOfBytesWritten` 用于接收实际写入的字节数。\n\n如果 `WriteFile` 失败，函数返回 `0`。\n\n## 多线程\n\n> buuctf Youngter-drive\n>\n> `counter = 29` \n>\n> 最终加密 `TOiZiZtOrYaToUwPnToBsOaOapsyS` \n>\n> 线程1：若counter>-1每次调用对counter位置加密, 并且每次-1\n>\n> 线程2：若counter>-1 每次 -1\n>\n> 所以加密基数或者偶数部分\n>\n> \n\nCreateMutexW:作用是找出当前系统是否已经存在指定进程的实例.\n\nCreateThread:CreateThread是一种微软在Windows API中提供了建立新的线程的函数，该[函数](https://baike.baidu.com/item/函数/301912?fromModule=lemma_inlink)在[主线程](https://baike.baidu.com/item/主线程/9600138?fromModule=lemma_inlink)的基础上创建一个新线程。[线程](https://baike.baidu.com/item/线程/103101?fromModule=lemma_inlink)终止运行后，线程对象仍然在系统中，必须通过CloseHandle函数来关闭该线程对象。\n\nCloseHandle:关闭一个内核对象。其中包括文件、文件映射、进程、线程、安全和同步对象等。在CreateThread成功之后会返回一个hThread的handle，且内核对象的计数加1，CloseHandle之后，引用计数减1，当变为0时，系统删除内核对象。\n\nWaitForSingleObject:WaitForSingleObject函数用来检测hHandle事件的信号状态，在某一线程中调用该函数时，线程暂时挂起，如果在挂起的dwMilliseconds毫秒内，线程所等待的对象变为有信号状态，则该函数立即返回；如果时间已经到达dwMilliseconds毫秒，但hHandle所指向的对象还没有变成有信号状态，函数照样返回。\n\n在这里就相当于，第一个线程调用该函数，然后这里的WaitForSingleObject函数用来检测之前线程的信号状态，暂时挂起\n\n多线程例子：\n\n``` cpp\n#include <iostream>\n#include <windows.h>\n\nHANDLE hMutex;\n\nint arr[100];\nint last = 0;\n\nDWORD WINAPI thread01(LPVOID lvParameter) {\n\tfor (int i = 0; i < 100; ++i) {\n\t\tWaitForSingleObject(hMutex, INFINITE);\n\t\tif (last == 100) break;\n\t\tarr[last] = 1;\n\t\tlast++;\n\t\tstd::cout << \"thread 1 work on \" << last - 1 << std::endl;\n\t\tReleaseMutex(hMutex);\n\t}\n\treturn 0;\n}\n\nDWORD WINAPI thread02(LPVOID lvParameter) {\n\tfor (int i = 0; i < 100; ++i) {\n\t\tWaitForSingleObject(hMutex, INFINITE);\n\t\tif (last == 100) break;\n\t\tarr[last] = 1;\n\t\tlast++;\n\t\tstd::cout << \"thread 2 work on \" << last - 1 << std::endl;\n\t\tReleaseMutex(hMutex);\n\t}\n\treturn 0;\n}\n\nint main()\n{\n\thMutex = CreateMutexA(NULL, FALSE, (LPCSTR)\"Test\");\n\tif (hMutex == NULL) {\n\t\tstd::cout << \"ERROR\" << std::endl;\n\t\treturn 1;\n\t}\n\n\tHANDLE hTread1 = CreateThread(NULL, 0, thread01, NULL, 0, NULL);\n\tif (hTread1 == NULL) {\n\t\tstd::cout << \"ERROR\" << std::endl;\n\t\treturn 1;\n\t}\n\t\n\tHANDLE hTread2 = CreateThread(NULL, 0, thread02, NULL, 0, NULL);\n\tif (hTread2 == NULL) {\n\t\tstd::cout << \"ERROR\" << std::endl;\n\t\treturn 1;\n\t}\n\n\tWaitForSingleObject(hTread1, INFINITE);\n\tWaitForSingleObject(hTread2, INFINITE);\n\n\t\n\tCloseHandle(hTread1);\n\tCloseHandle(hTread2);\n\t\n\tCloseHandle(hMutex);\n\treturn 0;\n}\n```\n\n这题里面\n\n\n\n\n\n\n\n\n\n# 游戏逆向\n\n### 任务管理器找进程\n\n打开任务管理器\n\n<img src=\"逆向工程/image-20240811072446821.png\" alt=\"image-20240811072446821\" style=\"zoom:50%;\" />\n\n然后右键，转到详细信息就有了\n\n\n\n## CE\n\n资源网址:https://wpfx.org/\n\n[CE](D:\\Software\\Cheat_Engine_7.5\\Cheat Engine 7.5)\n\n[ollydbg](‪E:\\Tools\\OD\\OllyICE\\OD.exe)\n\n搜字符串的时候把代码页勾上，可以搜出更多\n\n#### 找血量\n\n可以换装备，被怪打\n\n#### 搜byte\n\n可以勾选快速扫描，4字节对齐，这样可以加快速度\n\n\n\n#### 天龙八部\n\nTODO: p37\n\n记得启动器里面选32位\n\n`axery123@changyou.com`\n\n`123axery`\n\n`岳朋 男 211481198401154411`\n\n##### 人物状态\n\nrcx + 234\n\n1A34D9946D0 + 234\n\nrcx = rax+80\n\nrax=1A30B1C01D0\n\nGame.exe+593935 \n\n## 汇编指令\n\n#### lea\n\n```\nlea eax, dword ptr [ebp-8]\n```\n\n把右边的地址复制给左边\n\n#### pushad, popad\n\n把8个寄存器全部push到栈上面\n\n#### rep movs\n\n循环 ecx 次，每次把 esi 地址的内容复制给 edi 地址的内容，然后esi,edi 增加4\n\n### 栈\n\n#### ebp \n\n栈顶\n\n* $ebp$ 是保持上次的ebp值 $push \\ ebp, mov \\ ebp, esp$\n\n* $[ebp+4]$ 是回去的地址\n\n* $[ebp+8]$ 是传入的第一个参数\n\n## OllyDBG\n\n[ollydbg](E:\\Tools\\OD\\OllyICE\\OD.exe)\n\n汉化包\n\nhttps://github.com/lennylxx/ollydbg-zh/releases\n\n复制到根目录之后，可以在file里面选择gui language为中文\n\n### 快捷键\n\n* 回车: 进入 call\n* F9: 运行\n* F8: 步过 把call运行完\n* F7: 步入： 运行到call的开头\n* `-` 后退\n* `+` 前进\n* F2：断点\n* F4：运行到当前指向的命令\n* Ctrl+F9: 执行到返回\n* Ctrl+G: 查看地址,APT代码 \n\n### x64dbg\n\n* 再选项里吗可以设置关闭断点\n\n* 带参数调试 ： 文件，改变命令行\n* 高亮寄存器：快捷键H，再选项中打开\n\n### 命令\n\n* API断点: `bp MessageBoxA`\n* dd输出地址的值  `dd eax`\n\n### 查找字符串\n\n![image-20240929115846957](逆向工程/image-20240929115846957.png)\n\n\n\n### 附加进程\n\n文件 ,  附加j进程，选择想要的进程\n\n点击三角形让程序运行，\n\n如果卡住了可以按 $T$ , 然后右键 Resume all threads\n\n#### OD界面\n\n$E$ 是模块，选择游戏模块\n\n$C$ 是初始界面\n\n查找注释：\n\n先在E窗口找到主程序，然后右键查找用户定义的注释\n\n#### 跳转\n\nCtrl+G打开调整，输入内存地址或者 `ws2_32.send`\n\nx64dbg是 `game + 2ECE21` 可以加入基地址\n\n可以跳到这个模块的send函数\n\n### OD断点\n\n右键可以下断点\n\n#### 内存断点\n\n内存访问的时候断\n\n#### 硬件断点\n\n只能4个\n\n可以在内存地址右键，硬件断点，硬件写入，Byte\n\n来查找谁写入了这个位置\n\n#### F2断点\n\n可以下任意多个\n\n#### api断点\n\n`bp ws2_32.send`\n\n#### 条件断点\n\nshift + F2\n\n`[76ad5000]==06aa72a0`\n\n\n\n\n\n\n\n### 发包\n\n#### 发包函数\n\n* send\n* sendto\n* WSASend\n* WSPSend: 在 `ws2_32.WEP` 下面有个 `call esi` 这个是\n\n一般是 `ws2_32.send` 在这个模块里，如果不是的话，需要指定模块名字\n\n\n\n\n\n## 易语言\n\nhttps://www.dywt.com.cn/ 产品下载 5.93\n\n下载易语言安装补丁 (`CTF/逆向`)\n\n把 `e.exe` 替换过去, linker 里面的内容也拖过来替换\n\n然后打开替换来的 `link.e` 用易语言打开，然后运行一下就好了 \n\n#### 使用\n\n* ctrl + L: 添加变量\n\n#### 编译\n\n编译，静态编译，\n\n静态的会打包所有需要的dll\n\n#### 常用设置\n\n程序，程序配置对话框：可以配置图标，描述\n\n工具\n\n* 支持库配置里全勾上\n\n* 系统设置，\n  * 通常：可以取消编译时检查死循环\n  * 存根，可以设置请求管理员权限\n\n#### 自定义数据类型\n\n就是c的struct\n\n#### 基本函数\n\n到文本: 转换成字符串\n\n#### if\n\n``` e\n如果 (时间 % 2)\n```\n\n没有else的\n\n``` e\n如果真 ()\n```\n\n判断 是switch\n\n#### for\n\nj 从 1 到 100\n\n``` e\n计次循环首(100, j)\ns = s+j\n计次循环尾()\n```\n\n#### while\n\n``` e\n\na ＝ 1\n判断循环首 (a ＜ 10)\n    a ＝ a ＋ 1\n判断循环尾 ()\n标签1.标题 ＝ 到文本 (a)\n\n```\n\n#### Dll命令\n\n比如 Messagebox\n\n### 组件\n\n#### 时钟\n\n时钟周期\n\n### Visual Studio\n\nhttps://visualstudio.microsoft.com/de/ 下载就行了\n\n然后只勾选c++和windows,扩展开发,在C++桌面开发里面额外勾选MFC\n\n文件，账户选项，搜索字体，可以调整字体大小\n\n#### 反汇编\n\n打个断点运行后，右键选择 `转到反汇编`\n\n右键可以选择是否显示变量名\n\n##### 内存\n\n在调试，窗口，内存里面找\n\n内存里面可以 `&a` 来找到变量 $a$ 的地址内容\n\n#### MFC DLL\n\n选择静态链接\n\n![image-20240811135822371](逆向工程/image-20240811135822371.png)\n\n视图，其他窗口，资源视图，把他选出来\n\n然后右键添加资源，选择Dialog\n\n![image-20240811140259142](逆向工程/image-20240811140259142.png)\n\n确定和取消按钮可以自己删掉\n\n#### 32位程序\n\n可以选择在debug 旁边 选择 x86来写win32程序\n\n#### 项目，TL1属性\n\n可以选择windows sdk版本\n\n使用的字符集\n\n#### 工具箱\n\n视图，工具箱，里面有组件\n\n视图，属性窗口也要选\n\n#### 创建类\n\n右键dialog的空白处，添加类作为创建的这个dialog的类名，可以取名`XXDialog`\n\n在DLL的主cpp文件中\n\n``` cpp\n\nTLDialog* dialog;\n\nDWORD WINAPI ShowDialog(LPARAM lpData) {\n\tdialog = new TLDialog; // 分配空间\n\tdialog->DoModal(); // 阻塞的方式 模态窗口\n\tdelete dialog; // 释放空间\n\tFreeLibraryAndExitThread(theApp.m_hInstance, 1); // 释放DLL 退出线程\n\treturn TRUE;\n}\n\n// CMFCLibrary1App 初始化\n\nBOOL CMFCLibrary1App::InitInstance()\n{\n\tCWinApp::InitInstance();\n\t::CreateThread(NULL, NULL, (LPTHREAD_START_ROUTINE)ShowDialog, NULL, NULL, NULL); // 创建线程\n\treturn TRUE;\n}\n```\n\n![image-20240811144327614](逆向工程/image-20240811144327614.png)\n\n右键重新生成来编译\n\n在CE中查找好基地址和便宜\n\n> 练习：查找新天龙八部怀旧的人物状态\n\n``` cpp\ntry\n{\n    DWORD base_addr = (DWORD)GetModuleHandleA(\"Game.exe\") + 0x5946DC;\n    DWORD offset1 = *(DWORD*)base_addr + 0x0c;\n    DWORD offset2 = *(DWORD*)offset1 + 0x14c;\n    DWORD addr = *(DWORD*)offset2;\n    outputdebug(\"人物信息：人物状态: %d\", addr);\n}\ncatch (const std::exception&)\n{\n    outputdebug(\"Error!\");\n    return;\n}\n```\n\n然后是输出在debug信息的代码\n\n``` cpp\nvoid outputdebug(char* pszFormat, ...) {\n\n#ifdef DEBUG\n\n\tchar szbufFormat[0x1000];\n\tchar szbufFormatGame[0x1100] = \"\";\n\tva_list argList;\n\tva_start(argList, pszFormat);\n\tvsprintf_s(szbufFormat, pszFormat, argList);\n\tstrcat_s(szbufFormatGame, szbufFormat);\n\tOutputDebugStringA(szbufFormatGame);\n\tva_end(argList);\n\n#endif\n\n}\n```\n\n这个dubug信息可以在 DebugView来看\n\n用管理员权限打开DebugView, 然后打开监视核心，可以选择过滤字符串。\n\n#### 汇编代码注入\n\ncall 函数的时候要记得先放在寄存器里\n\nDetach之后再注入\n\n``` asm\npushad\nmov ecx, 0x3F080A28\nmov eax, 0x6a5e60\ncall eax\npopad\n```\n\necx:\n\n``` asm\n[[[Game.exe+5946FC]+ 60]+ 154]\n```\n\n## 天龙八部怀旧\n\n\n\n#### 背包数组\n\ncnt:\n\n``` asm\n[[i*4+[[Game.exe+594724]+181c4]]+0x14]+0x58\n```\n\nbase\n\n``` asm\n[[Game.exe+594724]+181c4]\n```\n\n名字\n\n[[base+i*4]+2c]+18]\n\n* `+2c,+1c` 说明\n* `+2c,+20` 使用等级\n* `+2c,+40` 耐久\n\n#### NPC 遍历\n\n![c45b801d423975f7a189ebf3b9e8db1](逆向工程/c45b801d423975f7a189ebf3b9e8db1.png)\n\n这是一个链表\n\n``` cpp\nesi = [[[edi+1c]+4]+4];\nwhile (esi != [edi+1c]) {\n    call([[[esi+8]]+14])\n    esi = [esi+4];\n}\n```\n\n#### 血量遍历\n\n先用CE搜索浮点数找到血量百分比\n\n``` asm\n[[[[[[[[[0x117CCB8]+0x54]+0x4]]]+0x14]+0x148]+0x10]+0x8]=target\n```\n","slug":"逆向工程","published":1,"updated":"2025-02-04T17:12:24.646Z","comments":1,"layout":"post","photos":[],"_id":"cm6qr0i9n0005yokj2ijnasg0","content":"<h1 id=\"ida的使用\"><a class=\"anchor\" href=\"#ida的使用\">#</a> IDA 的使用</h1>\n<p>根据程序的位数选择对应位数的 IDA 打开程序。（附件是 64 位的<br>\n一般没有特殊需求，我们直接默认点击 OK 就好了</p>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240929110409063.png\" alt=\"image-20240929110409063\"></p>\n<p>在 functions windows 里面找到 main</p>\n<p>然后在右边的窗口里按 F5 就可以跳出反汇编窗口</p>\n<blockquote>\n<p>buuctf-easyre</p>\n</blockquote>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240929110715802.png\" alt=\"image-20240929110715802\"></p>\n<p><a href=\"https://blog.csdn.net/weixin_45723661/category_11348511.html\">https://blog.csdn.net/weixin_45723661/category_11348511.html</a></p>\n<h3 id=\"ida-功能界面介绍\"><a class=\"anchor\" href=\"#ida-功能界面介绍\">#</a> IDA 功能界面介绍</h3>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240929112232598.png\" alt=\"image-20240929112232598\"></p>\n<p>- 蓝色 :  <code>.text section</code> <br>\n- 深蓝：用户写的函数编译后的代码区<br>\n - 浅蓝：编译器自己添加的函数，像启动函数，异常函数等等 ..<br>\n- 粉红色 :  <code>.idata section</code> <br>\n 有关输入表的一些数据信息<br>\n - 军绿色：  <code>.rdata section</code> <br>\n 纯数据，只读<br>\n - 灰色：为了段对齐而留下的空隙<br>\n - 黑色：禁区</p>\n<h4 id=\"汇编代码界面注释\"><a class=\"anchor\" href=\"#汇编代码界面注释\">#</a> 汇编代码界面注释</h4>\n<p><code>shift + ;</code></p>\n<p>伪代码注释</p>\n<p><code>/</code></p>\n<ul>\n<li>G 跳转</li>\n<li>N 改名</li>\n</ul>\n<h4 id=\"imports\"><a class=\"anchor\" href=\"#imports\">#</a> imports</h4>\n<p>程序从动态链接库中导入的要使用的函数</p>\n<h4 id=\"exports\"><a class=\"anchor\" href=\"#exports\">#</a> exports</h4>\n<p>程序导出给其它程序使用的函数</p>\n<h3 id=\"字符串窗口\"><a class=\"anchor\" href=\"#字符串窗口\">#</a> 字符串窗口</h3>\n<p><code>shift + F12</code></p>\n<p>双击字符串找到位置</p>\n<p>在 DATA XREF 里面可以找到谁访问了这个地址</p>\n<blockquote>\n<p>buuctf-reverse_1</p>\n</blockquote>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240929113449816.png\" alt=\"image-20240929113449816\"></p>\n<p>在数字上按 R 可以转换成字符</p>\n<h4 id=\"这个是带换行的\"><a class=\"anchor\" href=\"#这个是带换行的\">#</a> 这个是带换行的</h4>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240930190521829.png\" alt=\"image-20240930190521829\"></p>\n<ul>\n<li>按 A 转换成字符串</li>\n<li>D 转换成数据</li>\n<li>C 转换成汇编代码</li>\n<li>U 转换成原始字节</li>\n</ul>\n<h3 id=\"export-data\"><a class=\"anchor\" href=\"#export-data\">#</a> export data</h3>\n<p>shift + E 可以导出</p>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240930191508047.png\" alt=\"image-20240930191508047\"></p>\n<p>TODO:</p>\n<p>总结 SimpleRev</p>\n<h3 id=\"调整基地址\"><a class=\"anchor\" href=\"#调整基地址\">#</a> 调整基地址</h3>\n<p>Edit 里面 Segment 里面 Rebase Program, 然后输入基地址就可以和 x64dbg 地址对齐</p>\n<h4 id=\"跳转地址\"><a class=\"anchor\" href=\"#跳转地址\">#</a> 跳转地址</h4>\n<p>按 G 跳转</p>\n<h2 id=\"linux-调试\"><a class=\"anchor\" href=\"#linux-调试\">#</a> Linux 调试</h2>\n<p>使用 windows 下面的 ida pro 调试 Linux 下面的程序需要使用 ida 的远程调试功能。<br>\n首先将 ida 文件夹中的 dbgsrv/linux_serverx64 文件放入需要调试程序的同级文件夹中。再使用 chmod a+x linux_serverx64 改变该文件的权限。</p>\n<p>把要调试的文件也要 + x 运行权限</p>\n<p>然后连接</p>\n<p>再 application 和 inputfile 里填入要调试的<strong>绝对路径</strong> ，host 里面填 ip 地址，密码不用填，然后就可以了</p>\n<blockquote>\n<p>buuctf-level3</p>\n</blockquote>\n<p>下断点进调试看 base64 数组被改变的值</p>\n<h3 id=\"rsa\"><a class=\"anchor\" href=\"#rsa\">#</a> RSA</h3>\n<blockquote>\n<p>buuctf - signin</p>\n</blockquote>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">__gmpz_init_set_str</span><span class=\"token punctuation\">(</span>v7<span class=\"token punctuation\">,</span> <span class=\"token string\">\"ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16LL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token function\">__gmpz_init_set_str</span><span class=\"token punctuation\">(</span>v6<span class=\"token punctuation\">,</span> v9<span class=\"token punctuation\">,</span> <span class=\"token number\">16LL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token function\">__gmpz_init_set_str</span><span class=\"token punctuation\">(</span>v4<span class=\"token punctuation\">,</span> <span class=\"token string\">\"103461035900816914121390101299049044413950405173712170434161686539878160984549\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10LL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token function\">__gmpz_init_set_str</span><span class=\"token punctuation\">(</span>v5<span class=\"token punctuation\">,</span> <span class=\"token string\">\"65537\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10LL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>看到这些整数可能是 RSA  <code>E=65537, N = 1034....</code></p>\n<p><code>__gmpz_init_set_str</code>  这是一个 GNU 高精度算法库</p>\n<p>这三个参数分别是多精度整数变量，字符串，进制</p>\n<p><code>__gmpz_powm(v6, v6, v5, v4) </code> 这个的意思其实就是 计算 v6 的 v5 次方并对 v4 取模，结果写入 v6。</p>\n<p>10346103590081691412139010129904904441395040517371217043416168653</p>\n<p><a href=\"http://www.factordb.com/index.php\">http://www.factordb.com/index.php</a> 这个可以查质数分解</p>\n<p>整数到 bytes</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>unhexlify<span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>M<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># si = int.from_bytes(s) # byte to int</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># rsa.transform.int2bytes(c) # alternative</span></pre></td></tr></table></figure><p>题解</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> math</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> inverse</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> binascii <span class=\"token keyword\">import</span> unhexlify</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>e <span class=\"token operator\">=</span> <span class=\"token number\">65537</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>n <span class=\"token operator\">=</span> <span class=\"token number\">103461035900816914121390101299049044413950405173712170434161686539878160984549</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>p <span class=\"token operator\">=</span> <span class=\"token number\">282164587459512124844245113950593348271</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>q <span class=\"token operator\">=</span> <span class=\"token number\">366669102002966856876605669837014229419</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token number\">0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>d <span class=\"token operator\">=</span> inverse<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>lcm<span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>M <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>rsa<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">.</span>int2bytes<span class=\"token punctuation\">(</span>M<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\t</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># 或者</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>decrypted <span class=\"token operator\">=</span> rsa<span class=\"token punctuation\">.</span>PrivateKey<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">,</span>d<span class=\"token punctuation\">,</span>p<span class=\"token punctuation\">,</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>blinded_decrypt<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>rsa<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">.</span>int2bytes<span class=\"token punctuation\">(</span>decrypted<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>从 key 文件里面读取</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>PublicKey <span class=\"token keyword\">import</span> RSA</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>f <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pub.key\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rb\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>pkdata <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>pk <span class=\"token operator\">=</span> RSA<span class=\"token punctuation\">.</span>import_key<span class=\"token punctuation\">(</span>pkdata<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>n <span class=\"token operator\">=</span> pk<span class=\"token punctuation\">.</span>n</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>e <span class=\"token operator\">=</span> pk<span class=\"token punctuation\">.</span>e</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"壳\"><a class=\"anchor\" href=\"#壳\">#</a> 壳</h2>\n<p>用 exeinfope 可以看有没有壳， 或者用 file 指令</p>\n<h3 id=\"upx\"><a class=\"anchor\" href=\"#upx\">#</a> UPX</h3>\n<blockquote>\n<p>buuctf - 新年快乐</p>\n</blockquote>\n<p>可以看出来是 UPX 的壳</p>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240929125830292.png\" alt=\"image-20240929125830292\"></p>\n<p>file 指令会有</p>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240929130135608.png\" alt=\"image-20240929130135608\"></p>\n<p>解壳</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>upx <span class=\"token parameter variable\">-d</span> xx.exe</pre></td></tr></table></figure><h1 id=\"安卓java\"><a class=\"anchor\" href=\"#安卓java\">#</a> 安卓 / JAVA</h1>\n<p>jdk 安装<a href=\"https://www.oracle.com/java/technologies/downloads/#jdk22-windows\"> https://www.oracle.com/java/technologies/downloads/#jdk22-windows</a></p>\n<h3 id=\"jadx\"><a class=\"anchor\" href=\"#jadx\">#</a> jadx</h3>\n<p>安装<a href=\"https://github.com/skylot/jadx/releases/tag/v1.5.0\"> https://github.com/skylot/jadx/releases/tag/v1.5.0</a></p>\n<p>可以打开文件，把 APK 传进去，在左边可以看到源代码</p>\n<p>打开 windows gui 的那个</p>\n<h1 id=\"ios逆向\"><a class=\"anchor\" href=\"#ios逆向\">#</a> IOS 逆向</h1>\n<p><a href=\"https://www.i4.cn/\">https://www.i4.cn/</a></p>\n<p>装爱思助手</p>\n<p>越狱，要制作启动盘</p>\n<p><a href=\"https://www.bilibili.com/video/BV1or421G7vo/?spm_id_from=333.788.videopod.sections&amp;vd_source=2c1227d0a7d29725db75d3fc52e6089b\">https://www.bilibili.com/video/BV1or421G7vo/?spm_id_from=333.788.videopod.sections&amp;vd_source=2c1227d0a7d29725db75d3fc52e6089b</a></p>\n<h3 id=\"frida\"><a class=\"anchor\" href=\"#frida\">#</a> Frida</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pip <span class=\"token function\">install</span> frida-tools</pre></td></tr></table></figure><h3 id=\"ghigra\"><a class=\"anchor\" href=\"#ghigra\">#</a> Ghigra</h3>\n<h4 id=\"x64dbg\"><a class=\"anchor\" href=\"#x64dbg\">#</a> x64dbg</h4>\n<p>gitbub 上有</p>\n<h1 id=\"unity\"><a class=\"anchor\" href=\"#unity\">#</a> Unity</h1>\n<blockquote>\n<p>BUUCTF [BJDCTF2020]BJD hamburger competition</p>\n</blockquote>\n<p>第一次接触 Unity 的逆向题<br>\n这种关键代码一般都在  <code>assembly-csharp.dll</code>  里面，加载到 dnspy 里面，左边点开可以看到源代码</p>\n<h1 id=\"python\"><a class=\"anchor\" href=\"#python\">#</a> Python</h1>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pip <span class=\"token function\">install</span> uncompyle6</pre></td></tr></table></figure><p>用这个命令</p>\n<p>用 online 的比较好<a href=\"https://www.lddgo.net/en/string/pyc-compile-decompile\"> https://www.lddgo.net/en/string/pyc-compile-decompile</a></p>\n<h1 id=\"go\"><a class=\"anchor\" href=\"#go\">#</a> GO</h1>\n<p><a href=\"https://github.com/sibears/IDAGolangHelper\">https://github.com/sibears/IDAGolangHelper</a></p>\n<p>可以装这个插件</p>\n<h1 id=\"代码分析\"><a class=\"anchor\" href=\"#代码分析\">#</a> 代码分析</h1>\n<blockquote>\n<p>buuctf lucky guy</p>\n</blockquote>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int64<span class=\"token punctuation\">)</span>j <span class=\"token operator\">>></span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> <span class=\"token number\">31</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>_BYTE<span class=\"token punctuation\">)</span>j<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int64<span class=\"token punctuation\">)</span>j <span class=\"token operator\">>></span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> <span class=\"token number\">31</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span></pre></td></tr></table></figure><p>等价于</p>\n<p><code>j % 2 == 1</code></p>\n<h3 id=\"复用代码解密\"><a class=\"anchor\" href=\"#复用代码解密\">#</a> 复用代码解密</h3>\n<blockquote>\n<p>buuctf 刮开有奖</p>\n</blockquote>\n<p>这里面的函数 IDA 会判断错误，需要改正，类型改了代码也要记得改</p>\n<h4 id=\"答案在其他函数里\"><a class=\"anchor\" href=\"#答案在其他函数里\">#</a> 答案在其他函数里</h4>\n<blockquote>\n<p>buuctf [2019 红帽杯] easyRE</p>\n</blockquote>\n<p>往 main 的下面找找</p>\n<h2 id=\"花指令\"><a class=\"anchor\" href=\"#花指令\">#</a> 花指令</h2>\n<p>有时候 IDA 反编译不了，这个时候要改指令，通常是 jnz 指令</p>\n<blockquote>\n<p>buuctf Maze</p>\n</blockquote>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/31f160e7596c17139883c26175af9d24.webp\" alt=\"img\"></p>\n<p>如何 nop:</p>\n<ol>\n<li><code>Edit/Patch program/Change byte</code>  将要修改的 byte 改成 90，修改完后 <code>Edit/Patch program/Apply patches to input file</code>  保存修改后的文件，</li>\n<li>或者 <code>Edit/Patch program/Assemble</code>  直接输入 <code>nop</code> ，然后同样要保存</li>\n</ol>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/a3a1c2a23cadd179ee2a5d6c81e3adb2.webp\" alt=\"在这里插入图片描述\"></p>\n<h4 id=\"把报错的函数编译一下\"><a class=\"anchor\" href=\"#把报错的函数编译一下\">#</a> 把报错的函数编译一下</h4>\n<blockquote>\n<p>[MRCTF2020]Xor</p>\n</blockquote>\n<p>把报错的函数点进去反编译一下，然后再回来编译就可以了</p>\n<h3 id=\"数据类型判断\"><a class=\"anchor\" href=\"#数据类型判断\">#</a> 数据类型判断</h3>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>__int64 v6<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"input: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    a2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>v6 <span class=\"token operator\">+</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token function\">__isoc99_scanf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d\"</span><span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>这个 v6 应该是 4byte, 因为  <code>(char *)v6 + 4 * i)</code>  是 4 字节</p>\n<h2 id=\"加密算法\"><a class=\"anchor\" href=\"#加密算法\">#</a> 加密算法</h2>\n<h3 id=\"tea加密\"><a class=\"anchor\" href=\"#tea加密\">#</a> TEA 加密</h3>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>v3 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>a1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>v4 <span class=\"token operator\">=</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>v5 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0x3F</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    v5 <span class=\"token operator\">+=</span> <span class=\"token number\">1166789954</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    v3 <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span>v4 <span class=\"token operator\">+</span> v5 <span class=\"token operator\">+</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v4 <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token operator\">*</span>a2<span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v4 <span class=\"token operator\">>></span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> a2<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    v4 <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">+</span> v5 <span class=\"token operator\">+</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> a2<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">>></span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> a2<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token operator\">*</span>a1 <span class=\"token operator\">=</span> v3<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>result <span class=\"token operator\">=</span> v4<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v4<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>解密</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> a<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">0xDF48EF7E</span><span class=\"token punctuation\">,</span><span class=\"token number\">550153460</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3774025685</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1548802262</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2652626477</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x84F30420</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> table<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> decoded<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>j <span class=\"token operator\">&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">+=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">int</span> v5 <span class=\"token operator\">=</span> <span class=\"token number\">0x458BCD42</span> <span class=\"token operator\">*</span> <span class=\"token number\">64</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> v3 <span class=\"token operator\">=</span> a<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> v4 <span class=\"token operator\">=</span> a<span class=\"token punctuation\">[</span>j<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i <span class=\"token operator\">&lt;=</span> <span class=\"token number\">63</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        v4 <span class=\"token operator\">-=</span> <span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">+</span> v5 <span class=\"token operator\">+</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> table<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">>></span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> table<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        v3 <span class=\"token operator\">-=</span> <span class=\"token punctuation\">(</span>v4 <span class=\"token operator\">+</span> v5 <span class=\"token operator\">+</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v4 <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> table<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v4 <span class=\"token operator\">>></span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> table<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        v5 <span class=\"token operator\">-=</span> <span class=\"token number\">0x458BCD42</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    decoded<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v3<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    decoded<span class=\"token punctuation\">[</span>j<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v4<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>要把 v3，v4 的类型写对，否则计算结果不对</p>\n<h3 id=\"解方程z3\"><a class=\"anchor\" href=\"#解方程z3\">#</a> 解方程 z3</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pip <span class=\"token function\">install</span> z3-solver</pre></td></tr></table></figure><blockquote>\n<p>buuctf [ACTF 新生赛 2020] Universe_final_answer</p>\n</blockquote>\n<h3 id=\"md5\"><a class=\"anchor\" href=\"#md5\">#</a> MD5</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Hash<span class=\"token punctuation\">.</span>MD5 <span class=\"token keyword\">import</span> MD5Hash</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> binascii <span class=\"token keyword\">import</span> hexlify</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>token <span class=\"token operator\">=</span> <span class=\"token string\">\"1001\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>hexlify<span class=\"token punctuation\">(</span>MD5Hash<span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>digest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>upper<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"init-函数修改\"><a class=\"anchor\" href=\"#init-函数修改\">#</a> init 函数修改</h2>\n<p><a href=\"https://www.cnblogs.com/NozoMizo/articles/17737745.html\">https://www.cnblogs.com/NozoMizo/articles/17737745.html</a></p>\n<h1 id=\"windows-api\"><a class=\"anchor\" href=\"#windows-api\">#</a> Windows API</h1>\n<h3 id=\"findresourcea\"><a class=\"anchor\" href=\"#findresourcea\">#</a> FindResourceA</h3>\n<blockquote>\n<p>buuctf CrackRTF</p>\n</blockquote>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"><span>c</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hResInfo <span class=\"token operator\">=</span> <span class=\"token function\">FindResourceA</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>LPCSTR<span class=\"token punctuation\">)</span><span class=\"token number\">0x65</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AAA\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>hResInfo<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><code>FindResourceA</code>  函数用于查找一个指定的资源。</p>\n<ul>\n<li>第一个参数是模块句柄，这里为  <code>0</code> ，表示当前模块。</li>\n<li>第二个参数  <code>(LPCSTR)0x65</code>  是资源的标识符（ID），这里使用的是资源 ID  <code>0x65</code> 。</li>\n<li>第三个参数  <code>&quot;AAA&quot;</code>  是资源的类型名称。</li>\n</ul>\n<p>如果  <code>FindResourceA</code>  返回  <code>NULL</code> ，则表示资源没有找到，函数立即返回  <code>0</code> 。</p>\n<p><strong>用 Resource Hacker 可以提取 exe 的资源</strong></p>\n<p><code>SizeofResource</code>  获取指定资源的大小，结果赋值给  <code>nNumberOfBytesToWrite</code> ，表示将要写入的字节数</p>\n<h3 id=\"loadresource\"><a class=\"anchor\" href=\"#loadresource\">#</a> LoadResource</h3>\n<p><code>LoadResource</code>  函数将资源加载到内存中，返回资源的句柄  <code>hResData</code> 。</p>\n<p>如果加载失败，返回  <code>NULL</code> ，函数返回  <code>0</code> 。</p>\n<h4 id=\"lockresource\"><a class=\"anchor\" href=\"#lockresource\">#</a> LockResource</h4>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"><span>c</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>lpBuffer <span class=\"token operator\">=</span> <span class=\"token function\">LockResource</span><span class=\"token punctuation\">(</span>hResData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><code>LockResource</code>  锁定资源并返回一个指向资源数据的指针  <code>lpBuffer</code> 。通过这个指针可以访问资源内容</p>\n<h3 id=\"createfile\"><a class=\"anchor\" href=\"#createfile\">#</a> CreateFile</h3>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"><span>c</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hFile <span class=\"token operator\">=</span> <span class=\"token function\">CreateFileA</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dbapp.rtf\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x10000000u</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2u</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x80u</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hFile <span class=\"token operator\">==</span> <span class=\"token punctuation\">(</span>HANDLE<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><code>CreateFileA</code>  用于创建或打开文件，这里试图创建一个名为  <code>&quot;dbapp.rtf&quot;</code>  的文件。</p>\n<ul>\n<li><code>0x10000000u</code> ： <code>GENERIC_WRITE</code> ，表示文件以写入模式打开。</li>\n<li><code>0</code>  和  <code>0</code> ：表示不使用文件共享和默认安全属性。</li>\n<li><code>2u</code> ： <code>CREATE_ALWAYS</code> ，表示总是创建文件，即使文件已经存在也会覆盖。</li>\n<li><code>0x80u</code> ： <code>FILE_ATTRIBUTE_NORMAL</code> ，表示文件的普通属性。</li>\n</ul>\n<p>如果文件创建失败，返回  <code>(HANDLE)-1</code> ，函数返回  <code>0</code> 。</p>\n<h3 id=\"writefile\"><a class=\"anchor\" href=\"#writefile\">#</a> WriteFile</h3>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">WriteFile</span><span class=\"token punctuation\">(</span>hFile<span class=\"token punctuation\">,</span> lpBuffer<span class=\"token punctuation\">,</span> nNumberOfBytesToWrite<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>NumberOfBytesWritten<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><code>WriteFile</code>  将  <code>lpBuffer</code>  中的数据写入到文件  <code>hFile</code> ，写入的字节数为  <code>nNumberOfBytesToWrite</code> 。</p>\n<p><code>&amp;NumberOfBytesWritten</code>  用于接收实际写入的字节数。</p>\n<p>如果  <code>WriteFile</code>  失败，函数返回  <code>0</code> 。</p>\n<h2 id=\"多线程\"><a class=\"anchor\" href=\"#多线程\">#</a> 多线程</h2>\n<blockquote>\n<p>buuctf Youngter-drive</p>\n<p><code>counter = 29</code></p>\n<p>最终加密  <code>TOiZiZtOrYaToUwPnToBsOaOapsyS</code></p>\n<p>线程 1：若 counter&gt;-1 每次调用对 counter 位置加密，并且每次 - 1</p>\n<p>线程 2：若 counter&gt;-1 每次 -1</p>\n<p>所以加密基数或者偶数部分</p>\n</blockquote>\n<p>CreateMutexW: 作用是找出当前系统是否已经存在指定进程的实例.</p>\n<p>CreateThread:CreateThread 是一种微软在 Windows API 中提供了建立新的线程的函数，该<a href=\"https://baike.baidu.com/item/%E5%87%BD%E6%95%B0/301912?fromModule=lemma_inlink\">函数</a>在<a href=\"https://baike.baidu.com/item/%E4%B8%BB%E7%BA%BF%E7%A8%8B/9600138?fromModule=lemma_inlink\">主线程</a>的基础上创建一个新线程。<a href=\"https://baike.baidu.com/item/%E7%BA%BF%E7%A8%8B/103101?fromModule=lemma_inlink\">线程</a>终止运行后，线程对象仍然在系统中，必须通过 CloseHandle 函数来关闭该线程对象。</p>\n<p>CloseHandle: 关闭一个内核对象。其中包括文件、文件映射、进程、线程、安全和同步对象等。在 CreateThread 成功之后会返回一个 hThread 的 handle，且内核对象的计数加 1，CloseHandle 之后，引用计数减 1，当变为 0 时，系统删除内核对象。</p>\n<p>WaitForSingleObject:WaitForSingleObject 函数用来检测 hHandle 事件的信号状态，在某一线程中调用该函数时，线程暂时挂起，如果在挂起的 dwMilliseconds 毫秒内，线程所等待的对象变为有信号状态，则该函数立即返回；如果时间已经到达 dwMilliseconds 毫秒，但 hHandle 所指向的对象还没有变成有信号状态，函数照样返回。</p>\n<p>在这里就相当于，第一个线程调用该函数，然后这里的 WaitForSingleObject 函数用来检测之前线程的信号状态，暂时挂起</p>\n<p>多线程例子：</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;windows.h></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>HANDLE hMutex<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">int</span> arr<span class=\"token punctuation\">[</span><span class=\"token number\">100</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">int</span> last <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>DWORD WINAPI <span class=\"token function\">thread01</span><span class=\"token punctuation\">(</span>LPVOID lvParameter<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t<span class=\"token function\">WaitForSingleObject</span><span class=\"token punctuation\">(</span>hMutex<span class=\"token punctuation\">,</span> INFINITE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>last <span class=\"token operator\">==</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\tarr<span class=\"token punctuation\">[</span>last<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\tlast<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\tstd<span class=\"token double-colon punctuation\">::</span>cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"thread 1 work on \"</span> <span class=\"token operator\">&lt;&lt;</span> last <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> std<span class=\"token double-colon punctuation\">::</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t\t<span class=\"token function\">ReleaseMutex</span><span class=\"token punctuation\">(</span>hMutex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>DWORD WINAPI <span class=\"token function\">thread02</span><span class=\"token punctuation\">(</span>LPVOID lvParameter<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t\t<span class=\"token function\">WaitForSingleObject</span><span class=\"token punctuation\">(</span>hMutex<span class=\"token punctuation\">,</span> INFINITE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>last <span class=\"token operator\">==</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t\tarr<span class=\"token punctuation\">[</span>last<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t\tlast<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t\tstd<span class=\"token double-colon punctuation\">::</span>cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"thread 2 work on \"</span> <span class=\"token operator\">&lt;&lt;</span> last <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> std<span class=\"token double-colon punctuation\">::</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t\t<span class=\"token function\">ReleaseMutex</span><span class=\"token punctuation\">(</span>hMutex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\thMutex <span class=\"token operator\">=</span> <span class=\"token function\">CreateMutexA</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> FALSE<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>LPCSTR<span class=\"token punctuation\">)</span><span class=\"token string\">\"Test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hMutex <span class=\"token operator\">==</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\t\tstd<span class=\"token double-colon punctuation\">::</span>cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"ERROR\"</span> <span class=\"token operator\">&lt;&lt;</span> std<span class=\"token double-colon punctuation\">::</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\tHANDLE hTread1 <span class=\"token operator\">=</span> <span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> thread01<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hTread1 <span class=\"token operator\">==</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>\t\tstd<span class=\"token double-colon punctuation\">::</span>cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"ERROR\"</span> <span class=\"token operator\">&lt;&lt;</span> std<span class=\"token double-colon punctuation\">::</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"47\"></td><td><pre>\tHANDLE hTread2 <span class=\"token operator\">=</span> <span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> thread02<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hTread2 <span class=\"token operator\">==</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>\t\tstd<span class=\"token double-colon punctuation\">::</span>cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"ERROR\"</span> <span class=\"token operator\">&lt;&lt;</span> std<span class=\"token double-colon punctuation\">::</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>\t<span class=\"token function\">WaitForSingleObject</span><span class=\"token punctuation\">(</span>hTread1<span class=\"token punctuation\">,</span> INFINITE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>\t<span class=\"token function\">WaitForSingleObject</span><span class=\"token punctuation\">(</span>hTread2<span class=\"token punctuation\">,</span> INFINITE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"57\"></td><td><pre>\t<span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hTread1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>\t<span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hTread2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"60\"></td><td><pre>\t<span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hMutex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>这题里面</p>\n<h1 id=\"游戏逆向\"><a class=\"anchor\" href=\"#游戏逆向\">#</a> 游戏逆向</h1>\n<h3 id=\"任务管理器找进程\"><a class=\"anchor\" href=\"#任务管理器找进程\">#</a> 任务管理器找进程</h3>\n<p>打开任务管理器</p>\n<p>&lt;img src=&quot;逆向工程 /image-20240811072446821.png&quot; alt=&quot;image-20240811072446821&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>然后右键，转到详细信息就有了</p>\n<h2 id=\"ce\"><a class=\"anchor\" href=\"#ce\">#</a> CE</h2>\n<p>资源网址:<a href=\"https://wpfx.org/\">https://wpfx.org/</a></p>\n<p>[CE](D:\\Software\\Cheat_Engine_7.5\\Cheat Engine 7.5)</p>\n<p><a href=\"%E2%80%AAE:%5CTools%5COD%5COllyICE%5COD.exe\">ollydbg</a></p>\n<p>搜字符串的时候把代码页勾上，可以搜出更多</p>\n<h4 id=\"找血量\"><a class=\"anchor\" href=\"#找血量\">#</a> 找血量</h4>\n<p>可以换装备，被怪打</p>\n<h4 id=\"搜byte\"><a class=\"anchor\" href=\"#搜byte\">#</a> 搜 byte</h4>\n<p>可以勾选快速扫描，4 字节对齐，这样可以加快速度</p>\n<h4 id=\"天龙八部\"><a class=\"anchor\" href=\"#天龙八部\">#</a> 天龙八部</h4>\n<p>TODO: p37</p>\n<p>记得启动器里面选 32 位</p>\n<p><code>axery123@changyou.com</code></p>\n<p><code>123axery</code></p>\n<p><code>岳朋 男 211481198401154411</code></p>\n<h5 id=\"人物状态\"><a class=\"anchor\" href=\"#人物状态\">#</a> 人物状态</h5>\n<p>rcx + 234</p>\n<p>1A34D9946D0 + 234</p>\n<p>rcx = rax+80</p>\n<p>rax=1A30B1C01D0</p>\n<p>Game.exe+593935</p>\n<h2 id=\"汇编指令\"><a class=\"anchor\" href=\"#汇编指令\">#</a> 汇编指令</h2>\n<h4 id=\"lea\"><a class=\"anchor\" href=\"#lea\">#</a> lea</h4>\n<pre><code>lea eax, dword ptr [ebp-8]\n</code></pre>\n<p>把右边的地址复制给左边</p>\n<h4 id=\"pushad-popad\"><a class=\"anchor\" href=\"#pushad-popad\">#</a> pushad, popad</h4>\n<p>把 8 个寄存器全部 push 到栈上面</p>\n<h4 id=\"rep-movs\"><a class=\"anchor\" href=\"#rep-movs\">#</a> rep movs</h4>\n<p>循环 ecx 次，每次把 esi 地址的内容复制给 edi 地址的内容，然后 esi,edi 增加 4</p>\n<h3 id=\"栈\"><a class=\"anchor\" href=\"#栈\">#</a> 栈</h3>\n<h4 id=\"ebp\"><a class=\"anchor\" href=\"#ebp\">#</a> ebp</h4>\n<p>栈顶</p>\n<ul>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mi>b</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">ebp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">p</span></span></span></span> 是保持上次的 ebp 值 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>u</mi><mi>s</mi><mi>h</mi><mtext> </mtext><mi>e</mi><mi>b</mi><mi>p</mi><mo separator=\"true\">,</mo><mi>m</mi><mi>o</mi><mi>v</mi><mtext> </mtext><mi>e</mi><mi>b</mi><mi>p</mi><mo separator=\"true\">,</mo><mi>e</mi><mi>s</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">push \\ ebp, mov \\ ebp, esp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">h</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">p</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">p</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">es</span><span class=\"mord mathnormal\">p</span></span></span></span></p>\n</li>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>e</mi><mi>b</mi><mi>p</mi><mo>+</mo><mn>4</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[ebp+4]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">4</span><span class=\"mclose\">]</span></span></span></span> 是回去的地址</p>\n</li>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>e</mi><mi>b</mi><mi>p</mi><mo>+</mo><mn>8</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[ebp+8]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">8</span><span class=\"mclose\">]</span></span></span></span> 是传入的第一个参数</p>\n</li>\n</ul>\n<h2 id=\"ollydbg\"><a class=\"anchor\" href=\"#ollydbg\">#</a> OllyDBG</h2>\n<p><a href=\"E:%5CTools%5COD%5COllyICE%5COD.exe\">ollydbg</a></p>\n<p>汉化包</p>\n<p><a href=\"https://github.com/lennylxx/ollydbg-zh/releases\">https://github.com/lennylxx/ollydbg-zh/releases</a></p>\n<p>复制到根目录之后，可以在 file 里面选择 gui language 为中文</p>\n<h3 id=\"快捷键\"><a class=\"anchor\" href=\"#快捷键\">#</a> 快捷键</h3>\n<ul>\n<li>回车：进入 call</li>\n<li>F9: 运行</li>\n<li>F8: 步过 把 call 运行完</li>\n<li>F7: 步入： 运行到 call 的开头</li>\n<li><code>-</code>  后退</li>\n<li><code>+</code>  前进</li>\n<li>F2：断点</li>\n<li>F4：运行到当前指向的命令</li>\n<li>Ctrl+F9: 执行到返回</li>\n<li>Ctrl+G: 查看地址，APT 代码</li>\n</ul>\n<h3 id=\"x64dbg-2\"><a class=\"anchor\" href=\"#x64dbg-2\">#</a> x64dbg</h3>\n<ul>\n<li>\n<p>再选项里吗可以设置关闭断点</p>\n</li>\n<li>\n<p>带参数调试 ： 文件，改变命令行</p>\n</li>\n<li>\n<p>高亮寄存器：快捷键 H，再选项中打开</p>\n</li>\n</ul>\n<h3 id=\"命令\"><a class=\"anchor\" href=\"#命令\">#</a> 命令</h3>\n<ul>\n<li>API 断点:  <code>bp MessageBoxA</code></li>\n<li>dd 输出地址的值   <code>dd eax</code></li>\n</ul>\n<h3 id=\"查找字符串\"><a class=\"anchor\" href=\"#查找字符串\">#</a> 查找字符串</h3>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240929115846957.png\" alt=\"image-20240929115846957\"></p>\n<h3 id=\"附加进程\"><a class=\"anchor\" href=\"#附加进程\">#</a> 附加进程</h3>\n<p>文件，附加 j 进程，选择想要的进程</p>\n<p>点击三角形让程序运行，</p>\n<p>如果卡住了可以按 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span> , 然后右键 Resume all threads</p>\n<h4 id=\"od界面\"><a class=\"anchor\" href=\"#od界面\">#</a> OD 界面</h4>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span> 是模块，选择游戏模块</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span> 是初始界面</p>\n<p>查找注释：</p>\n<p>先在 E 窗口找到主程序，然后右键查找用户定义的注释</p>\n<h4 id=\"跳转\"><a class=\"anchor\" href=\"#跳转\">#</a> 跳转</h4>\n<p>Ctrl+G 打开调整，输入内存地址或者  <code>ws2_32.send</code></p>\n<p>x64dbg 是  <code>game + 2ECE21</code>  可以加入基地址</p>\n<p>可以跳到这个模块的 send 函数</p>\n<h3 id=\"od断点\"><a class=\"anchor\" href=\"#od断点\">#</a> OD 断点</h3>\n<p>右键可以下断点</p>\n<h4 id=\"内存断点\"><a class=\"anchor\" href=\"#内存断点\">#</a> 内存断点</h4>\n<p>内存访问的时候断</p>\n<h4 id=\"硬件断点\"><a class=\"anchor\" href=\"#硬件断点\">#</a> 硬件断点</h4>\n<p>只能 4 个</p>\n<p>可以在内存地址右键，硬件断点，硬件写入，Byte</p>\n<p>来查找谁写入了这个位置</p>\n<h4 id=\"f2断点\"><a class=\"anchor\" href=\"#f2断点\">#</a> F2 断点</h4>\n<p>可以下任意多个</p>\n<h4 id=\"api断点\"><a class=\"anchor\" href=\"#api断点\">#</a> api 断点</h4>\n<p><code>bp ws2_32.send</code></p>\n<h4 id=\"条件断点\"><a class=\"anchor\" href=\"#条件断点\">#</a> 条件断点</h4>\n<p>shift + F2</p>\n<p><code>[76ad5000]==06aa72a0</code></p>\n<h3 id=\"发包\"><a class=\"anchor\" href=\"#发包\">#</a> 发包</h3>\n<h4 id=\"发包函数\"><a class=\"anchor\" href=\"#发包函数\">#</a> 发包函数</h4>\n<ul>\n<li>send</li>\n<li>sendto</li>\n<li>WSASend</li>\n<li>WSPSend: 在  <code>ws2_32.WEP</code>  下面有个  <code>call esi</code>  这个是</li>\n</ul>\n<p>一般是  <code>ws2_32.send</code>  在这个模块里，如果不是的话，需要指定模块名字</p>\n<h2 id=\"易语言\"><a class=\"anchor\" href=\"#易语言\">#</a> 易语言</h2>\n<p><a href=\"https://www.dywt.com.cn/\">https://www.dywt.com.cn/</a> 产品下载 5.93</p>\n<p>下载易语言安装补丁 ( <code>CTF/逆向</code> )</p>\n<p>把  <code>e.exe</code>  替换过去，linker 里面的内容也拖过来替换</p>\n<p>然后打开替换来的  <code>link.e</code>  用易语言打开，然后运行一下就好了</p>\n<h4 id=\"使用\"><a class=\"anchor\" href=\"#使用\">#</a> 使用</h4>\n<ul>\n<li>ctrl + L: 添加变量</li>\n</ul>\n<h4 id=\"编译\"><a class=\"anchor\" href=\"#编译\">#</a> 编译</h4>\n<p>编译，静态编译，</p>\n<p>静态的会打包所有需要的 dll</p>\n<h4 id=\"常用设置\"><a class=\"anchor\" href=\"#常用设置\">#</a> 常用设置</h4>\n<p>程序，程序配置对话框：可以配置图标，描述</p>\n<p>工具</p>\n<ul>\n<li>\n<p>支持库配置里全勾上</p>\n</li>\n<li>\n<p>系统设置，</p>\n<ul>\n<li>通常：可以取消编译时检查死循环</li>\n<li>存根，可以设置请求管理员权限</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"自定义数据类型\"><a class=\"anchor\" href=\"#自定义数据类型\">#</a> 自定义数据类型</h4>\n<p>就是 c 的 struct</p>\n<h4 id=\"基本函数\"><a class=\"anchor\" href=\"#基本函数\">#</a> 基本函数</h4>\n<p>到文本：转换成字符串</p>\n<h4 id=\"if\"><a class=\"anchor\" href=\"#if\">#</a> if</h4>\n<pre><code class=\"language-e\">如果 (时间 % 2)\n</code></pre>\n<p>没有 else 的</p>\n<pre><code class=\"language-e\">如果真 ()\n</code></pre>\n<p>判断 是 switch</p>\n<h4 id=\"for\"><a class=\"anchor\" href=\"#for\">#</a> for</h4>\n<p>j 从 1 到 100</p>\n<pre><code class=\"language-e\">计次循环首(100, j)\ns = s+j\n计次循环尾()\n</code></pre>\n<h4 id=\"while\"><a class=\"anchor\" href=\"#while\">#</a> while</h4>\n<pre><code class=\"language-e\">\na ＝ 1\n判断循环首 (a ＜ 10)\n    a ＝ a ＋ 1\n判断循环尾 ()\n标签1.标题 ＝ 到文本 (a)\n\n</code></pre>\n<h4 id=\"dll命令\"><a class=\"anchor\" href=\"#dll命令\">#</a> Dll 命令</h4>\n<p>比如 Messagebox</p>\n<h3 id=\"组件\"><a class=\"anchor\" href=\"#组件\">#</a> 组件</h3>\n<h4 id=\"时钟\"><a class=\"anchor\" href=\"#时钟\">#</a> 时钟</h4>\n<p>时钟周期</p>\n<h3 id=\"visual-studio\"><a class=\"anchor\" href=\"#visual-studio\">#</a> Visual Studio</h3>\n<p><a href=\"https://visualstudio.microsoft.com/de/\">https://visualstudio.microsoft.com/de/</a> 下载就行了</p>\n<p>然后只勾选 c<ins> 和 windows, 扩展开发，在 C</ins> 桌面开发里面额外勾选 MFC</p>\n<p>文件，账户选项，搜索字体，可以调整字体大小</p>\n<h4 id=\"反汇编\"><a class=\"anchor\" href=\"#反汇编\">#</a> 反汇编</h4>\n<p>打个断点运行后，右键选择  <code>转到反汇编</code></p>\n<p>右键可以选择是否显示变量名</p>\n<h5 id=\"内存\"><a class=\"anchor\" href=\"#内存\">#</a> 内存</h5>\n<p>在调试，窗口，内存里面找</p>\n<p>内存里面可以  <code>&amp;a</code>  来找到变量 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span> 的地址内容</p>\n<h4 id=\"mfc-dll\"><a class=\"anchor\" href=\"#mfc-dll\">#</a> MFC DLL</h4>\n<p>选择静态链接</p>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240811135822371.png\" alt=\"image-20240811135822371\"></p>\n<p>视图，其他窗口，资源视图，把他选出来</p>\n<p>然后右键添加资源，选择 Dialog</p>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240811140259142.png\" alt=\"image-20240811140259142\"></p>\n<p>确定和取消按钮可以自己删掉</p>\n<h4 id=\"32位程序\"><a class=\"anchor\" href=\"#32位程序\">#</a> 32 位程序</h4>\n<p>可以选择在 debug 旁边 选择 x86 来写 win32 程序</p>\n<h4 id=\"项目tl1属性\"><a class=\"anchor\" href=\"#项目tl1属性\">#</a> 项目，TL1 属性</h4>\n<p>可以选择 windows sdk 版本</p>\n<p>使用的字符集</p>\n<h4 id=\"工具箱\"><a class=\"anchor\" href=\"#工具箱\">#</a> 工具箱</h4>\n<p>视图，工具箱，里面有组件</p>\n<p>视图，属性窗口也要选</p>\n<h4 id=\"创建类\"><a class=\"anchor\" href=\"#创建类\">#</a> 创建类</h4>\n<p>右键 dialog 的空白处，添加类作为创建的这个 dialog 的类名，可以取名 <code>XXDialog</code></p>\n<p>在 DLL 的主 cpp 文件中</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>TLDialog<span class=\"token operator\">*</span> dialog<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>DWORD WINAPI <span class=\"token function\">ShowDialog</span><span class=\"token punctuation\">(</span>LPARAM lpData<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tdialog <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> TLDialog<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 分配空间</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\tdialog<span class=\"token operator\">-></span><span class=\"token function\">DoModal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 阻塞的方式 模态窗口</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token keyword\">delete</span> dialog<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 释放空间</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token function\">FreeLibraryAndExitThread</span><span class=\"token punctuation\">(</span>theApp<span class=\"token punctuation\">.</span>m_hInstance<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 释放 DLL 退出线程</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token keyword\">return</span> TRUE<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">// CMFCLibrary1App 初始化</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>BOOL <span class=\"token class-name\">CMFCLibrary1App</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">InitInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t<span class=\"token class-name\">CWinApp</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">InitInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>LPTHREAD_START_ROUTINE<span class=\"token punctuation\">)</span>ShowDialog<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 创建线程</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token keyword\">return</span> TRUE<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240811144327614.png\" alt=\"image-20240811144327614\"></p>\n<p>右键重新生成来编译</p>\n<p>在 CE 中查找好基地址和便宜</p>\n<blockquote>\n<p>练习：查找新天龙八部怀旧的人物状态</p>\n</blockquote>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">try</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    DWORD base_addr <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>DWORD<span class=\"token punctuation\">)</span><span class=\"token function\">GetModuleHandleA</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Game.exe\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x5946DC</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    DWORD offset1 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>DWORD<span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>base_addr <span class=\"token operator\">+</span> <span class=\"token number\">0x0c</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    DWORD offset2 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>DWORD<span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>offset1 <span class=\"token operator\">+</span> <span class=\"token number\">0x14c</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    DWORD addr <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>DWORD<span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>offset2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token function\">outputdebug</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"人物信息：人物状态: %d\"</span><span class=\"token punctuation\">,</span> addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> std<span class=\"token double-colon punctuation\">::</span>exception<span class=\"token operator\">&amp;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">outputdebug</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Error!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>然后是输出在 debug 信息的代码</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">outputdebug</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span> pszFormat<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">DEBUG</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token keyword\">char</span> szbufFormat<span class=\"token punctuation\">[</span><span class=\"token number\">0x1000</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token keyword\">char</span> szbufFormatGame<span class=\"token punctuation\">[</span><span class=\"token number\">0x1100</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tva_list argList<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token function\">va_start</span><span class=\"token punctuation\">(</span>argList<span class=\"token punctuation\">,</span> pszFormat<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token function\">vsprintf_s</span><span class=\"token punctuation\">(</span>szbufFormat<span class=\"token punctuation\">,</span> pszFormat<span class=\"token punctuation\">,</span> argList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token function\">strcat_s</span><span class=\"token punctuation\">(</span>szbufFormatGame<span class=\"token punctuation\">,</span> szbufFormat<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token function\">OutputDebugStringA</span><span class=\"token punctuation\">(</span>szbufFormatGame<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token function\">va_end</span><span class=\"token punctuation\">(</span>argList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>这个 dubug 信息可以在 DebugView 来看</p>\n<p>用管理员权限打开 DebugView, 然后打开监视核心，可以选择过滤字符串。</p>\n<h4 id=\"汇编代码注入\"><a class=\"anchor\" href=\"#汇编代码注入\">#</a> 汇编代码注入</h4>\n<p>call 函数的时候要记得先放在寄存器里</p>\n<p>Detach 之后再注入</p>\n<pre><code class=\"language-asm\">pushad\nmov ecx, 0x3F080A28\nmov eax, 0x6a5e60\ncall eax\npopad\n</code></pre>\n<p>ecx:</p>\n<pre><code class=\"language-asm\">[[[Game.exe+5946FC]+ 60]+ 154]\n</code></pre>\n<h2 id=\"天龙八部怀旧\"><a class=\"anchor\" href=\"#天龙八部怀旧\">#</a> 天龙八部怀旧</h2>\n<h4 id=\"背包数组\"><a class=\"anchor\" href=\"#背包数组\">#</a> 背包数组</h4>\n<p>cnt:</p>\n<pre><code class=\"language-asm\">[[i*4+[[Game.exe+594724]+181c4]]+0x14]+0x58\n</code></pre>\n<p>base</p>\n<pre><code class=\"language-asm\">[[Game.exe+594724]+181c4]\n</code></pre>\n<p>名字</p>\n<p>[[base+i*4]+2c]+18]</p>\n<ul>\n<li><code>+2c,+1c</code>  说明</li>\n<li><code>+2c,+20</code>  使用等级</li>\n<li><code>+2c,+40</code>  耐久</li>\n</ul>\n<h4 id=\"npc-遍历\"><a class=\"anchor\" href=\"#npc-遍历\">#</a> NPC 遍历</h4>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/c45b801d423975f7a189ebf3b9e8db1.png\" alt=\"c45b801d423975f7a189ebf3b9e8db1\"></p>\n<p>这是一个链表</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>esi <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>edi<span class=\"token operator\">+</span><span class=\"token number\">1</span>c<span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>esi <span class=\"token operator\">!=</span> <span class=\"token punctuation\">[</span>edi<span class=\"token operator\">+</span><span class=\"token number\">1</span>c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>esi<span class=\"token operator\">+</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    esi <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>esi<span class=\"token operator\">+</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"血量遍历\"><a class=\"anchor\" href=\"#血量遍历\">#</a> 血量遍历</h4>\n<p>先用 CE 搜索浮点数找到血量百分比</p>\n<pre><code class=\"language-asm\">[[[[[[[[[0x117CCB8]+0x54]+0x4]]]+0x14]+0x148]+0x10]+0x8]=target\n</code></pre>\n","length":11088,"excerpt":"","more":"<h1 id=\"ida的使用\"><a class=\"anchor\" href=\"#ida的使用\">#</a> IDA 的使用</h1>\n<p>根据程序的位数选择对应位数的 IDA 打开程序。（附件是 64 位的<br>\n一般没有特殊需求，我们直接默认点击 OK 就好了</p>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240929110409063.png\" alt=\"image-20240929110409063\"></p>\n<p>在 functions windows 里面找到 main</p>\n<p>然后在右边的窗口里按 F5 就可以跳出反汇编窗口</p>\n<blockquote>\n<p>buuctf-easyre</p>\n</blockquote>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240929110715802.png\" alt=\"image-20240929110715802\"></p>\n<p><a href=\"https://blog.csdn.net/weixin_45723661/category_11348511.html\">https://blog.csdn.net/weixin_45723661/category_11348511.html</a></p>\n<h3 id=\"ida-功能界面介绍\"><a class=\"anchor\" href=\"#ida-功能界面介绍\">#</a> IDA 功能界面介绍</h3>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240929112232598.png\" alt=\"image-20240929112232598\"></p>\n<p>- 蓝色 :  <code>.text section</code> <br>\n- 深蓝：用户写的函数编译后的代码区<br>\n - 浅蓝：编译器自己添加的函数，像启动函数，异常函数等等 ..<br>\n- 粉红色 :  <code>.idata section</code> <br>\n 有关输入表的一些数据信息<br>\n - 军绿色：  <code>.rdata section</code> <br>\n 纯数据，只读<br>\n - 灰色：为了段对齐而留下的空隙<br>\n - 黑色：禁区</p>\n<h4 id=\"汇编代码界面注释\"><a class=\"anchor\" href=\"#汇编代码界面注释\">#</a> 汇编代码界面注释</h4>\n<p><code>shift + ;</code></p>\n<p>伪代码注释</p>\n<p><code>/</code></p>\n<ul>\n<li>G 跳转</li>\n<li>N 改名</li>\n</ul>\n<h4 id=\"imports\"><a class=\"anchor\" href=\"#imports\">#</a> imports</h4>\n<p>程序从动态链接库中导入的要使用的函数</p>\n<h4 id=\"exports\"><a class=\"anchor\" href=\"#exports\">#</a> exports</h4>\n<p>程序导出给其它程序使用的函数</p>\n<h3 id=\"字符串窗口\"><a class=\"anchor\" href=\"#字符串窗口\">#</a> 字符串窗口</h3>\n<p><code>shift + F12</code></p>\n<p>双击字符串找到位置</p>\n<p>在 DATA XREF 里面可以找到谁访问了这个地址</p>\n<blockquote>\n<p>buuctf-reverse_1</p>\n</blockquote>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240929113449816.png\" alt=\"image-20240929113449816\"></p>\n<p>在数字上按 R 可以转换成字符</p>\n<h4 id=\"这个是带换行的\"><a class=\"anchor\" href=\"#这个是带换行的\">#</a> 这个是带换行的</h4>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240930190521829.png\" alt=\"image-20240930190521829\"></p>\n<ul>\n<li>按 A 转换成字符串</li>\n<li>D 转换成数据</li>\n<li>C 转换成汇编代码</li>\n<li>U 转换成原始字节</li>\n</ul>\n<h3 id=\"export-data\"><a class=\"anchor\" href=\"#export-data\">#</a> export data</h3>\n<p>shift + E 可以导出</p>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240930191508047.png\" alt=\"image-20240930191508047\"></p>\n<p>TODO:</p>\n<p>总结 SimpleRev</p>\n<h3 id=\"调整基地址\"><a class=\"anchor\" href=\"#调整基地址\">#</a> 调整基地址</h3>\n<p>Edit 里面 Segment 里面 Rebase Program, 然后输入基地址就可以和 x64dbg 地址对齐</p>\n<h4 id=\"跳转地址\"><a class=\"anchor\" href=\"#跳转地址\">#</a> 跳转地址</h4>\n<p>按 G 跳转</p>\n<h2 id=\"linux-调试\"><a class=\"anchor\" href=\"#linux-调试\">#</a> Linux 调试</h2>\n<p>使用 windows 下面的 ida pro 调试 Linux 下面的程序需要使用 ida 的远程调试功能。<br>\n首先将 ida 文件夹中的 dbgsrv/linux_serverx64 文件放入需要调试程序的同级文件夹中。再使用 chmod a+x linux_serverx64 改变该文件的权限。</p>\n<p>把要调试的文件也要 + x 运行权限</p>\n<p>然后连接</p>\n<p>再 application 和 inputfile 里填入要调试的<strong>绝对路径</strong> ，host 里面填 ip 地址，密码不用填，然后就可以了</p>\n<blockquote>\n<p>buuctf-level3</p>\n</blockquote>\n<p>下断点进调试看 base64 数组被改变的值</p>\n<h3 id=\"rsa\"><a class=\"anchor\" href=\"#rsa\">#</a> RSA</h3>\n<blockquote>\n<p>buuctf - signin</p>\n</blockquote>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">__gmpz_init_set_str</span><span class=\"token punctuation\">(</span>v7<span class=\"token punctuation\">,</span> <span class=\"token string\">\"ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">16LL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token function\">__gmpz_init_set_str</span><span class=\"token punctuation\">(</span>v6<span class=\"token punctuation\">,</span> v9<span class=\"token punctuation\">,</span> <span class=\"token number\">16LL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token function\">__gmpz_init_set_str</span><span class=\"token punctuation\">(</span>v4<span class=\"token punctuation\">,</span> <span class=\"token string\">\"103461035900816914121390101299049044413950405173712170434161686539878160984549\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10LL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token function\">__gmpz_init_set_str</span><span class=\"token punctuation\">(</span>v5<span class=\"token punctuation\">,</span> <span class=\"token string\">\"65537\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10LL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>看到这些整数可能是 RSA  <code>E=65537, N = 1034....</code></p>\n<p><code>__gmpz_init_set_str</code>  这是一个 GNU 高精度算法库</p>\n<p>这三个参数分别是多精度整数变量，字符串，进制</p>\n<p><code>__gmpz_powm(v6, v6, v5, v4) </code> 这个的意思其实就是 计算 v6 的 v5 次方并对 v4 取模，结果写入 v6。</p>\n<p>10346103590081691412139010129904904441395040517371217043416168653</p>\n<p><a href=\"http://www.factordb.com/index.php\">http://www.factordb.com/index.php</a> 这个可以查质数分解</p>\n<p>整数到 bytes</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>unhexlify<span class=\"token punctuation\">(</span><span class=\"token builtin\">hex</span><span class=\"token punctuation\">(</span>M<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># si = int.from_bytes(s) # byte to int</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\"># rsa.transform.int2bytes(c) # alternative</span></pre></td></tr></table></figure><p>题解</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> math</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span>number <span class=\"token keyword\">import</span> inverse</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> binascii <span class=\"token keyword\">import</span> unhexlify</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>e <span class=\"token operator\">=</span> <span class=\"token number\">65537</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>n <span class=\"token operator\">=</span> <span class=\"token number\">103461035900816914121390101299049044413950405173712170434161686539878160984549</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>p <span class=\"token operator\">=</span> <span class=\"token number\">282164587459512124844245113950593348271</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>q <span class=\"token operator\">=</span> <span class=\"token number\">366669102002966856876605669837014229419</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>c <span class=\"token operator\">=</span> <span class=\"token number\">0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>d <span class=\"token operator\">=</span> inverse<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> math<span class=\"token punctuation\">.</span>lcm<span class=\"token punctuation\">(</span>p<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>q<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>M <span class=\"token operator\">=</span> <span class=\"token builtin\">pow</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">,</span> d<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>rsa<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">.</span>int2bytes<span class=\"token punctuation\">(</span>M<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\t</pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\"># 或者</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>decrypted <span class=\"token operator\">=</span> rsa<span class=\"token punctuation\">.</span>PrivateKey<span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">,</span>d<span class=\"token punctuation\">,</span>p<span class=\"token punctuation\">,</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>blinded_decrypt<span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>rsa<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">.</span>int2bytes<span class=\"token punctuation\">(</span>decrypted<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>从 key 文件里面读取</p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>PublicKey <span class=\"token keyword\">import</span> RSA</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>f <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"pub.key\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"rb\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>pkdata <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>pk <span class=\"token operator\">=</span> RSA<span class=\"token punctuation\">.</span>import_key<span class=\"token punctuation\">(</span>pkdata<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>n <span class=\"token operator\">=</span> pk<span class=\"token punctuation\">.</span>n</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>e <span class=\"token operator\">=</span> pk<span class=\"token punctuation\">.</span>e</pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"壳\"><a class=\"anchor\" href=\"#壳\">#</a> 壳</h2>\n<p>用 exeinfope 可以看有没有壳， 或者用 file 指令</p>\n<h3 id=\"upx\"><a class=\"anchor\" href=\"#upx\">#</a> UPX</h3>\n<blockquote>\n<p>buuctf - 新年快乐</p>\n</blockquote>\n<p>可以看出来是 UPX 的壳</p>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240929125830292.png\" alt=\"image-20240929125830292\"></p>\n<p>file 指令会有</p>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240929130135608.png\" alt=\"image-20240929130135608\"></p>\n<p>解壳</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>upx <span class=\"token parameter variable\">-d</span> xx.exe</pre></td></tr></table></figure><h1 id=\"安卓java\"><a class=\"anchor\" href=\"#安卓java\">#</a> 安卓 / JAVA</h1>\n<p>jdk 安装<a href=\"https://www.oracle.com/java/technologies/downloads/#jdk22-windows\"> https://www.oracle.com/java/technologies/downloads/#jdk22-windows</a></p>\n<h3 id=\"jadx\"><a class=\"anchor\" href=\"#jadx\">#</a> jadx</h3>\n<p>安装<a href=\"https://github.com/skylot/jadx/releases/tag/v1.5.0\"> https://github.com/skylot/jadx/releases/tag/v1.5.0</a></p>\n<p>可以打开文件，把 APK 传进去，在左边可以看到源代码</p>\n<p>打开 windows gui 的那个</p>\n<h1 id=\"ios逆向\"><a class=\"anchor\" href=\"#ios逆向\">#</a> IOS 逆向</h1>\n<p><a href=\"https://www.i4.cn/\">https://www.i4.cn/</a></p>\n<p>装爱思助手</p>\n<p>越狱，要制作启动盘</p>\n<p><a href=\"https://www.bilibili.com/video/BV1or421G7vo/?spm_id_from=333.788.videopod.sections&amp;vd_source=2c1227d0a7d29725db75d3fc52e6089b\">https://www.bilibili.com/video/BV1or421G7vo/?spm_id_from=333.788.videopod.sections&amp;vd_source=2c1227d0a7d29725db75d3fc52e6089b</a></p>\n<h3 id=\"frida\"><a class=\"anchor\" href=\"#frida\">#</a> Frida</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pip <span class=\"token function\">install</span> frida-tools</pre></td></tr></table></figure><h3 id=\"ghigra\"><a class=\"anchor\" href=\"#ghigra\">#</a> Ghigra</h3>\n<h4 id=\"x64dbg\"><a class=\"anchor\" href=\"#x64dbg\">#</a> x64dbg</h4>\n<p>gitbub 上有</p>\n<h1 id=\"unity\"><a class=\"anchor\" href=\"#unity\">#</a> Unity</h1>\n<blockquote>\n<p>BUUCTF [BJDCTF2020]BJD hamburger competition</p>\n</blockquote>\n<p>第一次接触 Unity 的逆向题<br>\n这种关键代码一般都在  <code>assembly-csharp.dll</code>  里面，加载到 dnspy 里面，左边点开可以看到源代码</p>\n<h1 id=\"python\"><a class=\"anchor\" href=\"#python\">#</a> Python</h1>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pip <span class=\"token function\">install</span> uncompyle6</pre></td></tr></table></figure><p>用这个命令</p>\n<p>用 online 的比较好<a href=\"https://www.lddgo.net/en/string/pyc-compile-decompile\"> https://www.lddgo.net/en/string/pyc-compile-decompile</a></p>\n<h1 id=\"go\"><a class=\"anchor\" href=\"#go\">#</a> GO</h1>\n<p><a href=\"https://github.com/sibears/IDAGolangHelper\">https://github.com/sibears/IDAGolangHelper</a></p>\n<p>可以装这个插件</p>\n<h1 id=\"代码分析\"><a class=\"anchor\" href=\"#代码分析\">#</a> 代码分析</h1>\n<blockquote>\n<p>buuctf lucky guy</p>\n</blockquote>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int64<span class=\"token punctuation\">)</span>j <span class=\"token operator\">>></span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> <span class=\"token number\">31</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>_BYTE<span class=\"token punctuation\">)</span>j<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">unsigned</span> __int64<span class=\"token punctuation\">)</span>j <span class=\"token operator\">>></span> <span class=\"token number\">32</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> <span class=\"token number\">31</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span></pre></td></tr></table></figure><p>等价于</p>\n<p><code>j % 2 == 1</code></p>\n<h3 id=\"复用代码解密\"><a class=\"anchor\" href=\"#复用代码解密\">#</a> 复用代码解密</h3>\n<blockquote>\n<p>buuctf 刮开有奖</p>\n</blockquote>\n<p>这里面的函数 IDA 会判断错误，需要改正，类型改了代码也要记得改</p>\n<h4 id=\"答案在其他函数里\"><a class=\"anchor\" href=\"#答案在其他函数里\">#</a> 答案在其他函数里</h4>\n<blockquote>\n<p>buuctf [2019 红帽杯] easyRE</p>\n</blockquote>\n<p>往 main 的下面找找</p>\n<h2 id=\"花指令\"><a class=\"anchor\" href=\"#花指令\">#</a> 花指令</h2>\n<p>有时候 IDA 反编译不了，这个时候要改指令，通常是 jnz 指令</p>\n<blockquote>\n<p>buuctf Maze</p>\n</blockquote>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/31f160e7596c17139883c26175af9d24.webp\" alt=\"img\"></p>\n<p>如何 nop:</p>\n<ol>\n<li><code>Edit/Patch program/Change byte</code>  将要修改的 byte 改成 90，修改完后 <code>Edit/Patch program/Apply patches to input file</code>  保存修改后的文件，</li>\n<li>或者 <code>Edit/Patch program/Assemble</code>  直接输入 <code>nop</code> ，然后同样要保存</li>\n</ol>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/a3a1c2a23cadd179ee2a5d6c81e3adb2.webp\" alt=\"在这里插入图片描述\"></p>\n<h4 id=\"把报错的函数编译一下\"><a class=\"anchor\" href=\"#把报错的函数编译一下\">#</a> 把报错的函数编译一下</h4>\n<blockquote>\n<p>[MRCTF2020]Xor</p>\n</blockquote>\n<p>把报错的函数点进去反编译一下，然后再回来编译就可以了</p>\n<h3 id=\"数据类型判断\"><a class=\"anchor\" href=\"#数据类型判断\">#</a> 数据类型判断</h3>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>__int64 v6<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"input: \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    a2 <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>v6 <span class=\"token operator\">+</span> <span class=\"token number\">4</span> <span class=\"token operator\">*</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token function\">__isoc99_scanf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d\"</span><span class=\"token punctuation\">,</span> a2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>这个 v6 应该是 4byte, 因为  <code>(char *)v6 + 4 * i)</code>  是 4 字节</p>\n<h2 id=\"加密算法\"><a class=\"anchor\" href=\"#加密算法\">#</a> 加密算法</h2>\n<h3 id=\"tea加密\"><a class=\"anchor\" href=\"#tea加密\">#</a> TEA 加密</h3>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>v3 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span>a1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>v4 <span class=\"token operator\">=</span> a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>v5 <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0x3F</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i <span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    v5 <span class=\"token operator\">+=</span> <span class=\"token number\">1166789954</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    v3 <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span>v4 <span class=\"token operator\">+</span> v5 <span class=\"token operator\">+</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v4 <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token operator\">*</span>a2<span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v4 <span class=\"token operator\">>></span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> a2<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    v4 <span class=\"token operator\">+=</span> <span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">+</span> v5 <span class=\"token operator\">+</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> a2<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">>></span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> a2<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token operator\">*</span>a1 <span class=\"token operator\">=</span> v3<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>result <span class=\"token operator\">=</span> v4<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>a1<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v4<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">return</span> result<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>解密</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> a<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">0xDF48EF7E</span><span class=\"token punctuation\">,</span><span class=\"token number\">550153460</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3774025685</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1548802262</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2652626477</span><span class=\"token punctuation\">,</span><span class=\"token number\">0x84F30420</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> table<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> decoded<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>j <span class=\"token operator\">&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">+=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">int</span> v5 <span class=\"token operator\">=</span> <span class=\"token number\">0x458BCD42</span> <span class=\"token operator\">*</span> <span class=\"token number\">64</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">int</span> v3 <span class=\"token operator\">=</span> a<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> v4 <span class=\"token operator\">=</span> a<span class=\"token punctuation\">[</span>j<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>i <span class=\"token operator\">&lt;=</span> <span class=\"token number\">63</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        v4 <span class=\"token operator\">-=</span> <span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">+</span> v5 <span class=\"token operator\">+</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> table<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v3 <span class=\"token operator\">>></span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> table<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        v3 <span class=\"token operator\">-=</span> <span class=\"token punctuation\">(</span>v4 <span class=\"token operator\">+</span> v5 <span class=\"token operator\">+</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v4 <span class=\"token operator\">&lt;&lt;</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> table<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>v4 <span class=\"token operator\">>></span> <span class=\"token number\">9</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> table<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">^</span> <span class=\"token number\">0x20</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        v5 <span class=\"token operator\">-=</span> <span class=\"token number\">0x458BCD42</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    decoded<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v3<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    decoded<span class=\"token punctuation\">[</span>j<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> v4<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>要把 v3，v4 的类型写对，否则计算结果不对</p>\n<h3 id=\"解方程z3\"><a class=\"anchor\" href=\"#解方程z3\">#</a> 解方程 z3</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"><span>l</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>pip <span class=\"token function\">install</span> z3-solver</pre></td></tr></table></figure><blockquote>\n<p>buuctf [ACTF 新生赛 2020] Universe_final_answer</p>\n</blockquote>\n<h3 id=\"md5\"><a class=\"anchor\" href=\"#md5\">#</a> MD5</h3>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"><span>n</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">from</span> Crypto<span class=\"token punctuation\">.</span>Hash<span class=\"token punctuation\">.</span>MD5 <span class=\"token keyword\">import</span> MD5Hash</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">from</span> binascii <span class=\"token keyword\">import</span> hexlify</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>token <span class=\"token operator\">=</span> <span class=\"token string\">\"1001\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>hexlify<span class=\"token punctuation\">(</span>MD5Hash<span class=\"token punctuation\">(</span>token<span class=\"token punctuation\">.</span>encode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>digest<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">20</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>upper<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><h2 id=\"init-函数修改\"><a class=\"anchor\" href=\"#init-函数修改\">#</a> init 函数修改</h2>\n<p><a href=\"https://www.cnblogs.com/NozoMizo/articles/17737745.html\">https://www.cnblogs.com/NozoMizo/articles/17737745.html</a></p>\n<h1 id=\"windows-api\"><a class=\"anchor\" href=\"#windows-api\">#</a> Windows API</h1>\n<h3 id=\"findresourcea\"><a class=\"anchor\" href=\"#findresourcea\">#</a> FindResourceA</h3>\n<blockquote>\n<p>buuctf CrackRTF</p>\n</blockquote>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"><span>c</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hResInfo <span class=\"token operator\">=</span> <span class=\"token function\">FindResourceA</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>LPCSTR<span class=\"token punctuation\">)</span><span class=\"token number\">0x65</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"AAA\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>hResInfo<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><code>FindResourceA</code>  函数用于查找一个指定的资源。</p>\n<ul>\n<li>第一个参数是模块句柄，这里为  <code>0</code> ，表示当前模块。</li>\n<li>第二个参数  <code>(LPCSTR)0x65</code>  是资源的标识符（ID），这里使用的是资源 ID  <code>0x65</code> 。</li>\n<li>第三个参数  <code>&quot;AAA&quot;</code>  是资源的类型名称。</li>\n</ul>\n<p>如果  <code>FindResourceA</code>  返回  <code>NULL</code> ，则表示资源没有找到，函数立即返回  <code>0</code> 。</p>\n<p><strong>用 Resource Hacker 可以提取 exe 的资源</strong></p>\n<p><code>SizeofResource</code>  获取指定资源的大小，结果赋值给  <code>nNumberOfBytesToWrite</code> ，表示将要写入的字节数</p>\n<h3 id=\"loadresource\"><a class=\"anchor\" href=\"#loadresource\">#</a> LoadResource</h3>\n<p><code>LoadResource</code>  函数将资源加载到内存中，返回资源的句柄  <code>hResData</code> 。</p>\n<p>如果加载失败，返回  <code>NULL</code> ，函数返回  <code>0</code> 。</p>\n<h4 id=\"lockresource\"><a class=\"anchor\" href=\"#lockresource\">#</a> LockResource</h4>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"><span>c</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>lpBuffer <span class=\"token operator\">=</span> <span class=\"token function\">LockResource</span><span class=\"token punctuation\">(</span>hResData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><code>LockResource</code>  锁定资源并返回一个指向资源数据的指针  <code>lpBuffer</code> 。通过这个指针可以访问资源内容</p>\n<h3 id=\"createfile\"><a class=\"anchor\" href=\"#createfile\">#</a> CreateFile</h3>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"><span>c</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hFile <span class=\"token operator\">=</span> <span class=\"token function\">CreateFileA</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"dbapp.rtf\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x10000000u</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2u</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x80u</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hFile <span class=\"token operator\">==</span> <span class=\"token punctuation\">(</span>HANDLE<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><code>CreateFileA</code>  用于创建或打开文件，这里试图创建一个名为  <code>&quot;dbapp.rtf&quot;</code>  的文件。</p>\n<ul>\n<li><code>0x10000000u</code> ： <code>GENERIC_WRITE</code> ，表示文件以写入模式打开。</li>\n<li><code>0</code>  和  <code>0</code> ：表示不使用文件共享和默认安全属性。</li>\n<li><code>2u</code> ： <code>CREATE_ALWAYS</code> ，表示总是创建文件，即使文件已经存在也会覆盖。</li>\n<li><code>0x80u</code> ： <code>FILE_ATTRIBUTE_NORMAL</code> ，表示文件的普通属性。</li>\n</ul>\n<p>如果文件创建失败，返回  <code>(HANDLE)-1</code> ，函数返回  <code>0</code> 。</p>\n<h3 id=\"writefile\"><a class=\"anchor\" href=\"#writefile\">#</a> WriteFile</h3>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">WriteFile</span><span class=\"token punctuation\">(</span>hFile<span class=\"token punctuation\">,</span> lpBuffer<span class=\"token punctuation\">,</span> nNumberOfBytesToWrite<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>NumberOfBytesWritten<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><code>WriteFile</code>  将  <code>lpBuffer</code>  中的数据写入到文件  <code>hFile</code> ，写入的字节数为  <code>nNumberOfBytesToWrite</code> 。</p>\n<p><code>&amp;NumberOfBytesWritten</code>  用于接收实际写入的字节数。</p>\n<p>如果  <code>WriteFile</code>  失败，函数返回  <code>0</code> 。</p>\n<h2 id=\"多线程\"><a class=\"anchor\" href=\"#多线程\">#</a> 多线程</h2>\n<blockquote>\n<p>buuctf Youngter-drive</p>\n<p><code>counter = 29</code></p>\n<p>最终加密  <code>TOiZiZtOrYaToUwPnToBsOaOapsyS</code></p>\n<p>线程 1：若 counter&gt;-1 每次调用对 counter 位置加密，并且每次 - 1</p>\n<p>线程 2：若 counter&gt;-1 每次 -1</p>\n<p>所以加密基数或者偶数部分</p>\n</blockquote>\n<p>CreateMutexW: 作用是找出当前系统是否已经存在指定进程的实例.</p>\n<p>CreateThread:CreateThread 是一种微软在 Windows API 中提供了建立新的线程的函数，该<a href=\"https://baike.baidu.com/item/%E5%87%BD%E6%95%B0/301912?fromModule=lemma_inlink\">函数</a>在<a href=\"https://baike.baidu.com/item/%E4%B8%BB%E7%BA%BF%E7%A8%8B/9600138?fromModule=lemma_inlink\">主线程</a>的基础上创建一个新线程。<a href=\"https://baike.baidu.com/item/%E7%BA%BF%E7%A8%8B/103101?fromModule=lemma_inlink\">线程</a>终止运行后，线程对象仍然在系统中，必须通过 CloseHandle 函数来关闭该线程对象。</p>\n<p>CloseHandle: 关闭一个内核对象。其中包括文件、文件映射、进程、线程、安全和同步对象等。在 CreateThread 成功之后会返回一个 hThread 的 handle，且内核对象的计数加 1，CloseHandle 之后，引用计数减 1，当变为 0 时，系统删除内核对象。</p>\n<p>WaitForSingleObject:WaitForSingleObject 函数用来检测 hHandle 事件的信号状态，在某一线程中调用该函数时，线程暂时挂起，如果在挂起的 dwMilliseconds 毫秒内，线程所等待的对象变为有信号状态，则该函数立即返回；如果时间已经到达 dwMilliseconds 毫秒，但 hHandle 所指向的对象还没有变成有信号状态，函数照样返回。</p>\n<p>在这里就相当于，第一个线程调用该函数，然后这里的 WaitForSingleObject 函数用来检测之前线程的信号状态，暂时挂起</p>\n<p>多线程例子：</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;windows.h></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>HANDLE hMutex<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">int</span> arr<span class=\"token punctuation\">[</span><span class=\"token number\">100</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">int</span> last <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>DWORD WINAPI <span class=\"token function\">thread01</span><span class=\"token punctuation\">(</span>LPVOID lvParameter<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t<span class=\"token function\">WaitForSingleObject</span><span class=\"token punctuation\">(</span>hMutex<span class=\"token punctuation\">,</span> INFINITE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>last <span class=\"token operator\">==</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\tarr<span class=\"token punctuation\">[</span>last<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\tlast<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\tstd<span class=\"token double-colon punctuation\">::</span>cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"thread 1 work on \"</span> <span class=\"token operator\">&lt;&lt;</span> last <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> std<span class=\"token double-colon punctuation\">::</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t\t<span class=\"token function\">ReleaseMutex</span><span class=\"token punctuation\">(</span>hMutex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>DWORD WINAPI <span class=\"token function\">thread02</span><span class=\"token punctuation\">(</span>LPVOID lvParameter<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t\t<span class=\"token function\">WaitForSingleObject</span><span class=\"token punctuation\">(</span>hMutex<span class=\"token punctuation\">,</span> INFINITE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>last <span class=\"token operator\">==</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t\tarr<span class=\"token punctuation\">[</span>last<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t\tlast<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t\tstd<span class=\"token double-colon punctuation\">::</span>cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"thread 2 work on \"</span> <span class=\"token operator\">&lt;&lt;</span> last <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> std<span class=\"token double-colon punctuation\">::</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t\t<span class=\"token function\">ReleaseMutex</span><span class=\"token punctuation\">(</span>hMutex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\thMutex <span class=\"token operator\">=</span> <span class=\"token function\">CreateMutexA</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> FALSE<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>LPCSTR<span class=\"token punctuation\">)</span><span class=\"token string\">\"Test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hMutex <span class=\"token operator\">==</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\t\tstd<span class=\"token double-colon punctuation\">::</span>cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"ERROR\"</span> <span class=\"token operator\">&lt;&lt;</span> std<span class=\"token double-colon punctuation\">::</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\tHANDLE hTread1 <span class=\"token operator\">=</span> <span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> thread01<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hTread1 <span class=\"token operator\">==</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>\t\tstd<span class=\"token double-colon punctuation\">::</span>cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"ERROR\"</span> <span class=\"token operator\">&lt;&lt;</span> std<span class=\"token double-colon punctuation\">::</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"47\"></td><td><pre>\tHANDLE hTread2 <span class=\"token operator\">=</span> <span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> thread02<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hTread2 <span class=\"token operator\">==</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>\t\tstd<span class=\"token double-colon punctuation\">::</span>cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"ERROR\"</span> <span class=\"token operator\">&lt;&lt;</span> std<span class=\"token double-colon punctuation\">::</span>endl<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>\t\t<span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>\t<span class=\"token function\">WaitForSingleObject</span><span class=\"token punctuation\">(</span>hTread1<span class=\"token punctuation\">,</span> INFINITE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>\t<span class=\"token function\">WaitForSingleObject</span><span class=\"token punctuation\">(</span>hTread2<span class=\"token punctuation\">,</span> INFINITE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"57\"></td><td><pre>\t<span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hTread1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>\t<span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hTread2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"60\"></td><td><pre>\t<span class=\"token function\">CloseHandle</span><span class=\"token punctuation\">(</span>hMutex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>这题里面</p>\n<h1 id=\"游戏逆向\"><a class=\"anchor\" href=\"#游戏逆向\">#</a> 游戏逆向</h1>\n<h3 id=\"任务管理器找进程\"><a class=\"anchor\" href=\"#任务管理器找进程\">#</a> 任务管理器找进程</h3>\n<p>打开任务管理器</p>\n<p>&lt;img src=&quot;逆向工程 /image-20240811072446821.png&quot; alt=&quot;image-20240811072446821&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>然后右键，转到详细信息就有了</p>\n<h2 id=\"ce\"><a class=\"anchor\" href=\"#ce\">#</a> CE</h2>\n<p>资源网址:<a href=\"https://wpfx.org/\">https://wpfx.org/</a></p>\n<p>[CE](D:\\Software\\Cheat_Engine_7.5\\Cheat Engine 7.5)</p>\n<p><a href=\"%E2%80%AAE:%5CTools%5COD%5COllyICE%5COD.exe\">ollydbg</a></p>\n<p>搜字符串的时候把代码页勾上，可以搜出更多</p>\n<h4 id=\"找血量\"><a class=\"anchor\" href=\"#找血量\">#</a> 找血量</h4>\n<p>可以换装备，被怪打</p>\n<h4 id=\"搜byte\"><a class=\"anchor\" href=\"#搜byte\">#</a> 搜 byte</h4>\n<p>可以勾选快速扫描，4 字节对齐，这样可以加快速度</p>\n<h4 id=\"天龙八部\"><a class=\"anchor\" href=\"#天龙八部\">#</a> 天龙八部</h4>\n<p>TODO: p37</p>\n<p>记得启动器里面选 32 位</p>\n<p><code>axery123@changyou.com</code></p>\n<p><code>123axery</code></p>\n<p><code>岳朋 男 211481198401154411</code></p>\n<h5 id=\"人物状态\"><a class=\"anchor\" href=\"#人物状态\">#</a> 人物状态</h5>\n<p>rcx + 234</p>\n<p>1A34D9946D0 + 234</p>\n<p>rcx = rax+80</p>\n<p>rax=1A30B1C01D0</p>\n<p>Game.exe+593935</p>\n<h2 id=\"汇编指令\"><a class=\"anchor\" href=\"#汇编指令\">#</a> 汇编指令</h2>\n<h4 id=\"lea\"><a class=\"anchor\" href=\"#lea\">#</a> lea</h4>\n<pre><code>lea eax, dword ptr [ebp-8]\n</code></pre>\n<p>把右边的地址复制给左边</p>\n<h4 id=\"pushad-popad\"><a class=\"anchor\" href=\"#pushad-popad\">#</a> pushad, popad</h4>\n<p>把 8 个寄存器全部 push 到栈上面</p>\n<h4 id=\"rep-movs\"><a class=\"anchor\" href=\"#rep-movs\">#</a> rep movs</h4>\n<p>循环 ecx 次，每次把 esi 地址的内容复制给 edi 地址的内容，然后 esi,edi 增加 4</p>\n<h3 id=\"栈\"><a class=\"anchor\" href=\"#栈\">#</a> 栈</h3>\n<h4 id=\"ebp\"><a class=\"anchor\" href=\"#ebp\">#</a> ebp</h4>\n<p>栈顶</p>\n<ul>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mi>b</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">ebp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">p</span></span></span></span> 是保持上次的 ebp 值 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>u</mi><mi>s</mi><mi>h</mi><mtext> </mtext><mi>e</mi><mi>b</mi><mi>p</mi><mo separator=\"true\">,</mo><mi>m</mi><mi>o</mi><mi>v</mi><mtext> </mtext><mi>e</mi><mi>b</mi><mi>p</mi><mo separator=\"true\">,</mo><mi>e</mi><mi>s</mi><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">push \\ ebp, mov \\ ebp, esp</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">h</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">p</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">p</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">es</span><span class=\"mord mathnormal\">p</span></span></span></span></p>\n</li>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>e</mi><mi>b</mi><mi>p</mi><mo>+</mo><mn>4</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[ebp+4]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">4</span><span class=\"mclose\">]</span></span></span></span> 是回去的地址</p>\n</li>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>e</mi><mi>b</mi><mi>p</mi><mo>+</mo><mn>8</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[ebp+8]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">8</span><span class=\"mclose\">]</span></span></span></span> 是传入的第一个参数</p>\n</li>\n</ul>\n<h2 id=\"ollydbg\"><a class=\"anchor\" href=\"#ollydbg\">#</a> OllyDBG</h2>\n<p><a href=\"E:%5CTools%5COD%5COllyICE%5COD.exe\">ollydbg</a></p>\n<p>汉化包</p>\n<p><a href=\"https://github.com/lennylxx/ollydbg-zh/releases\">https://github.com/lennylxx/ollydbg-zh/releases</a></p>\n<p>复制到根目录之后，可以在 file 里面选择 gui language 为中文</p>\n<h3 id=\"快捷键\"><a class=\"anchor\" href=\"#快捷键\">#</a> 快捷键</h3>\n<ul>\n<li>回车：进入 call</li>\n<li>F9: 运行</li>\n<li>F8: 步过 把 call 运行完</li>\n<li>F7: 步入： 运行到 call 的开头</li>\n<li><code>-</code>  后退</li>\n<li><code>+</code>  前进</li>\n<li>F2：断点</li>\n<li>F4：运行到当前指向的命令</li>\n<li>Ctrl+F9: 执行到返回</li>\n<li>Ctrl+G: 查看地址，APT 代码</li>\n</ul>\n<h3 id=\"x64dbg-2\"><a class=\"anchor\" href=\"#x64dbg-2\">#</a> x64dbg</h3>\n<ul>\n<li>\n<p>再选项里吗可以设置关闭断点</p>\n</li>\n<li>\n<p>带参数调试 ： 文件，改变命令行</p>\n</li>\n<li>\n<p>高亮寄存器：快捷键 H，再选项中打开</p>\n</li>\n</ul>\n<h3 id=\"命令\"><a class=\"anchor\" href=\"#命令\">#</a> 命令</h3>\n<ul>\n<li>API 断点:  <code>bp MessageBoxA</code></li>\n<li>dd 输出地址的值   <code>dd eax</code></li>\n</ul>\n<h3 id=\"查找字符串\"><a class=\"anchor\" href=\"#查找字符串\">#</a> 查找字符串</h3>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240929115846957.png\" alt=\"image-20240929115846957\"></p>\n<h3 id=\"附加进程\"><a class=\"anchor\" href=\"#附加进程\">#</a> 附加进程</h3>\n<p>文件，附加 j 进程，选择想要的进程</p>\n<p>点击三角形让程序运行，</p>\n<p>如果卡住了可以按 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span> , 然后右键 Resume all threads</p>\n<h4 id=\"od界面\"><a class=\"anchor\" href=\"#od界面\">#</a> OD 界面</h4>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>E</mi></mrow><annotation encoding=\"application/x-tex\">E</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span></span></span></span> 是模块，选择游戏模块</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">C</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span> 是初始界面</p>\n<p>查找注释：</p>\n<p>先在 E 窗口找到主程序，然后右键查找用户定义的注释</p>\n<h4 id=\"跳转\"><a class=\"anchor\" href=\"#跳转\">#</a> 跳转</h4>\n<p>Ctrl+G 打开调整，输入内存地址或者  <code>ws2_32.send</code></p>\n<p>x64dbg 是  <code>game + 2ECE21</code>  可以加入基地址</p>\n<p>可以跳到这个模块的 send 函数</p>\n<h3 id=\"od断点\"><a class=\"anchor\" href=\"#od断点\">#</a> OD 断点</h3>\n<p>右键可以下断点</p>\n<h4 id=\"内存断点\"><a class=\"anchor\" href=\"#内存断点\">#</a> 内存断点</h4>\n<p>内存访问的时候断</p>\n<h4 id=\"硬件断点\"><a class=\"anchor\" href=\"#硬件断点\">#</a> 硬件断点</h4>\n<p>只能 4 个</p>\n<p>可以在内存地址右键，硬件断点，硬件写入，Byte</p>\n<p>来查找谁写入了这个位置</p>\n<h4 id=\"f2断点\"><a class=\"anchor\" href=\"#f2断点\">#</a> F2 断点</h4>\n<p>可以下任意多个</p>\n<h4 id=\"api断点\"><a class=\"anchor\" href=\"#api断点\">#</a> api 断点</h4>\n<p><code>bp ws2_32.send</code></p>\n<h4 id=\"条件断点\"><a class=\"anchor\" href=\"#条件断点\">#</a> 条件断点</h4>\n<p>shift + F2</p>\n<p><code>[76ad5000]==06aa72a0</code></p>\n<h3 id=\"发包\"><a class=\"anchor\" href=\"#发包\">#</a> 发包</h3>\n<h4 id=\"发包函数\"><a class=\"anchor\" href=\"#发包函数\">#</a> 发包函数</h4>\n<ul>\n<li>send</li>\n<li>sendto</li>\n<li>WSASend</li>\n<li>WSPSend: 在  <code>ws2_32.WEP</code>  下面有个  <code>call esi</code>  这个是</li>\n</ul>\n<p>一般是  <code>ws2_32.send</code>  在这个模块里，如果不是的话，需要指定模块名字</p>\n<h2 id=\"易语言\"><a class=\"anchor\" href=\"#易语言\">#</a> 易语言</h2>\n<p><a href=\"https://www.dywt.com.cn/\">https://www.dywt.com.cn/</a> 产品下载 5.93</p>\n<p>下载易语言安装补丁 ( <code>CTF/逆向</code> )</p>\n<p>把  <code>e.exe</code>  替换过去，linker 里面的内容也拖过来替换</p>\n<p>然后打开替换来的  <code>link.e</code>  用易语言打开，然后运行一下就好了</p>\n<h4 id=\"使用\"><a class=\"anchor\" href=\"#使用\">#</a> 使用</h4>\n<ul>\n<li>ctrl + L: 添加变量</li>\n</ul>\n<h4 id=\"编译\"><a class=\"anchor\" href=\"#编译\">#</a> 编译</h4>\n<p>编译，静态编译，</p>\n<p>静态的会打包所有需要的 dll</p>\n<h4 id=\"常用设置\"><a class=\"anchor\" href=\"#常用设置\">#</a> 常用设置</h4>\n<p>程序，程序配置对话框：可以配置图标，描述</p>\n<p>工具</p>\n<ul>\n<li>\n<p>支持库配置里全勾上</p>\n</li>\n<li>\n<p>系统设置，</p>\n<ul>\n<li>通常：可以取消编译时检查死循环</li>\n<li>存根，可以设置请求管理员权限</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"自定义数据类型\"><a class=\"anchor\" href=\"#自定义数据类型\">#</a> 自定义数据类型</h4>\n<p>就是 c 的 struct</p>\n<h4 id=\"基本函数\"><a class=\"anchor\" href=\"#基本函数\">#</a> 基本函数</h4>\n<p>到文本：转换成字符串</p>\n<h4 id=\"if\"><a class=\"anchor\" href=\"#if\">#</a> if</h4>\n<pre><code class=\"language-e\">如果 (时间 % 2)\n</code></pre>\n<p>没有 else 的</p>\n<pre><code class=\"language-e\">如果真 ()\n</code></pre>\n<p>判断 是 switch</p>\n<h4 id=\"for\"><a class=\"anchor\" href=\"#for\">#</a> for</h4>\n<p>j 从 1 到 100</p>\n<pre><code class=\"language-e\">计次循环首(100, j)\ns = s+j\n计次循环尾()\n</code></pre>\n<h4 id=\"while\"><a class=\"anchor\" href=\"#while\">#</a> while</h4>\n<pre><code class=\"language-e\">\na ＝ 1\n判断循环首 (a ＜ 10)\n    a ＝ a ＋ 1\n判断循环尾 ()\n标签1.标题 ＝ 到文本 (a)\n\n</code></pre>\n<h4 id=\"dll命令\"><a class=\"anchor\" href=\"#dll命令\">#</a> Dll 命令</h4>\n<p>比如 Messagebox</p>\n<h3 id=\"组件\"><a class=\"anchor\" href=\"#组件\">#</a> 组件</h3>\n<h4 id=\"时钟\"><a class=\"anchor\" href=\"#时钟\">#</a> 时钟</h4>\n<p>时钟周期</p>\n<h3 id=\"visual-studio\"><a class=\"anchor\" href=\"#visual-studio\">#</a> Visual Studio</h3>\n<p><a href=\"https://visualstudio.microsoft.com/de/\">https://visualstudio.microsoft.com/de/</a> 下载就行了</p>\n<p>然后只勾选 c<ins> 和 windows, 扩展开发，在 C</ins> 桌面开发里面额外勾选 MFC</p>\n<p>文件，账户选项，搜索字体，可以调整字体大小</p>\n<h4 id=\"反汇编\"><a class=\"anchor\" href=\"#反汇编\">#</a> 反汇编</h4>\n<p>打个断点运行后，右键选择  <code>转到反汇编</code></p>\n<p>右键可以选择是否显示变量名</p>\n<h5 id=\"内存\"><a class=\"anchor\" href=\"#内存\">#</a> 内存</h5>\n<p>在调试，窗口，内存里面找</p>\n<p>内存里面可以  <code>&amp;a</code>  来找到变量 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span> 的地址内容</p>\n<h4 id=\"mfc-dll\"><a class=\"anchor\" href=\"#mfc-dll\">#</a> MFC DLL</h4>\n<p>选择静态链接</p>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240811135822371.png\" alt=\"image-20240811135822371\"></p>\n<p>视图，其他窗口，资源视图，把他选出来</p>\n<p>然后右键添加资源，选择 Dialog</p>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240811140259142.png\" alt=\"image-20240811140259142\"></p>\n<p>确定和取消按钮可以自己删掉</p>\n<h4 id=\"32位程序\"><a class=\"anchor\" href=\"#32位程序\">#</a> 32 位程序</h4>\n<p>可以选择在 debug 旁边 选择 x86 来写 win32 程序</p>\n<h4 id=\"项目tl1属性\"><a class=\"anchor\" href=\"#项目tl1属性\">#</a> 项目，TL1 属性</h4>\n<p>可以选择 windows sdk 版本</p>\n<p>使用的字符集</p>\n<h4 id=\"工具箱\"><a class=\"anchor\" href=\"#工具箱\">#</a> 工具箱</h4>\n<p>视图，工具箱，里面有组件</p>\n<p>视图，属性窗口也要选</p>\n<h4 id=\"创建类\"><a class=\"anchor\" href=\"#创建类\">#</a> 创建类</h4>\n<p>右键 dialog 的空白处，添加类作为创建的这个 dialog 的类名，可以取名 <code>XXDialog</code></p>\n<p>在 DLL 的主 cpp 文件中</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>TLDialog<span class=\"token operator\">*</span> dialog<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>DWORD WINAPI <span class=\"token function\">ShowDialog</span><span class=\"token punctuation\">(</span>LPARAM lpData<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tdialog <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> TLDialog<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 分配空间</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\tdialog<span class=\"token operator\">-></span><span class=\"token function\">DoModal</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 阻塞的方式 模态窗口</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token keyword\">delete</span> dialog<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 释放空间</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token function\">FreeLibraryAndExitThread</span><span class=\"token punctuation\">(</span>theApp<span class=\"token punctuation\">.</span>m_hInstance<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 释放 DLL 退出线程</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token keyword\">return</span> TRUE<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">// CMFCLibrary1App 初始化</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>BOOL <span class=\"token class-name\">CMFCLibrary1App</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">InitInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t<span class=\"token class-name\">CWinApp</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">InitInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">CreateThread</span><span class=\"token punctuation\">(</span><span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>LPTHREAD_START_ROUTINE<span class=\"token punctuation\">)</span>ShowDialog<span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 创建线程</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token keyword\">return</span> TRUE<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/image-20240811144327614.png\" alt=\"image-20240811144327614\"></p>\n<p>右键重新生成来编译</p>\n<p>在 CE 中查找好基地址和便宜</p>\n<blockquote>\n<p>练习：查找新天龙八部怀旧的人物状态</p>\n</blockquote>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">try</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    DWORD base_addr <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>DWORD<span class=\"token punctuation\">)</span><span class=\"token function\">GetModuleHandleA</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Game.exe\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">0x5946DC</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    DWORD offset1 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>DWORD<span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>base_addr <span class=\"token operator\">+</span> <span class=\"token number\">0x0c</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    DWORD offset2 <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>DWORD<span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>offset1 <span class=\"token operator\">+</span> <span class=\"token number\">0x14c</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    DWORD addr <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>DWORD<span class=\"token operator\">*</span><span class=\"token punctuation\">)</span>offset2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token function\">outputdebug</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"人物信息：人物状态: %d\"</span><span class=\"token punctuation\">,</span> addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> std<span class=\"token double-colon punctuation\">::</span>exception<span class=\"token operator\">&amp;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token function\">outputdebug</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Error!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>然后是输出在 debug 信息的代码</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">void</span> <span class=\"token function\">outputdebug</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span><span class=\"token operator\">*</span> pszFormat<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">DEBUG</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token keyword\">char</span> szbufFormat<span class=\"token punctuation\">[</span><span class=\"token number\">0x1000</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token keyword\">char</span> szbufFormatGame<span class=\"token punctuation\">[</span><span class=\"token number\">0x1100</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tva_list argList<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token function\">va_start</span><span class=\"token punctuation\">(</span>argList<span class=\"token punctuation\">,</span> pszFormat<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token function\">vsprintf_s</span><span class=\"token punctuation\">(</span>szbufFormat<span class=\"token punctuation\">,</span> pszFormat<span class=\"token punctuation\">,</span> argList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token function\">strcat_s</span><span class=\"token punctuation\">(</span>szbufFormatGame<span class=\"token punctuation\">,</span> szbufFormat<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token function\">OutputDebugStringA</span><span class=\"token punctuation\">(</span>szbufFormatGame<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token function\">va_end</span><span class=\"token punctuation\">(</span>argList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>这个 dubug 信息可以在 DebugView 来看</p>\n<p>用管理员权限打开 DebugView, 然后打开监视核心，可以选择过滤字符串。</p>\n<h4 id=\"汇编代码注入\"><a class=\"anchor\" href=\"#汇编代码注入\">#</a> 汇编代码注入</h4>\n<p>call 函数的时候要记得先放在寄存器里</p>\n<p>Detach 之后再注入</p>\n<pre><code class=\"language-asm\">pushad\nmov ecx, 0x3F080A28\nmov eax, 0x6a5e60\ncall eax\npopad\n</code></pre>\n<p>ecx:</p>\n<pre><code class=\"language-asm\">[[[Game.exe+5946FC]+ 60]+ 154]\n</code></pre>\n<h2 id=\"天龙八部怀旧\"><a class=\"anchor\" href=\"#天龙八部怀旧\">#</a> 天龙八部怀旧</h2>\n<h4 id=\"背包数组\"><a class=\"anchor\" href=\"#背包数组\">#</a> 背包数组</h4>\n<p>cnt:</p>\n<pre><code class=\"language-asm\">[[i*4+[[Game.exe+594724]+181c4]]+0x14]+0x58\n</code></pre>\n<p>base</p>\n<pre><code class=\"language-asm\">[[Game.exe+594724]+181c4]\n</code></pre>\n<p>名字</p>\n<p>[[base+i*4]+2c]+18]</p>\n<ul>\n<li><code>+2c,+1c</code>  说明</li>\n<li><code>+2c,+20</code>  使用等级</li>\n<li><code>+2c,+40</code>  耐久</li>\n</ul>\n<h4 id=\"npc-遍历\"><a class=\"anchor\" href=\"#npc-遍历\">#</a> NPC 遍历</h4>\n<p><img src=\"/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/c45b801d423975f7a189ebf3b9e8db1.png\" alt=\"c45b801d423975f7a189ebf3b9e8db1\"></p>\n<p>这是一个链表</p>\n<figure class=\"highlight cpp\"><figcaption data-lang=\"C++\"><span>p</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre>esi <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>edi<span class=\"token operator\">+</span><span class=\"token number\">1</span>c<span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>esi <span class=\"token operator\">!=</span> <span class=\"token punctuation\">[</span>edi<span class=\"token operator\">+</span><span class=\"token number\">1</span>c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>esi<span class=\"token operator\">+</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token number\">14</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    esi <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>esi<span class=\"token operator\">+</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"血量遍历\"><a class=\"anchor\" href=\"#血量遍历\">#</a> 血量遍历</h4>\n<p>先用 CE 搜索浮点数找到血量百分比</p>\n<pre><code class=\"language-asm\">[[[[[[[[[0x117CCB8]+0x54]+0x4]]]+0x14]+0x148]+0x10]+0x8]=target\n</code></pre>\n"}],"PostAsset":[{"_id":"source/_posts/逆向工程/31f160e7596c17139883c26175af9d24.webp","slug":"31f160e7596c17139883c26175af9d24.webp","post":"cm6qr0i9n0005yokj2ijnasg0","modified":0,"renderable":0},{"_id":"source/_posts/逆向工程/a3a1c2a23cadd179ee2a5d6c81e3adb2.webp","slug":"a3a1c2a23cadd179ee2a5d6c81e3adb2.webp","post":"cm6qr0i9n0005yokj2ijnasg0","modified":0,"renderable":0},{"_id":"source/_posts/逆向工程/c45b801d423975f7a189ebf3b9e8db1.png","slug":"c45b801d423975f7a189ebf3b9e8db1.png","post":"cm6qr0i9n0005yokj2ijnasg0","modified":0,"renderable":0},{"_id":"source/_posts/逆向工程/image-20240811072446821.png","slug":"image-20240811072446821.png","post":"cm6qr0i9n0005yokj2ijnasg0","modified":0,"renderable":0},{"_id":"source/_posts/逆向工程/image-20240811135822371.png","slug":"image-20240811135822371.png","post":"cm6qr0i9n0005yokj2ijnasg0","modified":0,"renderable":0},{"_id":"source/_posts/逆向工程/image-20240811140259142.png","slug":"image-20240811140259142.png","post":"cm6qr0i9n0005yokj2ijnasg0","modified":0,"renderable":0},{"_id":"source/_posts/逆向工程/image-20240811144327614.png","slug":"image-20240811144327614.png","post":"cm6qr0i9n0005yokj2ijnasg0","modified":0,"renderable":0},{"_id":"source/_posts/逆向工程/image-20240929110409063.png","slug":"image-20240929110409063.png","post":"cm6qr0i9n0005yokj2ijnasg0","modified":0,"renderable":0},{"_id":"source/_posts/逆向工程/image-20240929110715802.png","slug":"image-20240929110715802.png","post":"cm6qr0i9n0005yokj2ijnasg0","modified":0,"renderable":0},{"_id":"source/_posts/逆向工程/image-20240929112232598.png","slug":"image-20240929112232598.png","post":"cm6qr0i9n0005yokj2ijnasg0","modified":0,"renderable":0},{"_id":"source/_posts/逆向工程/image-20240929113449816.png","slug":"image-20240929113449816.png","post":"cm6qr0i9n0005yokj2ijnasg0","modified":0,"renderable":0},{"_id":"source/_posts/逆向工程/image-20240929115846957.png","slug":"image-20240929115846957.png","post":"cm6qr0i9n0005yokj2ijnasg0","modified":0,"renderable":0},{"_id":"source/_posts/逆向工程/image-20240929125830292.png","slug":"image-20240929125830292.png","post":"cm6qr0i9n0005yokj2ijnasg0","modified":0,"renderable":0},{"_id":"source/_posts/逆向工程/image-20240929130135608.png","slug":"image-20240929130135608.png","post":"cm6qr0i9n0005yokj2ijnasg0","modified":0,"renderable":0},{"_id":"source/_posts/逆向工程/image-20240930190521829.png","slug":"image-20240930190521829.png","post":"cm6qr0i9n0005yokj2ijnasg0","modified":0,"renderable":0},{"_id":"source/_posts/逆向工程/image-20240930191508047.png","slug":"image-20240930191508047.png","post":"cm6qr0i9n0005yokj2ijnasg0","modified":0,"renderable":0}],"PostCategory":[],"PostTag":[{"post_id":"cm6qr0i9m0004yokjdhhhdjct","tag_id":"cm6qr0i9n0006yokj3kvmdmas","_id":"cm6qr0i9p0008yokje60jbc9i"},{"post_id":"cm6qr0i9n0005yokj2ijnasg0","tag_id":"cm6qr0i9n0006yokj3kvmdmas","_id":"cm6qr0i9p0009yokj5rni8jkr"}],"Tag":[{"name":"CTF文章","_id":"cm6qr0i9n0006yokj3kvmdmas"}]}}