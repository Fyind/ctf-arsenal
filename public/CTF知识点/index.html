<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"/><meta name="theme-color" content="#222"/><meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"/><meta name="renderer" content="webkit"/><link rel="icon" type="image/ico" sizes="32x32" href="/assets/favicon.ico"/><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"/><link rel="alternate" href="/rss.xml" title="Hexo" type="application/rss+xml"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml"><link rel="alternate" type="application/json" title="Hexo" href="https://cr4zyp1x3l.netlify.app/feed.json"/><link rel="preconnect" href="https://s4.zstatic.net"/><link rel="preconnect" href="https://at.alicdn.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CFredericka%20the%20Great:400,400italic,700,700italic%7CNoto%20Serif%20JP:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CInconsolata:400,400italic,700,700italic&display=swap&subset=latin,latin-ext" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="stylesheet" href="/css/app.css?v=0.4.20"><link rel="modulepreload" href="/js/chunk-3QGRG5LW.js"></link><link rel="modulepreload" href="/js/chunk-HLXPYW5A.js"></link><link rel="modulepreload" href="/js/chunk-TBM3W6J5.js"></link><link rel="modulepreload" href="/js/copy-tex-H35FYUA3.js"></link><link rel="modulepreload" href="/js/index.esm-YLWCV4AU.js"></link><link rel="modulepreload" href="/js/post-LY7JSYLG.js"></link><link rel="modulepreload" href="/js/quicklink-PPM66HVF.js"></link><link rel="modulepreload" href="/js/siteInit.js"></link><link rel="preload" href="https://tva1.sinaimg.cn/large/6833939bly1gicis3attqj20zk0m8k7l.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://tva1.sinaimg.cn/large/6833939bly1giciszlczyj20zk0m816d.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://tva1.sinaimg.cn/large/6833939bly1giciryrr3rj20zk0m8nhk.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://tva1.sinaimg.cn/large/6833939bly1gicis081o9j20zk0m8dmr.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://tva1.sinaimg.cn/large/6833939bly1gicitcxhpij20zk0m8hdt.jpg" as="image" fetchpriority="high"><link rel="preload" href="https://tva1.sinaimg.cn/large/6833939bly1gicit4jrvuj20zk0m8785.jpg" as="image" fetchpriority="high"><link rel="canonical" href="https://cr4zyp1x3l.netlify.app/CTF%E7%9F%A5%E8%AF%86%E7%82%B9/"><title>CTF知识点</title><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">CTF知识点</h1><div class="meta"><span class="item" title="Created: 2024-05-15 00:06:29"><span class="icon"><i class="ic i-calendar"></i></span><span class="text">Posted on</span><time itemprop="dateCreated datePublished" datetime="2024-05-15T00:06:29+02:00">2024-05-15</time></span><span class="item" title="Symbols count in article"><span class="icon"><i class="ic i-pen"></i></span><span class="text">Symbols count in article</span><span>19k</span><span class="text">words</span></span><span class="item" title="Reading time"><span class="icon"><i class="ic i-clock"></i></span><span class="text">Reading time</span><span>17 mins.</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="Toggle navigation bar"><span class="line"></span><span class="line"></span><span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">testName</a></li></ul><ul class="right" id="rightNav"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div class="pjax" id="imgs"><ul><li class="item" style="background-image: url(&quot;https://tva1.sinaimg.cn/large/6833939bly1gicis3attqj20zk0m8k7l.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://tva1.sinaimg.cn/large/6833939bly1giciszlczyj20zk0m816d.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://tva1.sinaimg.cn/large/6833939bly1giciryrr3rj20zk0m8nhk.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://tva1.sinaimg.cn/large/6833939bly1gicis081o9j20zk0m8dmr.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://tva1.sinaimg.cn/large/6833939bly1gicitcxhpij20zk0m8hdt.jpg&quot;);"></li><li class="item" style="background-image: url(&quot;https://tva1.sinaimg.cn/large/6833939bly1gicit4jrvuj20zk0m8785.jpg&quot;);"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"></use><use xlink:href="#gentle-wave" x="48" y="3"></use><use xlink:href="#gentle-wave" x="48" y="5"></use><use xlink:href="#gentle-wave" x="48" y="7"></use></g></svg></div><main><div class="inner"><div class="pjax" id="main"><div class="article wrap"><div class="breadcrumb" itemListElement itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i><span><a href="/">Home</a></span></div><article class="post block" itemscope="itemscope" itemtype="http://schema.org/Article" lang="en"><link itemprop="mainEntityOfPage" href="https://cr4zyp1x3l.netlify.app/CTF%E7%9F%A5%E8%AF%86%E7%82%B9/"/><span hidden="hidden" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="image" content="/assets/avatar.jpg"/><meta itemprop="name" content="John Doe"/><meta itemprop="description" content=", "/></span><span hidden="hidden" itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Hexo"/></span><div class="body md" itemprop="articleBody"><h3 id="知识点"><a class="anchor" href="#知识点">#</a> 知识点</h3>
<p><a target="_blank" rel="noopener" href="https://ctf101.org/web-exploitation/overview/">https://ctf101.org/web-exploitation/overview/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=5C-OtW7C5oU&amp;t=30s">https://www.youtube.com/watch?v=5C-OtW7C5oU&amp;t=30s</a></p>
<p><a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/flask">https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/flask</a></p>
<h3 id="练习网站"><a class="anchor" href="#练习网站">#</a> 练习网站</h3>
<p>buuctf</p>
<p><a target="_blank" rel="noopener" href="https://adworld.xctf.org.cn/">https://adworld.xctf.org.cn/</a></p>
<p><a target="_blank" rel="noopener" href="https://ctflearn.com/challenge/1/browse">https://ctflearn.com/challenge/1/browse</a></p>
<p><a target="_blank" rel="noopener" href="https://www.root-me.org/?lang=en">https://www.root-me.org/?lang=en</a></p>
<p><a target="_blank" rel="noopener" href="https://picoctf.org/">https://picoctf.org/</a></p>
<ol>
<li><a target="_blank" rel="noopener" href="http://tryhackme.com">tryhackme.com</a></li>
<li><a target="_blank" rel="noopener" href="http://hackthebox.eu">hackthebox.eu</a></li>
<li><a target="_blank" rel="noopener" href="http://overthewire.org">overthewire.org</a></li>
<li><a target="_blank" rel="noopener" href="http://Root-me.org">Root-me.org</a></li>
<li><a target="_blank" rel="noopener" href="http://Ringzer0team.com">Ringzer0team.com</a></li>
<li><a target="_blank" rel="noopener" href="http://Hack.me">Hack.me</a></li>
<li><a target="_blank" rel="noopener" href="http://ctftime.org">ctftime.org</a></li>
<li><a target="_blank" rel="noopener" href="http://picoctf.com">picoctf.com</a></li>
<li><a target="_blank" rel="noopener" href="http://ctf365.com">ctf365.com</a></li>
<li><a target="_blank" rel="noopener" href="http://ctf101.org">ctf101.org</a></li>
</ol>
<h3 id="虚拟机"><a class="anchor" href="#虚拟机">#</a> 虚拟机</h3>
<p>打开或关闭功能，打开 Hyper V, 然后重启</p>
<p>下载 kali 的 Hyper V 的 Hyper V 镜像。然后双击 bat 安装。然后就能打开了，点击连接就有 gui</p>
<h2 id="文件"><a class="anchor" href="#文件">#</a> 文件</h2>
<h3 id="图片文件处理"><a class="anchor" href="#图片文件处理">#</a> 图片文件处理</h3>
<p>打开图片</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>eog xxx.jpg</pre></td></tr></table></figure><h4 id="hexdump"><a class="anchor" href="#hexdump">#</a> hexdump</h4>
<p>hex 中查找 string</p>
<ul>
<li>pdf 里面找隐藏</li>
</ul>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>strings xxx.jpg <span class="token operator">|</span> <span class="token function">grep</span> CTFlearn </pre></td></tr><tr><td data-num="2"></td><td><pre>strings <span class="token parameter variable">-n</span> <span class="token number">10</span> xxx.jpg  <span class="token comment"># >= 10 长度的字符串</span></pre></td></tr></table></figure><p>hexdump</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>hexdump <span class="token parameter variable">-C</span> Pho.jpg <span class="token operator">|</span> <span class="token function">less</span></pre></td></tr></table></figure><p>python</p>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"TheMessage.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>res <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span> ch <span class="token keyword">in</span> <span class="token builtin">file</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	<span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">32</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>		res <span class="token operator">+=</span> <span class="token string">"0"</span></pre></td></tr><tr><td data-num="6"></td><td><pre>	<span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>		res <span class="token operator">+=</span> <span class="token string">"1"</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="binwalk"><a class="anchor" href="#binwalk">#</a> binwalk</h3>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>binwalk <span class="token parameter variable">--dd</span><span class="token operator">=</span>.* xx.jpeg <span class="token comment"># 查看所有隐藏的二进制，DD 可以顺便解压</span></pre></td></tr><tr><td data-num="2"></td><td><pre>binwalk <span class="token parameter variable">-e</span> xx.jpg <span class="token comment"># 提取文件</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">file</span> * <span class="token comment"># 查看当前目录所有文件类型</span></pre></td></tr><tr><td data-num="4"></td><td><pre>exiftool xx.jpg <span class="token comment"># 查看更多信息，有 file 里面没有显示完全的</span></pre></td></tr></table></figure><h4 id="stegehide"><a class="anchor" href="#stegehide">#</a> stegehide</h4>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>steghide extract <span class="token parameter variable">-sf</span> xx.jpg</pre></td></tr></table></figure><h3 id="二维码"><a class="anchor" href="#二维码">#</a> 二维码</h3>
<p>显示二维码</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> zbar-tools</pre></td></tr><tr><td data-num="2"></td><td><pre>zbarimg xx.png</pre></td></tr></table></figure><p>python</p>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> cv2</pre></td></tr><tr><td data-num="2"></td><td><pre>img <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">"qr.png"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>det <span class="token operator">=</span> cv2<span class="token punctuation">.</span>QRCodeDetector<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>data<span class="token punctuation">,</span> box<span class="token punctuation">,</span> b <span class="token operator">=</span> det<span class="token punctuation">.</span>detectAndDecode<span class="token punctuation">(</span>img<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="python"><a class="anchor" href="#python">#</a> python</h2>
<h3 id="string"><a class="anchor" href="#string">#</a> string</h3>
<p>所有可打印字符</p>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre>string<span class="token punctuation">.</span>printable</pre></td></tr></table></figure><h3 id="提取flag"><a class="anchor" href="#提取flag">#</a> 提取 flag</h3>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> re</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">def</span> <span class="token function">extract_flag_from_string</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'flag\&#123;[^&#125;]+&#125;'</span><span class="token punctuation">,</span> string<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">return</span> <span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token keyword">match</span> <span class="token keyword">else</span> <span class="token boolean">None</span></pre></td></tr></table></figure><h3 id="crypto"><a class="anchor" href="#crypto">#</a> Crypto</h3>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre>pip install pycryptodome</pre></td></tr></table></figure><h4 id="计算两个byte的xor"><a class="anchor" href="#计算两个byte的xor">#</a> 计算两个 byte 的 xor</h4>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">xor</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">return</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">[</span>x <span class="token operator">^</span> y <span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="urlencode"><a class="anchor" href="#urlencode">#</a> urlencode</h3>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># 字典格式的数</span></pre></td></tr><tr><td data-num="3"></td><td><pre>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'张三'</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">25</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 使用 urlencode 进行编码</span></pre></td></tr><tr><td data-num="5"></td><td><pre>encoded_data <span class="token operator">=</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>urlencode<span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>encoded_data<span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="git"><a class="anchor" href="#git">#</a> Git</h2>
<p>查看历史 log</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">git</span> log</pre></td></tr></table></figure><p>查看 commit 改变了什么</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">git</span> show</pre></td></tr></table></figure><h2 id="linux"><a class="anchor" href="#linux">#</a> Linux</h2>
<h4 id="解压"><a class="anchor" href="#解压">#</a> 解压</h4>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">unzip</span> x.zip</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">unrar</span> x x.rar</pre></td></tr></table></figure><h3 id="查看ls"><a class="anchor" href="#查看ls">#</a> 查看 ls</h3>
<p>打印所有文件夹内容</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">ls</span> <span class="token parameter variable">-la</span> *</pre></td></tr></table></figure><p>查找</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">find</span> / <span class="token parameter variable">-name</span> *.txt</pre></td></tr></table></figure><h1 id="密码学"><a class="anchor" href="#密码学">#</a> 密码学</h1>
<p>online 的工具</p>
<p><a target="_blank" rel="noopener" href="https://gchq.github.io/CyberChef/">https://gchq.github.io/CyberChef/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.dcode.fr/en">https://www.dcode.fr/en</a></p>
<p>加密</p>
<p><a target="_blank" rel="noopener" href="https://www.boxentriq.com/code-breaking/cipher-identifier">https://www.boxentriq.com/code-breaking/cipher-identifier</a></p>
<h3 id="2进制到hex"><a class="anchor" href="#2进制到hex">#</a> 2 进制到 hex</h3>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre>x <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>bc<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span></pre></td></tr></table></figure><h4 id="hex转换"><a class="anchor" href="#hex转换">#</a> hex 转换</h4>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> binascii <span class="token keyword">import</span> unhexlify</pre></td></tr><tr><td data-num="2"></td><td><pre>hexstr <span class="token operator">=</span> <span class="token string">"41 42 43 54 46 7B 34 35 43 31 31 5F 31 35 5F 55 35 33 46 55 4C 7D"</span></pre></td></tr><tr><td data-num="3"></td><td><pre>hexs <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>hexstr<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>unhexlify<span class="token punctuation">(</span>hexs<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="输入bytes"><a class="anchor" href="#输入bytes">#</a> 输入 bytes</h4>
<figure class="highlight cpp"><figcaption data-lang="C++"><span>p</span></figcaption><table><tr><td data-num="1"></td><td><pre>s <span class="token operator">=</span> <span class="token string">"f\nk\fw&amp;O.@\x11x\rZ;U\x11p\x19F\x1Fv\"M"</span></pre></td></tr><tr><td data-num="2"></td><td><pre>a <span class="token operator">=</span> <span class="token function">bytearray</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="字符串转换字符数组"><a class="anchor" href="#字符串转换字符数组">#</a> 字符串转换字符数组</h4>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre>char_array <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">"your_string"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>string <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>char_array<span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="交换大小写"><a class="anchor" href="#交换大小写">#</a> 交换大小写</h4>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token string">"asb"</span><span class="token punctuation">.</span>swapcase<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><code>c.isalpha()</code> ：判断  <code>c</code>  是否是字母。</p>
<p><code>c.isupper()</code> ：判断  <code>c</code>  是否是大写字母。</p>
<p><code>c.islower()</code> ：判断  <code>c</code>  是否是小写字母</p>
<h3 id="base64"><a class="anchor" href="#base64">#</a> base64</h3>
<p>shell</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>base64 <span class="token parameter variable">-d</span> xxx</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token builtin class-name">echo</span> <span class="token string">"c3ludCB2ZiA6IGEwX29icWxfczBldHJnX2RlX3BicXI="</span> <span class="token operator">|</span> base64 <span class="token parameter variable">-d</span></pre></td></tr></table></figure><p>python</p>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> base64 <span class="token keyword">import</span> decodebytes</pre></td></tr><tr><td data-num="2"></td><td><pre>s <span class="token operator">=</span> decodebytes<span class="token punctuation">(</span><span class="token string">"Q1RGe0ZsYWdneVdhZ2d5UmFnZ3l9"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span></pre></td></tr></table></figure><p>cyberchef 的 label 和 jump 可以实现循环解密</p>
<p>原理：</p>
<p><strong>将二进制数据转换为 6 位块：</strong></p>
<ul>
<li>每个字节有 8 位，3 个字节一共是 24 位。</li>
<li>将这 24 位拆分为 4 个 6 位的块。</li>
</ul>
<p><strong>将 6 位的数据映射到 Base64 字符表：</strong></p>
<ul>
<li><code>A-Za-z0-9+/</code></li>
</ul>
<p>如果输入数据的字节数不是 3 的倍数，编码过程会用  <code>=</code>  字符进行填充，使输出数据的长度是 4 字节的倍数。</p>
<p>在后面每次填一个 byte (0) 直到是 3 的倍数，然后 base64 加密，最后把由加入新 0 产生的 A 换成 = 就好了</p>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">b64en</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> table<span class="token operator">=</span><span class="token string">"default"</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">if</span> table <span class="token operator">==</span> <span class="token string">"default"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        table <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>            table <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>            table <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>            table <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        table <span class="token operator">+=</span> <span class="token string">"+/"</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    s <span class="token operator">=</span> s<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    lens <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    s <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>s<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    s <span class="token operator">=</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  </pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">&lt;</span> lens<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        s <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> s</pre></td></tr><tr><td data-num="18"></td><td><pre>    needed <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        s <span class="token operator">+=</span> <span class="token string">"00000000"</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        needed <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>    s <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span><span class="token builtin">list</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    i <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">while</span> i <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        x <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            x <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> s<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        ans<span class="token punctuation">.</span>append<span class="token punctuation">(</span>table<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        i <span class="token operator">+=</span> <span class="token number">6</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>needed<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        ans<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>needed<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        ans <span class="token operator">+=</span> <span class="token string">"="</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>ans<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">def</span> <span class="token function">b64de</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> table<span class="token operator">=</span><span class="token string">"default"</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token keyword">if</span> table <span class="token operator">==</span> <span class="token string">"default"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        table <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="42"></td><td><pre>            table <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="44"></td><td><pre>            table <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="46"></td><td><pre>            table <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        table <span class="token operator">+=</span> <span class="token string">"+/"</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    s <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    needed <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token keyword">while</span> s<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"="</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        s<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        needed <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>needed<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="54"></td><td><pre>        s <span class="token operator">+=</span> table<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    a <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="57"></td><td><pre>        x <span class="token operator">=</span> table<span class="token punctuation">.</span>index<span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="58"></td><td><pre>        </pre></td></tr><tr><td data-num="59"></td><td><pre>        toa <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="60"></td><td><pre>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="61"></td><td><pre>            <span class="token keyword">if</span> x<span class="token operator">>></span>j<span class="token operator">&amp;</span><span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="62"></td><td><pre>                toa <span class="token operator">=</span> <span class="token string">"1"</span> <span class="token operator">+</span> toa</pre></td></tr><tr><td data-num="63"></td><td><pre>            <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="64"></td><td><pre>                toa <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">+</span> toa</pre></td></tr><tr><td data-num="65"></td><td><pre>        </pre></td></tr><tr><td data-num="66"></td><td><pre>        a <span class="token operator">+=</span> toa</pre></td></tr><tr><td data-num="67"></td><td><pre></pre></td></tr><tr><td data-num="68"></td><td><pre>    a <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span><span class="token builtin">list</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="69"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>needed<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="70"></td><td><pre>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="71"></td><td><pre>            a<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="72"></td><td><pre>    i <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="73"></td><td><pre>    ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="74"></td><td><pre>    <span class="token keyword">while</span> i <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="75"></td><td><pre>        x <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="76"></td><td><pre>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="77"></td><td><pre>            x <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">&lt;&lt;</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> a<span class="token punctuation">[</span>i<span class="token operator">+</span>j<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="78"></td><td><pre>        ans<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="79"></td><td><pre>        i <span class="token operator">+=</span> <span class="token number">8</span></pre></td></tr><tr><td data-num="80"></td><td><pre></pre></td></tr><tr><td data-num="81"></td><td><pre>    ans <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>ans<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="82"></td><td><pre>    <span class="token keyword">return</span> ans</pre></td></tr></table></figure><h4 id="dtmf-声调"><a class="anchor" href="#dtmf-声调">#</a> DTMF 声调</h4>
<p><a target="_blank" rel="noopener" href="https://dtmf.netlify.app/">https://dtmf.netlify.app/</a></p>
<h2 id="不同种类的密码"><a class="anchor" href="#不同种类的密码">#</a> 不同种类的密码</h2>
<h4 id="vigenere-cipher"><a class="anchor" href="#vigenere-cipher">#</a> Vigenere Cipher</h4>
<p>一种凯撒密码</p>
<p>key 是  <code>OCU</code>  那么第一个字符被移动了 O (14) 次，第二个字符被移动了  <code>C</code>  (2) 次</p>
<h4 id="caesar-cipher"><a class="anchor" href="#caesar-cipher">#</a> CAESAR Cipher</h4>
<p>在线暴力破解</p>
<p><a target="_blank" rel="noopener" href="https://www.dcode.fr/caesar-cipher">https://www.dcode.fr/caesar-cipher</a></p>
<h4 id="keyboard-shift"><a class="anchor" href="#keyboard-shift">#</a> keyboard shift</h4>
<p><code>BUH'tdy,|Bim5y~Bdt76yQ</code>  长这样，有可能下划线不被解密</p>
<p><a target="_blank" rel="noopener" href="https://www.dcode.fr/keyboard-shift-cipher">https://www.dcode.fr/keyboard-shift-cipher</a></p>
<h4 id="bacon-cipher"><a class="anchor" href="#bacon-cipher">#</a> bacon cipher</h4>
<h4 id="与佛论禅"><a class="anchor" href="#与佛论禅">#</a> 与佛论禅</h4>
<p><a target="_blank" rel="noopener" href="https://www.keyfc.net/bbs/tools/tudoucode.aspx">https://www.keyfc.net/bbs/tools/tudoucode.aspx</a></p>
<p>密语是 <code>佛曰：</code>  开头的</p>
<h4 id="rot13"><a class="anchor" href="#rot13">#</a> rot13</h4>
<p><a target="_blank" rel="noopener" href="https://www.rot13.de/index.php">https://www.rot13.de/index.php</a></p>
<h3 id="enigma-cryptogarphy"><a class="anchor" href="#enigma-cryptogarphy">#</a> enigma cryptogarphy</h3>
<p><a target="_blank" rel="noopener" href="https://cryptii.com/pipes/enigma-machine">https://cryptii.com/pipes/enigma-machine</a></p>
<h4 id="playfair-cipher"><a class="anchor" href="#playfair-cipher">#</a> Playfair cipher</h4>
<p>通常有一个表格表示密钥</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnalign="left left left left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Q</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>W</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>E</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>R</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>T</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Y</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>U</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>I</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>O</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>P</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>A</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>S</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>D</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>F</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>G</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>H</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>K</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>L</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>Z</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>X</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>C</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>V</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>N</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>M</mi></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{lllll}
Q &amp; W &amp; E &amp; R &amp; T \\
Y &amp; U &amp; I &amp; O &amp; P \\
A &amp; S &amp; D &amp; F &amp; G \\
H &amp; K &amp; L &amp; Z &amp; X \\
C &amp; V &amp; B &amp; N &amp; M
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6em;vertical-align:-2.75em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">Q</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">A</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">L</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">G</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span><span style="top:-0.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.75em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span></span></span></span></span></p>
<p><a target="_blank" rel="noopener" href="https://www.boxentriq.com/code-breaking/playfair-cipher">https://www.boxentriq.com/code-breaking/playfair-cipher</a></p>
<h3 id="brute-force"><a class="anchor" href="#brute-force">#</a> brute force</h3>
<p>暴力 key 的长度，然后暴力，使得 xor 后的 string 有  <code>flag</code></p>
<h4 id="sha1"><a class="anchor" href="#sha1">#</a> sha1</h4>
<p>这个里面的  <code>0x8004u</code>  就是 sha1 加密的标志</p>
<p><a target="_blank" rel="noopener" href="http://www.ttmd5.com/hash.php?type=5">http://www.ttmd5.com/hash.php?type=5</a></p>
<h4 id="md5"><a class="anchor" href="#md5">#</a> Md5</h4>
<p>这个里面的  <code>0x8003u</code>  就是 sha1 加密的标志</p>
<p><a target="_blank" rel="noopener" href="https://hashes.com/en/decrypt/hash">https://hashes.com/en/decrypt/hash</a></p>
<p><a target="_blank" rel="noopener" href="https://md5.gromweb.com/?md5=b74dec4f39d35b6a2e6c48e637c8aedb">https://md5.gromweb.com/?md5=b74dec4f39d35b6a2e6c48e637c8aedb</a></p>
<p><a target="_blank" rel="noopener" href="https://www.somd5.com/">https://www.somd5.com/</a></p>
<p>可以直接 google MD5 值，看有没有解密</p>
<h3 id="discrete-logarithm"><a class="anchor" href="#discrete-logarithm">#</a> Discrete logarithm</h3>
<p>如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> 的质数分解比较小，那么可以解出来</p>
<p><a target="_blank" rel="noopener" href="https://github.com/idekctf/idekctf-2024/blob/main/crypto/goldenticket/debug/solve.py">https://github.com/idekctf/idekctf-2024/blob/main/crypto/goldenticket/debug/solve.py</a></p>
<p>sage 有一个函数  <code>discrete_log_lambda</code>  可以对一个区间计算答案，复杂度是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msqrt><mrow><mi>l</mi><mi>e</mi><mi>n</mi></mrow></msqrt><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\sqrt{len})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1822em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span></span></span><span style="top:-2.8922em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewbox="0 0 400000 1080" preserveaspectratio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1078em;"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 级别，之后再用 CRT 合并出大答案</p>
<figure class="highlight py"><figcaption data-lang="Python"><span>y</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">PH_partial</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> g<span class="token punctuation">,</span> p<span class="token punctuation">,</span> fact_phi<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token triple-quoted-string string">"""Returns (x, m), where</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    - x is the dlog of h in base g, mod m</pre></td></tr><tr><td data-num="4"></td><td><pre>    - m = lcm(pi^ei) for (pi, ei) in fact_phi</pre></td></tr><tr><td data-num="5"></td><td><pre>    """</pre></td></tr><tr><td data-num="6"></td><td><pre>    res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    mod <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    F <span class="token operator">=</span> GF<span class="token punctuation">(</span>p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    phi <span class="token operator">=</span> p<span class="token operator">-</span><span class="token number">1</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">for</span> pi<span class="token punctuation">,</span> ei <span class="token keyword">in</span> fact_phi<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        gi <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> phi<span class="token operator">//</span><span class="token punctuation">(</span>pi<span class="token operator">**</span>ei<span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        hi <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> phi<span class="token operator">//</span><span class="token punctuation">(</span>pi<span class="token operator">**</span>ei<span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        xi <span class="token operator">=</span> discrete_log_lambda<span class="token punctuation">(</span>F<span class="token punctuation">(</span>hi<span class="token punctuation">)</span><span class="token punctuation">,</span> F<span class="token punctuation">(</span>gi<span class="token punctuation">)</span><span class="token punctuation">,</span> bounds <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> pi<span class="token operator">**</span>ei<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        res<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>xi<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        mod<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>pi<span class="token operator">**</span>ei<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>    x<span class="token punctuation">,</span> m <span class="token operator">=</span> CRT<span class="token punctuation">(</span>res<span class="token punctuation">,</span> mod<span class="token punctuation">)</span><span class="token punctuation">,</span> lcm<span class="token punctuation">(</span>mod<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">assert</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> x <span class="token operator">*</span> phi<span class="token operator">//</span>m<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> phi<span class="token operator">//</span>m<span class="token punctuation">,</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">return</span> x<span class="token punctuation">,</span> m</pre></td></tr></table></figure><h1 id="web"><a class="anchor" href="#web">#</a> Web</h1>
<h4 id="信息收集"><a class="anchor" href="#信息收集">#</a> 信息收集</h4>
<p>从 HTTP 头中的 Server 字段可以了解用了什么服务器</p>
<p>敏感目录：</p>
<ul>
<li><code>.git</code></li>
<li><code>svn</code></li>
<li><code>idea</code></li>
</ul>
<p>工具</p>
<ul>
<li>dirsearch</li>
<li>ffuf</li>
</ul>
<h3 id="sql-注入"><a class="anchor" href="#sql-注入">#</a> SQL 注入</h3>
<h4 id="数字型注入"><a class="anchor" href="#数字型注入">#</a> 数字型注入</h4>
<p><code>?id=1</code>  和  <code>?id=2-1</code>  是一样的</p>
<h2 id="pwn"><a class="anchor" href="#pwn">#</a> PWN</h2>
<h4 id="pwn-tool"><a class="anchor" href="#pwn-tool">#</a> pwn tool</h4>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>pip <span class="token function">install</span> pwmtools</pre></td></tr></table></figure><h4 id="recv"><a class="anchor" href="#recv">#</a> recv</h4>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre>con<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"ready? Y/N : "</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>con<span class="token punctuation">.</span>recvline_startswith<span class="token punctuation">(</span><span class="token string">"Computer"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 一直到有一个符合的</span></pre></td></tr><tr><td data-num="3"></td><td><pre>con<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="send"><a class="anchor" href="#send">#</a> send</h4>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre>con<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'Y'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="连接"><a class="anchor" href="#连接">#</a> 连接</h4>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> pwn</pre></td></tr><tr><td data-num="2"></td><td><pre>con <span class="token operator">=</span> pwn<span class="token punctuation">.</span>remote<span class="token punctuation">(</span><span class="token string">"thekidofarcrania.com"</span><span class="token punctuation">,</span> <span class="token number">10001</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>s <span class="token operator">=</span> con<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"ready? Y/N : "</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="post-request"><a class="anchor" href="#post-request">#</a> Post Request</h3>
<h4 id="curl"><a class="anchor" href="#curl">#</a> curl</h4>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">curl</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-d</span> <span class="token string">"username=admin&amp;password=71urlkufpsdnlkadsf"</span> http://165.227.106.113/post.php</pre></td></tr></table></figure><h3 id="burpsuite"><a class="anchor" href="#burpsuite">#</a> Burpsuite</h3>
<p>install</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> burpsuite</pre></td></tr></table></figure><p>打开之后点 Proxy, 然后点 intercept on, 然后 open browser 打开连接就可以获得对应的请求</p>
<h4 id="header"><a class="anchor" href="#header">#</a> header</h4>
<p>可以右键发送到 repeater 里面</p>
<p>然后在里面改 header</p>
<h4 id="referer"><a class="anchor" href="#referer">#</a> referer</h4>
<p>表示从哪里来的</p>
<figure class="highlight html"><figcaption data-lang="HTML"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>Referer:awesomesauce.com</pre></td></tr></table></figure><h4 id="python插件"><a class="anchor" href="#python插件">#</a> python 插件</h4>
<p>Repeater 里面右键，extension，里面可以复制为 python 的 request</p>
<h3 id="开发者工具"><a class="anchor" href="#开发者工具">#</a> 开发者工具</h3>
<h4 id="storage"><a class="anchor" href="#storage">#</a> Storage</h4>
<p>可以看到存储的信息</p>
<h2 id="网站"><a class="anchor" href="#网站">#</a> 网站</h2>
<h3 id="robotstxt"><a class="anchor" href="#robotstxt">#</a>  <code>robots.txt</code></h3>
<p>去网站的 <a target="_blank" rel="noopener" href="https://ctflearn.com/robots.txt">https://ctflearn.com/robots.txt</a> 可以看到不允许的网页</p>
<h4 id="wikipedia"><a class="anchor" href="#wikipedia">#</a> wikipedia</h4>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/">https://en.wikipedia.org/</a></p>
<p>用 diff 可以看到修改的信息</p>
<h4 id="备份文件名"><a class="anchor" href="#备份文件名">#</a> 备份文件名</h4>
<p><code>.git .svn .swp .svn .~ .bak .bash_history</code></p>
<h3 id="dirsearch"><a class="anchor" href="#dirsearch">#</a> dirsearch</h3>
<p>可以看网页的目录</p>
<p><a target="_blank" rel="noopener" href="https://github.com/maurosoria/dirsearch">https://github.com/maurosoria/dirsearch</a></p>
<h4 id="更改网页源代码"><a class="anchor" href="#更改网页源代码">#</a> 更改网页源代码</h4>
<p>可以把 disable 的按钮改成可以按下去</p>
<p>用 hackbar 可以发送 post 请求</p>
<h4 id="查找网站的隐藏连接"><a class="anchor" href="#查找网站的隐藏连接">#</a> 查找网站的隐藏连接</h4>
<h4 id="gobuster"><a class="anchor" href="#gobuster">#</a> gobuster</h4>
<h4 id="查找历史网页状态"><a class="anchor" href="#查找历史网页状态">#</a> 查找历史网页状态</h4>
<p>wayback machinehttps://web.archive.org/</p>
<h2 id="php"><a class="anchor" href="#php">#</a> PHP</h2>
<h4 id="判断相等"><a class="anchor" href="#判断相等">#</a> 判断相等</h4>
<p><code>==, &gt;</code>  是弱类型判断，会先转换类型再判断，所以  <code>a=123abc</code>  会变成  <code>123</code></p>
<h4 id="反序列化"><a class="anchor" href="#反序列化">#</a> 反序列化</h4>
<p>序列化：把对象转成字符串存储。反序列化：把字符串转成对象</p>
<p><code>__wakeup()</code>  是在序列化的时候执行的</p>
<pre><code class="language-php+HTML">&lt;?php 
class xctf&#123;
public $flag = '111';
public function __wakeup()&#123;
exit('bad requests');
&#125;
&#125;
$a = new xctf();
$c = serialize($a);
echo $c
?&gt; 
</code></pre>
<p>输出是  <code>O:4:&quot;xctf&quot;:1:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code>  现在要绕过这个 exit 方法，改成 2 就行</p>
<h4 id="think-php-rce"><a class="anchor" href="#think-php-rce">#</a> THINK PHP RCE</h4>
<p>RCE 是 remote code execution，在 github 上搜索 think php5 可以找到漏洞</p>
<h3 id="文件上传"><a class="anchor" href="#文件上传">#</a> 文件上传</h3>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xhds/p/12218471.html">https://www.cnblogs.com/xhds/p/12218471.html</a></p>
<h1 id="misc"><a class="anchor" href="#misc">#</a> misc</h1>
<h4 id="在线工具"><a class="anchor" href="#在线工具">#</a> 在线工具</h4>
<p><a target="_blank" rel="noopener" href="https://www.ilovepdf.com/zh-cn">https://www.ilovepdf.com/zh-cn</a> , <a target="_blank" rel="noopener" href="https://pdf2doc.com/">https://pdf2doc.com/</a> PDF 转换</p>
<p><a target="_blank" rel="noopener" href="https://georgeom.net/StegOnline/checklist">https://georgeom.net/StegOnline/checklist</a> checklist steg</p>
<h3 id="隐写术"><a class="anchor" href="#隐写术">#</a> 隐写术</h3>
<h4 id="文件附加"><a class="anchor" href="#文件附加">#</a> 文件附加</h4>
<h4 id="png"><a class="anchor" href="#png">#</a> PNG</h4>
<p>开头是</p>
<figure class="highlight text"><figcaption data-lang="text"><span>t</span></figcaption><table><tr><td data-num="1"></td><td><pre>89 50 4E 47 0D 0A 1A 0A</pre></td></tr></table></figure><p>IEND 是</p>
<figure class="highlight text"><figcaption data-lang="text"><span>t</span></figcaption><table><tr><td data-num="1"></td><td><pre>00 00 00 00 49 45 4E AE 42 60 82</pre></td></tr></table></figure><p>查看 metadata 在 linux 上:</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>exiftool xxx.png</pre></td></tr></table></figure><h4 id="jpeg"><a class="anchor" href="#jpeg">#</a> JPEG</h4>
<ul>
<li>头  <code>FF D8 FF</code></li>
<li>尾  <code>FF D9</code></li>
</ul>
<h4 id="gif"><a class="anchor" href="#gif">#</a> GIF</h4>
<p>拆分图片工具：stegsolve 分离图片（先 open 再 analyse-frame browser）</p>
<ul>
<li><code>47 49 46 38</code></li>
<li><code>00 3B</code></li>
</ul>
<h4 id="zip"><a class="anchor" href="#zip">#</a> ZIP</h4>
<ul>
<li><code>50 4B 03 04</code></li>
<li><code>50 4B</code></li>
</ul>
<h4 id="rar"><a class="anchor" href="#rar">#</a> RAR</h4>
<ul>
<li><code>52 61 72 21</code></li>
</ul>
<h4 id="wave"><a class="anchor" href="#wave">#</a> WAVE</h4>
<ul>
<li><code>57 41 56 45</code></li>
</ul>
<h4 id="avi"><a class="anchor" href="#avi">#</a> AVI</h4>
<ul>
<li><code>41 56 49 20</code></li>
</ul>
<h3 id="lsb"><a class="anchor" href="#lsb">#</a> LSB</h3>
<p>Least significant bit 在图片的最低有效位上写入信息</p>
<p>Stegsolve , zsteg 工具可以识别</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> zsteg</pre></td></tr><tr><td data-num="2"></td><td><pre>zsteg cats.png</pre></td></tr><tr><td data-num="3"></td><td><pre>zsteg xx.bmp <span class="token parameter variable">-b</span> <span class="token number">1</span> <span class="token parameter variable">-a</span> yx <span class="token parameter variable">-v</span></pre></td></tr></table></figure><p>python 脚本</p>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> bitarray <span class="token keyword">import</span> bitarray</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> cv2</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">LSBtoBytes</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token comment"># index 0,1,2 = r,g,b</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    im <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>path<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">for</span> row <span class="token keyword">in</span> im<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token keyword">for</span> col <span class="token keyword">in</span> row<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>col<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">return</span> bitarray<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>tobytes<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">def</span> <span class="token function">LSBtoImg</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    im <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>path<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">for</span> i<span class="token punctuation">,</span>row <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>im<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token keyword">for</span> j<span class="token punctuation">,</span>col <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            <span class="token keyword">if</span> col<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">1</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>                im<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">,</span><span class="token number">255</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>                im<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token comment"># cv2.imwrite("out.png",im)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">return</span> im</pre></td></tr></table></figure><p>LSB 可能 RG， GB 之类的组合使用</p>
<h4 id="隐写思路"><a class="anchor" href="#隐写思路">#</a> 隐写思路</h4>
<ul>
<li>
<p>图片结构改变： 结尾加东西， <code>zsteg</code></p>
<p>提取文件：  <code>zsteg -e &quot;b1,rgb,lsb,xy&quot; xx.png &gt; flag.png</code></p>
<p>Chunks 改变：用  <code>pngcheck</code>  检查</p>
</li>
<li>
<p>LSB 隐写： 对应工具</p>
</li>
</ul>
<h3 id="盲水印"><a class="anchor" href="#盲水印">#</a> 盲水印</h3>
<p>在不同与域上隐藏信息，在图片傅里叶变换后。把信息添加到 “噪声” 中，再逆变换回去就不会对原图片产生大变化</p>
<p>工具:  <code>BlindWaterMark</code></p>
<h4 id="现成的隐写工具"><a class="anchor" href="#现成的隐写工具">#</a> 现成的隐写工具</h4>
<ul>
<li>
<p>Jphide: JPG</p>
</li>
<li>
<p>Outguess: JPG</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>outguess <span class="token parameter variable">-k</span> <span class="token string">"key"</span> <span class="token parameter variable">-r</span> file.jpg out.txt <span class="token comment"># decode</span></pre></td></tr></table></figure></li>
<li>
<p>Steghide: support for JPEG, BMP, WAV and AU files</p>
</li>
<li>
<p>F5-steganography: BMP, GIF, or JPEG</p>
</li>
<li>
<p>invisible secrets</p>
</li>
<li>
<p>wbs43open</p>
</li>
<li>
<p>stegosuite</p>
</li>
<li>
<p>cloacked-pixel</p>
</li>
<li>
<p>Slient-Eye</p>
</li>
</ul>
<p>暴力工具</p>
<p><code>DominicBreuker/stego-toolkit</code></p>
<h3 id="压缩文件"><a class="anchor" href="#压缩文件">#</a> 压缩文件</h3>
<h4 id="zip-文件"><a class="anchor" href="#zip-文件">#</a> ZIP 文件</h4>
<ul>
<li>数据区 (504B0304)
<ul>
<li>解压要的版本</li>
<li>flags</li>
<li>压缩算法</li>
<li>文件修改时间</li>
<li>CRC32</li>
<li>压缩前与后大小</li>
<li>文件名长度和内容</li>
<li>文件数据</li>
</ul>
</li>
<li>核心目录区 (504B0102)</li>
<li>核心目录结束区 (504B0506)</li>
</ul>
<h4 id="pdf-文件"><a class="anchor" href="#pdf-文件">#</a> PDF 文件</h4>
<p>可能藏在图片后面，转 word 或者全选可以看</p>
<h4 id="rar-文件"><a class="anchor" href="#rar-文件">#</a> RAR 文件</h4>
<p><code>RAR &lt;=4</code>  的签名  <code>5261172211A0700</code></p>
<p><code>RAR5</code>  的签名  <code>526172211A070100</code></p>
<h4 id="暴力破解工具"><a class="anchor" href="#暴力破解工具">#</a> 暴力破解工具</h4>
<p>windows: ARCHPR</p>
<p>Linux: fcrackzip, RarCrack</p>
<p>也可以通过爆破 CRC32 来获得</p>
<p><code>zip-crc-cracker</code>  ， <code>crc32</code></p>
<h4 id="伪加密"><a class="anchor" href="#伪加密">#</a> 伪加密</h4>
<p>ZIP 里面有个通用标记位</p>
<p>距离  <code>504B0102</code>  偏移 8 byte, 本身占 2 byte，最低位标识是否被加密。只要改回 0 就可以正常打开</p>
<p>RAR 里面也有</p>
<p>HeadFlags 从低位起第 3bit 是，但是要重新计算 CRC ( <code>HEAD_CRC</code> )</p>
<h4 id="zip-明文攻击"><a class="anchor" href="#zip-明文攻击">#</a> ZIP 明文攻击</h4>
<p>知道内容一些字节可以用，要先确认把呢不能</p>
<p>可以用  <code>ARCHPR</code>  , 非完整明文  <code>bkcrack</code></p>
<h3 id="音频隐写"><a class="anchor" href="#音频隐写">#</a> 音频隐写</h3>
<h4 id="工具"><a class="anchor" href="#工具">#</a> 工具</h4>
<ul>
<li>audacity 查看音频</li>
</ul>
<h3 id="流量分析"><a class="anchor" href="#流量分析">#</a> 流量分析</h3>
<p>Wireshark</p>
<p>统计里面，协议分级可以看流量包的比例</p>
<p>会话里面会有地址</p>
<p>过滤器</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>ip.src <span class="token operator">==</span> xxx.xx.xx.xx</pre></td></tr></table></figure><p>也可以右键作为过滤器应用</p>
<h4 id="http"><a class="anchor" href="#http">#</a> HTTP</h4>
<p>明文传输的</p>
<h4 id="https"><a class="anchor" href="#https">#</a> HTTPS</h4>
<p>添加 TLS，要导入密钥才能看到内容</p>
<h4 id="ftp"><a class="anchor" href="#ftp">#</a> FTP</h4>
<p>20，21 端口</p>
<h4 id="dns"><a class="anchor" href="#dns">#</a> DNS</h4>
<p>解析网址</p>
<h3 id="usb流量分析"><a class="anchor" href="#usb流量分析">#</a> USB 流量分析</h3>
<p>通过 USB 协议传输，从一个地址发送到 host</p>
<p>键盘是 8 字节，鼠标是 4 字节</p>
<ul>
<li>第一个字节是按键按下
<ul>
<li><code>00</code>  没有按下， <code>01</code>  按左键， <code>02</code>  按右键</li>
</ul>
</li>
<li>第二个字节是左右偏移
<ul>
<li>正是向右移动  <code>n</code>  个像素位</li>
</ul>
</li>
<li>第三个字节是上下偏移
<ul>
<li>正是向上移动</li>
</ul>
</li>
</ul>
<p>键盘流量</p>
<ul>
<li>Byte1：控制信息
<ul>
<li><code>[Right gui,Right alt,Right shift,Right control,Left Gui,Left Alt,left shift,Left Control]</code></li>
</ul>
</li>
<li>byte3：击键信息</li>
</ul>
<h3 id="wireshark"><a class="anchor" href="#wireshark">#</a> wireshark</h3>
<p>提取流量数据</p>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> pyshark</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> pyshark<span class="token punctuation">.</span>packet</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> binascii <span class="token keyword">import</span> unhexlify</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>capture <span class="token operator">=</span> pyshark<span class="token punctuation">.</span>FileCapture<span class="token punctuation">(</span><span class="token string">'justapcap.pcap'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>hexstr <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="7"></td><td><pre>cnt <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">for</span> packet <span class="token keyword">in</span> capture<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    s <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>packet<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    cur <span class="token operator">=</span> s<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"Name:"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"1m "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    hexstr <span class="token operator">+=</span> cur</pre></td></tr><tr><td data-num="12"></td><td><pre>hexstr <span class="token operator">=</span> hexstr<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"exam"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"a.png"</span><span class="token punctuation">,</span><span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>unhexlify<span class="token punctuation">(</span>hexstr<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="内存取证"><a class="anchor" href="#内存取证">#</a> 内存取证</h3>
<h4 id="volatility"><a class="anchor" href="#volatility">#</a> volatility</h4>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">sudo</span> snap <span class="token function">install</span> volatility-phocean</pre></td></tr></table></figure><h4 id="确定信息"><a class="anchor" href="#确定信息">#</a> 确定信息</h4>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>vol.py <span class="token parameter variable">-f</span> memory imageinfo</pre></td></tr></table></figure><p>psxview 查看内存</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>vol.py <span class="token parameter variable">-f</span> memory <span class="token parameter variable">--profile</span><span class="token operator">=</span>Win7SPx86 psxview</pre></td></tr></table></figure><p>pslist 查看运行的进程</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>volatility <span class="token parameter variable">-f</span> mem.mem <span class="token parameter variable">--profile</span><span class="token operator">=</span>Win10x64_1231 pslist</pre></td></tr></table></figure><p>filescan 是打开的文件对象</p>
<p>dumpfile</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>vol.py <span class="token parameter variable">-f</span> memory <span class="token parameter variable">--profile</span><span class="token operator">=</span>Win7SPx86 prodump <span class="token parameter variable">-p</span> <span class="token number">1384</span> --dump-dir ./dump/</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">file</span> dump/executable.i384.exe</pre></td></tr></table></figure><p>PEB 会保存 PEB 信息</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>vol.py <span class="token parameter variable">-f</span> memory <span class="token parameter variable">--profile</span><span class="token operator">=</span>Win7SPx86 cmdline</pre></td></tr></table></figure><p>是命令行信息</p>
<p>sockets</p>
<p>hivelist, hivescan 是注册表</p>
<p>hashdump 获取用户密码的 hash， mimikatz 插件可以还原 hash</p>
<h4 id="volatitlity-3"><a class="anchor" href="#volatitlity-3">#</a> volatitlity 3</h4>
<p>确定信息</p>
<figure class="highlight shell"><figcaption data-lang="Bash"><span>l</span></figcaption><table><tr><td data-num="1"></td><td><pre>vol <span class="token parameter variable">-f</span> x.mem windows.info</pre></td></tr></table></figure><h3 id="磁盘取证"><a class="anchor" href="#磁盘取证">#</a> 磁盘取证</h3>
<h4 id="文件系统"><a class="anchor" href="#文件系统">#</a> 文件系统</h4>
<p>windows: FAT16, FAT32, NTFS</p>
<p>Linux: Ext2, Ext3, Ext4</p>
<h4 id="fat1632"><a class="anchor" href="#fat1632">#</a> Fat16/32</h4>
<p>16bit 来表示一个簇</p>
<p>DBR 扇区</p>
<p><img src="/CTF%E7%9F%A5%E8%AF%86%E7%82%B9/image-20240819191436093.png" alt="image-20240819191436093"></p>
<h4 id="ntfs"><a class="anchor" href="#ntfs">#</a> NTFS</h4>
<p>性能优秀，安全性高，可恢复性，文件压缩</p>
<h1 id="osint"><a class="anchor" href="#osint">#</a> OSINT</h1>
<p>时光机 web archive</p>
<h1 id="区块链blockchain"><a class="anchor" href="#区块链blockchain">#</a> 区块链 blockchain</h1>
<p>IDE：REMIX</p>
<h4 id="windows-安装nc"><a class="anchor" href="#windows-安装nc">#</a> windows 安装 nc</h4>
<p>去 nmap 官网下载就行</p>
<h3 id="msgsender"><a class="anchor" href="#msgsender">#</a> msg.sender</h3>
<p>当一个外部账户（例如，用户的钱包地址）调用合约中的函数时， <code>msg.sender</code>  会是该外部账户的地址。</p>
<p>如果一个合约调用另一个合约的函数，那么  <code>msg.sender</code>  将是调用方合约的地址，而不是最终的外部账户。</p>
<p>例如，如果合约 A 调用合约 B 的函数，合约 B 中的  <code>msg.sender</code>  会是合约 A 的地址，而不是最初发起调用的外部账户。</p>
<p>当一个函数从合约内部调用另一个合约的函数时， <code>msg.sender</code>  仍然是直接发起调用的那个地址。如果函数调用链中有多个合约调用， <code>msg.sender</code>  始终代表的是当前执行上下文中的调用者。</p>
<h3 id="storage-2"><a class="anchor" href="#storage-2">#</a> storage</h3>
<p>在 Solidity 中， <code>storage</code>  是用于存储智能合约中状态变量的数据位置。它是智能合约中非常重要的一部分，用来持久化存储数据，也就是存储在以太坊区块链上的数据。与其他数据存储位置（如  <code>memory</code>  和  <code>stack</code> ）不同， <code>storage</code>  中的数据是持久的，意味着它们在交易执行后会一直存在，直到被更新或删除。每个合约都有自己的  <code>storage</code>  空间。</p>
<h4 id="1-storage-的特点"><a class="anchor" href="#1-storage-的特点">#</a> 1. <strong> <code>storage</code>  的特点</strong></h4>
<ul>
<li><strong>持久性</strong>： <code>storage</code>  中的数据在合约的生命周期内是持久的，意味着它们会被保存在区块链中。即使合约函数执行完成后，数据仍然保留，并且在下一次函数调用时可以访问。</li>
<li><strong>费用</strong>：在 Solidity 中，将数据写入  <code>storage</code>  是昂贵的操作，因为这需要改变区块链状态并消耗  <code>gas</code> 。相对而言，从  <code>storage</code>  中读取数据的费用要比写入便宜一些。</li>
<li><strong>每个合约的  <code>storage</code>  空间独立</strong>：每个智能合约都有自己的  <code>storage</code>  空间，且  <code>storage</code>  中的数据可以通过合约的状态变量来访问</li>
</ul>
<h4 id="slot"><a class="anchor" href="#slot">#</a> slot</h4>
<p>Solidity 会将每个状态变量存储在固定的槽（slot）中。每个状态变量占据一定的存储槽，状态变量的存储位置由其在合约中声明的顺序决定。这些槽位在区块链上是固定的</p>
<h3 id="合约交互python"><a class="anchor" href="#合约交互python">#</a> 合约交互 python</h3>
<p>先要安装 solc, 然后 pip 安装 <code>web3</code> , <code>py-solc-x</code>  下面是基本配置</p>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre>w3 <span class="token operator">=</span> Web3<span class="token punctuation">(</span>Web3<span class="token punctuation">.</span>HTTPProvider<span class="token punctuation">(</span><span class="token string">'http://94.237.59.45:52415'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">create_abi</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    temp_file <span class="token operator">=</span> solcx<span class="token punctuation">.</span>compile_files<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>name<span class="token punctuation">&#125;</span></span><span class="token string">.sol'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    abi <span class="token operator">=</span> temp_file<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>name<span class="token punctuation">&#125;</span></span><span class="token string">.sol:</span><span class="token interpolation"><span class="token punctuation">&#123;</span>name<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'abi'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> abi</pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>setup_abi <span class="token operator">=</span> create_abi<span class="token punctuation">(</span><span class="token string">'Setup'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>fNFT_abi <span class="token operator">=</span> create_abi<span class="token punctuation">(</span><span class="token string">'FrontierNFT'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>fMarket_abi <span class="token operator">=</span> create_abi<span class="token punctuation">(</span><span class="token string">'FrontierMarketplace'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">if</span> w3<span class="token punctuation">.</span>is_connected<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Connected to Ethereum network"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Failed to connect"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>private_key <span class="token operator">=</span> <span class="token string">"1249bb2c45202146bbe401b6b29848c5f0345e418434eeedaade8dd8bdbb437a"</span></pre></td></tr><tr><td data-num="19"></td><td><pre>my_address <span class="token operator">=</span> <span class="token string">"0x41b34Fe0b213FF5300D648F875F84B0F016295cc"</span></pre></td></tr><tr><td data-num="20"></td><td><pre>fmarket_address <span class="token operator">=</span> <span class="token string">"0x899c356B0489472c99EF4A46b3893B62Fd73F349"</span></pre></td></tr><tr><td data-num="21"></td><td><pre>setup_address <span class="token operator">=</span> <span class="token string">"0xD984cF86bfEbb01E62f0729c2Dd5562a852038f4"</span></pre></td></tr></table></figure><h4 id="调用函数"><a class="anchor" href="#调用函数">#</a> 调用函数</h4>
<p>不创建新节点</p>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre>setup <span class="token operator">=</span> w3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>contract<span class="token punctuation">(</span>address<span class="token operator">=</span>setup_address<span class="token punctuation">,</span> abi<span class="token operator">=</span>setup_abi<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>setup<span class="token punctuation">.</span>functions<span class="token punctuation">.</span>isSolved<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>setup<span class="token punctuation">.</span>functions<span class="token punctuation">.</span>paramfunc<span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 有参数的写法</span></pre></td></tr></table></figure><p>读取值，可以把值当成函数</p>
<h4 id="查询block-chain"><a class="anchor" href="#查询block-chain">#</a> 查询 block chain</h4>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre>latest_block <span class="token operator">=</span> w3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>get_block<span class="token punctuation">(</span><span class="token string">'latest'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># block_number = 10000000  #</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># latest_block = w3.eth.get_block(0)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># print(block['number']) </span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Latest Block Info:"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Block Number: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>latest_block<span class="token punctuation">[</span><span class="token string">'number'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Block Hash: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>latest_block<span class="token punctuation">[</span><span class="token string">'hash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Parent Hash: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>latest_block<span class="token punctuation">[</span><span class="token string">'parentHash'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Timestamp: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>latest_block<span class="token punctuation">[</span><span class="token string">'timestamp'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Miner: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>latest_block<span class="token punctuation">[</span><span class="token string">'miner'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Gas Used: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>latest_block<span class="token punctuation">[</span><span class="token string">'gasUsed'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Gas Limit: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>latest_block<span class="token punctuation">[</span><span class="token string">'gasLimit'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Transactions Count: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">len</span><span class="token punctuation">(</span>latest_block<span class="token punctuation">[</span><span class="token string">'transactions'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr></table></figure><h5 id="查询balance"><a class="anchor" href="#查询balance">#</a> 查询 balance</h5>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 查询该地址的余额（返回值是以 wei 为单位）</span></pre></td></tr><tr><td data-num="2"></td><td><pre>balance_wei <span class="token operator">=</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>get_balance<span class="token punctuation">(</span>address<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 将 wei 转换为 ether</span></pre></td></tr><tr><td data-num="4"></td><td><pre>balance_ether <span class="token operator">=</span> web3<span class="token punctuation">.</span>from_wei<span class="token punctuation">(</span>balance_wei<span class="token punctuation">,</span> <span class="token string">'ether'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="查询transactions"><a class="anchor" href="#查询transactions">#</a> 查询 transactions</h4>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 查询某个区块范围内的交易</span></pre></td></tr><tr><td data-num="2"></td><td><pre>block_start <span class="token operator">=</span> <span class="token number">10000000</span>  <span class="token comment"># 起始区块</span></pre></td></tr><tr><td data-num="3"></td><td><pre>block_end <span class="token operator">=</span> <span class="token number">10001000</span>    <span class="token comment"># 结束区块</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 获取区块范围内的交易</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">for</span> block_number <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>block_start<span class="token punctuation">,</span> block_end <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    block <span class="token operator">=</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>getBlock<span class="token punctuation">(</span>block_number<span class="token punctuation">,</span> full_transactions<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token comment"># 遍历区块中的所有交易</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">for</span> tx <span class="token keyword">in</span> block<span class="token punctuation">.</span>transactions<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token comment"># 如果交易是发送到合约地址</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token keyword">if</span> tx<span class="token punctuation">.</span>to <span class="token operator">==</span> contract_address<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            <span class="token comment"># 解析交易的 input 数据，检查是否是函数调用</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            input_data <span class="token operator">=</span> tx<span class="token punctuation">.</span><span class="token builtin">input</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Transaction Hash: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>tx<span class="token punctuation">.</span><span class="token builtin">hash</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>            <span class="token comment"># 使用 ABI 来解码交易数据</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            decoded_input <span class="token operator">=</span> contract<span class="token punctuation">.</span>decode_function_input<span class="token punctuation">(</span>input_data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            function_name <span class="token operator">=</span> decoded_input<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fn<span class="token punctuation">.</span>__name__</pre></td></tr><tr><td data-num="20"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Called function: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>function_name<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Function Arguments: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>decoded_input<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>            </pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token comment"># 遍历</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">for</span> tx_hash <span class="token keyword">in</span> latest_block<span class="token punctuation">[</span><span class="token string">'transactions'</span><span class="token punctuation">]</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    tx <span class="token operator">=</span> w3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>get_transaction<span class="token punctuation">(</span>tx_hash<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"from: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>tx<span class="token punctuation">[</span><span class="token string">'from'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token comment"># </span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">if</span> tx<span class="token punctuation">[</span><span class="token string">'to'</span><span class="token punctuation">]</span> <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Transaction </span><span class="token interpolation"><span class="token punctuation">&#123;</span>tx_hash<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string"> is a contract deployment."</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Transaction </span><span class="token interpolation"><span class="token punctuation">&#123;</span>tx_hash<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string"> is a contract function call to </span><span class="token interpolation"><span class="token punctuation">&#123;</span>tx<span class="token punctuation">[</span><span class="token string">'to'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">."</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token comment"># </span></pre></td></tr><tr><td data-num="35"></td><td><pre>    receipt <span class="token operator">=</span> w3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>get_transaction_receipt<span class="token punctuation">(</span>tx_hash<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token comment"># </span></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token keyword">if</span> receipt<span class="token punctuation">[</span><span class="token string">'contractAddress'</span><span class="token punctuation">]</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="39"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Contract deployed at address </span><span class="token interpolation"><span class="token punctuation">&#123;</span>receipt<span class="token punctuation">[</span><span class="token string">'contractAddress'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"No contract deployed in this transaction."</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token comment"># print(f"Transaction Input Data: &#123;tx['input']&#125;")</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    </pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token comment"># decoded_input = setup.decode_function_input(tx['input'])</span></pre></td></tr></table></figure><h5 id="交易信息"><a class="anchor" href="#交易信息">#</a> 交易信息</h5>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 打印交易的详细信息</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">for</span> tx_hash <span class="token keyword">in</span> transactions<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    transaction <span class="token operator">=</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>get_transaction<span class="token punctuation">(</span>tx_hash<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Transaction Hash: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>tx_hash<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"From: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>transaction<span class="token punctuation">[</span><span class="token string">'from'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"To: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>transaction<span class="token punctuation">[</span><span class="token string">'to'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Value: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>web3<span class="token punctuation">.</span>fromWei<span class="token punctuation">(</span>transaction<span class="token punctuation">[</span><span class="token string">'value'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'ether'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string"> ETH"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Gas: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>transaction<span class="token punctuation">[</span><span class="token string">'gas'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Gas Price: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>web3<span class="token punctuation">.</span>fromWei<span class="token punctuation">(</span>transaction<span class="token punctuation">[</span><span class="token string">'gasPrice'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'gwei'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string"> Gwei"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">40</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="查询事件"><a class="anchor" href="#查询事件">#</a> 查询事件</h4>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre>event_filter <span class="token operator">=</span> setup<span class="token punctuation">.</span>events<span class="token punctuation">.</span>DeployedTarget<span class="token punctuation">.</span>create_filter<span class="token punctuation">(</span>from_block<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> to_block<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">#DeployedTarget 是函数名字</span></pre></td></tr><tr><td data-num="2"></td><td><pre>events <span class="token operator">=</span> event_filter<span class="token punctuation">.</span>get_all_entries<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># print event</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">for</span> event <span class="token keyword">in</span> events<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Event: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>event<span class="token punctuation">.</span>event<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Arguments: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>event<span class="token punctuation">.</span>args<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="发送transaction"><a class="anchor" href="#发送transaction">#</a> 发送 transaction</h4>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># send transactions</span></pre></td></tr><tr><td data-num="2"></td><td><pre>tx <span class="token operator">=</span> forgotten<span class="token punctuation">.</span>functions<span class="token punctuation">.</span>discover<span class="token punctuation">(</span>hashed<span class="token punctuation">)</span><span class="token punctuation">.</span>build_transaction<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token string">'from'</span><span class="token punctuation">:</span> my_address<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token string">"gasPrice"</span><span class="token punctuation">:</span> w3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>gas_price<span class="token punctuation">,</span>  <span class="token comment"># two ******* hours it took to figure out this was needed.</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token string">'nonce'</span><span class="token punctuation">:</span> w3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>get_transaction_count<span class="token punctuation">(</span><span class="token string">"0xEB4B81DE5738a22d24631ABD62f62cEECC268e71"</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment"># needs to be signed as we are executing/writing not just reading</span></pre></td></tr><tr><td data-num="11"></td><td><pre>tx_create <span class="token operator">=</span> w3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>account<span class="token punctuation">.</span>sign_transaction<span class="token punctuation">(</span>tx<span class="token punctuation">,</span> private_key<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>tx_hash <span class="token operator">=</span> w3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>send_raw_transaction<span class="token punctuation">(</span>tx_create<span class="token punctuation">.</span>raw_transaction<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>tx_receipt <span class="token operator">=</span> w3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span>wait_for_transaction_receipt<span class="token punctuation">(</span>tx_hash<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'Tx successful with hash: </span><span class="token interpolation"><span class="token punctuation">&#123;</span> tx_receipt<span class="token punctuation">.</span>transactionHash<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="计算keccak哈希"><a class="anchor" href="#计算keccak哈希">#</a> 计算 keccak 哈希</h4>
<figure class="highlight python"><figcaption data-lang="python"><span>n</span></figcaption><table><tr><td data-num="1"></td><td><pre>hashed <span class="token operator">=</span> w3<span class="token punctuation">.</span>solidity_keccak<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token punctuation">[</span><span class="token string">'uint256'</span><span class="token punctuation">,</span> <span class="token string">'uint256'</span><span class="token punctuation">,</span> <span class="token string">'address'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1734258030</span><span class="token punctuation">,</span> <span class="token string">"0x3E698Aba19B29C3fB625966A9631e6cf5C79505e"</span><span class="token punctuation">]</span>  </pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Keccak256 Hash: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>hashed<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="hack-思维"><a class="anchor" href="#hack-思维">#</a> Hack 思维</h2>
<h3 id="数据范围"><a class="anchor" href="#数据范围">#</a> 数据范围</h3>
<p>输入不合法数据范围</p>
</div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i></span><span class="text">Edited on </span><time title="Modified: 2025-02-03 23:27:14" itemprop="dateModified" datetime="2025-02-03T23:27:14+01:00">2025-02-03</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i>Donate</button><p>Give me a cup of [coffee]~(￣▽￣)~*</p><div id="qr"><div><img loading="lazy" data-src="/assets/wechatpay.png" alt="John Doe WeChat Pay"/><p>WeChat Pay</p></div><div><img loading="lazy" data-src="/assets/alipay.png" alt="John Doe Alipay"/><p>Alipay</p></div></div></div><div id="copyright"><ul><li class="author"><strong>Post author: </strong>John Doe<i class="ic i-at"><em>@</em></i>Hexo</li><li class="link"><strong>Post link: </strong><a href="https://cr4zyp1x3l.netlify.app/CTF%E7%9F%A5%E8%AF%86%E7%82%B9/" title="CTF知识点">https://cr4zyp1x3l.netlify.app/CTF知识点/</a></li><li class="license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> unless stating additionally.</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"></div><div class="item right"><a href="/x3ctf2025%20Write%20Up/" rel="next" itemprop="url" data-background-image="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gicit4jrvuj20zk0m8785.jpg" title="x3ctf2025 Write Up"><span class="type">Next Post</span><h3>x3ctf2025 Write Up</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="Contents"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">1.</span> <span class="toc-text"> 知识点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0%E7%BD%91%E7%AB%99"><span class="toc-number">2.</span> <span class="toc-text"> 练习网站</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="toc-number">3.</span> <span class="toc-text"> 虚拟机</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6"><span class="toc-number"></span> <span class="toc-text"> 文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text"> 图片文件处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#hexdump"><span class="toc-number">1.1.</span> <span class="toc-text"> hexdump</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#binwalk"><span class="toc-number">2.</span> <span class="toc-text"> binwalk</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#stegehide"><span class="toc-number">2.1.</span> <span class="toc-text"> stegehide</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E7%BB%B4%E7%A0%81"><span class="toc-number">3.</span> <span class="toc-text"> 二维码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#python"><span class="toc-number"></span> <span class="toc-text"> python</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#string"><span class="toc-number">1.</span> <span class="toc-text"> string</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%90%E5%8F%96flag"><span class="toc-number">2.</span> <span class="toc-text"> 提取 flag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#crypto"><span class="toc-number">3.</span> <span class="toc-text"> Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E4%B8%A4%E4%B8%AAbyte%E7%9A%84xor"><span class="toc-number">3.1.</span> <span class="toc-text"> 计算两个 byte 的 xor</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urlencode"><span class="toc-number">4.</span> <span class="toc-text"> urlencode</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#git"><span class="toc-number"></span> <span class="toc-text"> Git</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#linux"><span class="toc-number"></span> <span class="toc-text"> Linux</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%8E%8B"><span class="toc-number">0.1.</span> <span class="toc-text"> 解压</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8Bls"><span class="toc-number">1.</span> <span class="toc-text"> 查看 ls</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E5%AD%A6"><span class="toc-number"></span> <span class="toc-text"> 密码学</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E8%BF%9B%E5%88%B6%E5%88%B0hex"><span class="toc-number">1.</span> <span class="toc-text"> 2 进制到 hex</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#hex%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.1.</span> <span class="toc-text"> hex 转换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%85%A5bytes"><span class="toc-number">1.2.</span> <span class="toc-text"> 输入 bytes</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E6%8D%A2%E5%AD%97%E7%AC%A6%E6%95%B0%E7%BB%84"><span class="toc-number">1.3.</span> <span class="toc-text"> 字符串转换字符数组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2%E5%A4%A7%E5%B0%8F%E5%86%99"><span class="toc-number">1.4.</span> <span class="toc-text"> 交换大小写</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#base64"><span class="toc-number">2.</span> <span class="toc-text"> base64</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#dtmf-%E5%A3%B0%E8%B0%83"><span class="toc-number">2.1.</span> <span class="toc-text"> DTMF 声调</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E5%90%8C%E7%A7%8D%E7%B1%BB%E7%9A%84%E5%AF%86%E7%A0%81"><span class="toc-number"></span> <span class="toc-text"> 不同种类的密码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#vigenere-cipher"><span class="toc-number">0.1.</span> <span class="toc-text"> Vigenere Cipher</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#caesar-cipher"><span class="toc-number">0.2.</span> <span class="toc-text"> CAESAR Cipher</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#keyboard-shift"><span class="toc-number">0.3.</span> <span class="toc-text"> keyboard shift</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bacon-cipher"><span class="toc-number">0.4.</span> <span class="toc-text"> bacon cipher</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8E%E4%BD%9B%E8%AE%BA%E7%A6%85"><span class="toc-number">0.5.</span> <span class="toc-text"> 与佛论禅</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rot13"><span class="toc-number">0.6.</span> <span class="toc-text"> rot13</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#enigma-cryptogarphy"><span class="toc-number">1.</span> <span class="toc-text"> enigma cryptogarphy</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#playfair-cipher"><span class="toc-number">1.1.</span> <span class="toc-text"> Playfair cipher</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#brute-force"><span class="toc-number">2.</span> <span class="toc-text"> brute force</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sha1"><span class="toc-number">2.1.</span> <span class="toc-text"> sha1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#md5"><span class="toc-number">2.2.</span> <span class="toc-text"> Md5</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#discrete-logarithm"><span class="toc-number">3.</span> <span class="toc-text"> Discrete logarithm</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web"><span class="toc-number"></span> <span class="toc-text"> Web</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">0.1.</span> <span class="toc-text"> 信息收集</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sql-%E6%B3%A8%E5%85%A5"><span class="toc-number">1.</span> <span class="toc-text"> SQL 注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">1.1.</span> <span class="toc-text"> 数字型注入</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn"><span class="toc-number"></span> <span class="toc-text"> PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#pwn-tool"><span class="toc-number">0.1.</span> <span class="toc-text"> pwn tool</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#recv"><span class="toc-number">0.2.</span> <span class="toc-text"> recv</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#send"><span class="toc-number">0.3.</span> <span class="toc-text"> send</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5"><span class="toc-number">0.4.</span> <span class="toc-text"> 连接</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#post-request"><span class="toc-number">1.</span> <span class="toc-text"> Post Request</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#curl"><span class="toc-number">1.1.</span> <span class="toc-text"> curl</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#burpsuite"><span class="toc-number">2.</span> <span class="toc-text"> Burpsuite</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#header"><span class="toc-number">2.1.</span> <span class="toc-text"> header</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#referer"><span class="toc-number">2.2.</span> <span class="toc-text"> referer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#python%E6%8F%92%E4%BB%B6"><span class="toc-number">2.3.</span> <span class="toc-text"> python 插件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E8%80%85%E5%B7%A5%E5%85%B7"><span class="toc-number">3.</span> <span class="toc-text"> 开发者工具</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#storage"><span class="toc-number">3.1.</span> <span class="toc-text"> Storage</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%AB%99"><span class="toc-number"></span> <span class="toc-text"> 网站</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#robotstxt"><span class="toc-number">1.</span> <span class="toc-text">  robots.txt</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#wikipedia"><span class="toc-number">1.1.</span> <span class="toc-text"> wikipedia</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6%E5%90%8D"><span class="toc-number">1.2.</span> <span class="toc-text"> 备份文件名</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dirsearch"><span class="toc-number">2.</span> <span class="toc-text"> dirsearch</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E7%BD%91%E9%A1%B5%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-number">2.1.</span> <span class="toc-text"> 更改网页源代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE%E7%BD%91%E7%AB%99%E7%9A%84%E9%9A%90%E8%97%8F%E8%BF%9E%E6%8E%A5"><span class="toc-number">2.2.</span> <span class="toc-text"> 查找网站的隐藏连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gobuster"><span class="toc-number">2.3.</span> <span class="toc-text"> gobuster</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE%E5%8E%86%E5%8F%B2%E7%BD%91%E9%A1%B5%E7%8A%B6%E6%80%81"><span class="toc-number">2.4.</span> <span class="toc-text"> 查找历史网页状态</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php"><span class="toc-number"></span> <span class="toc-text"> PHP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E7%9B%B8%E7%AD%89"><span class="toc-number">0.1.</span> <span class="toc-text"> 判断相等</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">0.2.</span> <span class="toc-text"> 反序列化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#think-php-rce"><span class="toc-number">0.3.</span> <span class="toc-text"> THINK PHP RCE</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.</span> <span class="toc-text"> 文件上传</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#misc"><span class="toc-number"></span> <span class="toc-text"> misc</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8%E7%BA%BF%E5%B7%A5%E5%85%B7"><span class="toc-number">0.1.</span> <span class="toc-text"> 在线工具</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%90%E5%86%99%E6%9C%AF"><span class="toc-number">1.</span> <span class="toc-text"> 隐写术</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E9%99%84%E5%8A%A0"><span class="toc-number">1.1.</span> <span class="toc-text"> 文件附加</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#png"><span class="toc-number">1.2.</span> <span class="toc-text"> PNG</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#jpeg"><span class="toc-number">1.3.</span> <span class="toc-text"> JPEG</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gif"><span class="toc-number">1.4.</span> <span class="toc-text"> GIF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#zip"><span class="toc-number">1.5.</span> <span class="toc-text"> ZIP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rar"><span class="toc-number">1.6.</span> <span class="toc-text"> RAR</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#wave"><span class="toc-number">1.7.</span> <span class="toc-text"> WAVE</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#avi"><span class="toc-number">1.8.</span> <span class="toc-text"> AVI</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lsb"><span class="toc-number">2.</span> <span class="toc-text"> LSB</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%90%E5%86%99%E6%80%9D%E8%B7%AF"><span class="toc-number">2.1.</span> <span class="toc-text"> 隐写思路</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B2%E6%B0%B4%E5%8D%B0"><span class="toc-number">3.</span> <span class="toc-text"> 盲水印</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%8E%B0%E6%88%90%E7%9A%84%E9%9A%90%E5%86%99%E5%B7%A5%E5%85%B7"><span class="toc-number">3.1.</span> <span class="toc-text"> 现成的隐写工具</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%8B%E7%BC%A9%E6%96%87%E4%BB%B6"><span class="toc-number">4.</span> <span class="toc-text"> 压缩文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#zip-%E6%96%87%E4%BB%B6"><span class="toc-number">4.1.</span> <span class="toc-text"> ZIP 文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pdf-%E6%96%87%E4%BB%B6"><span class="toc-number">4.2.</span> <span class="toc-text"> PDF 文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rar-%E6%96%87%E4%BB%B6"><span class="toc-number">4.3.</span> <span class="toc-text"> RAR 文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E5%B7%A5%E5%85%B7"><span class="toc-number">4.4.</span> <span class="toc-text"> 暴力破解工具</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%AA%E5%8A%A0%E5%AF%86"><span class="toc-number">4.5.</span> <span class="toc-text"> 伪加密</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#zip-%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB"><span class="toc-number">4.6.</span> <span class="toc-text"> ZIP 明文攻击</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99"><span class="toc-number">5.</span> <span class="toc-text"> 音频隐写</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7"><span class="toc-number">5.1.</span> <span class="toc-text"> 工具</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="toc-number">6.</span> <span class="toc-text"> 流量分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#http"><span class="toc-number">6.1.</span> <span class="toc-text"> HTTP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#https"><span class="toc-number">6.2.</span> <span class="toc-text"> HTTPS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ftp"><span class="toc-number">6.3.</span> <span class="toc-text"> FTP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dns"><span class="toc-number">6.4.</span> <span class="toc-text"> DNS</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#usb%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="toc-number">7.</span> <span class="toc-text"> USB 流量分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wireshark"><span class="toc-number">8.</span> <span class="toc-text"> wireshark</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81"><span class="toc-number">9.</span> <span class="toc-text"> 内存取证</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#volatility"><span class="toc-number">9.1.</span> <span class="toc-text"> volatility</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E4%BF%A1%E6%81%AF"><span class="toc-number">9.2.</span> <span class="toc-text"> 确定信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#volatitlity-3"><span class="toc-number">9.3.</span> <span class="toc-text"> volatitlity 3</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E5%8F%96%E8%AF%81"><span class="toc-number">10.</span> <span class="toc-text"> 磁盘取证</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">10.1.</span> <span class="toc-text"> 文件系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fat1632"><span class="toc-number">10.2.</span> <span class="toc-text"> Fat16&#x2F;32</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ntfs"><span class="toc-number">10.3.</span> <span class="toc-text"> NTFS</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#osint"><span class="toc-number"></span> <span class="toc-text"> OSINT</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8C%BA%E5%9D%97%E9%93%BEblockchain"><span class="toc-number"></span> <span class="toc-text"> 区块链 blockchain</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#windows-%E5%AE%89%E8%A3%85nc"><span class="toc-number">0.1.</span> <span class="toc-text"> windows 安装 nc</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#msgsender"><span class="toc-number">1.</span> <span class="toc-text"> msg.sender</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#storage-2"><span class="toc-number">2.</span> <span class="toc-text"> storage</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-storage-%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-number">2.1.</span> <span class="toc-text"> 1.  storage  的特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#slot"><span class="toc-number">2.2.</span> <span class="toc-text"> slot</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%88%E7%BA%A6%E4%BA%A4%E4%BA%92python"><span class="toc-number">3.</span> <span class="toc-text"> 合约交互 python</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.</span> <span class="toc-text"> 调用函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2block-chain"><span class="toc-number">3.2.</span> <span class="toc-text"> 查询 block chain</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2balance"><span class="toc-number">3.2.1.</span> <span class="toc-text"> 查询 balance</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2transactions"><span class="toc-number">3.3.</span> <span class="toc-text"> 查询 transactions</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%A4%E6%98%93%E4%BF%A1%E6%81%AF"><span class="toc-number">3.3.1.</span> <span class="toc-text"> 交易信息</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E4%BA%8B%E4%BB%B6"><span class="toc-number">3.4.</span> <span class="toc-text"> 查询事件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E9%80%81transaction"><span class="toc-number">3.5.</span> <span class="toc-text"> 发送 transaction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97keccak%E5%93%88%E5%B8%8C"><span class="toc-number">3.6.</span> <span class="toc-text"> 计算 keccak 哈希</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hack-%E6%80%9D%E7%BB%B4"><span class="toc-number"></span> <span class="toc-text"> Hack 思维</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%8C%83%E5%9B%B4"><span class="toc-number">1.</span> <span class="toc-text"> 数据范围</span></a></li></ol></div><div class="related panel pjax" data-title="Related"></div><div class="overview panel" data-title="Overview"><div class="author" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><img class="image" loading="lazy" decoding="async" itemprop="image" alt="John Doe" src="/assets/avatar.jpg"/><p class="name" itemprop="name">John Doe</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">5</span><span class="name">posts</span></a></div><div class="item tags"><a href="/tags/"><span class="count">1</span><span class="name">tags</span></a></div></nav><div class="social"><a target="_blank" rel="noopener" href="https://github.com/yourname" class="item github" title="https:&#x2F;&#x2F;github.com&#x2F;yourname"><i class="ic i-github"></i></a></div><div class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>Home</a></li></div></div></div></div><ul id="quick"><li class="prev pjax"><a href="/x3ctf2025%20Write%20Up/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>Random Posts</h2><ul><li class="item"><div class="breadcrumb"></div><span><a href="/%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E4%B8%8E%E7%A2%B0%E6%92%9E%E6%83%85%E5%86%B5/">哈希长度与碰撞情况</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/x3ctf2025%20Write%20Up/">x3ctf2025 Write Up</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/CTF%E7%9F%A5%E8%AF%86%E7%82%B9/">CTF知识点</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/hello-world/">Hello World</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/">逆向工程</a></span></li></ul></div><div class="rpost pjax"><h2>Recent Comments</h2></div></div><div class="status"><div class="copyright">&copy; 2022 -<span itemprop="copyrightYear">2025</span><span class="with-love"><i class="ic i-sakura rotate"></i></span><span class="author" itemprop="copyrightHolder">John Doe @ testName</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i></span><span title="Symbols count total">49k words</span><span class="post-meta-divider"> | </span><span class="post-meta-item-icon"><i class="ic i-coffee"></i></span><span title="Reading time total">44 mins.</span></div><div class="powered-by">Powered by <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> & Theme.<a target="_blank" rel="noopener" href="https://github.com/theme-shoka-x/hexo-theme-shokaX/">ShokaX</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL = {
    ispost: true,
    path: `CTF知识点/`,
    favicon: {
        show: `(●´3｀●) Here we go again.`,
        hide: `(´Д｀) It's a disaster!`
    },
    search: {
        placeholder: "Search for Posts",
        empty: "We didn't find any results for the search: ${query}",
        stats: "${hits} results found in ${time} ms"
    },
    nocopy: "false",
    copyright: `Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.`,
    copy_tex: false,
    katex: false,
    mermaid: false,
    audio: undefined,
    fancybox: true,
    nocopy: false,
    outime: true,
    template: `<div class="note warning"><p><span class="label warning">Article Timeliness Alert</span><br>This is an article published {{publish}} days ago and last updated {{updated}} days ago. Some information may have changed, so please be careful to screen it.</p></div>`,
    quiz: {
        choice: `Multiple Choice`,
        multiple: `Multiple Answer`,
        true_false: `True/False`,
        essay: `Questions`,
        gap_fill: `Gap Filling`,
        mistake: `Wrong Answer`
    },
    ignores: [
        (uri) => uri.includes('#'),
        (uri) => new RegExp(LOCAL.path + '$').test(uri),
            []
    ]
};
</script><script src="https://s4.zstatic.net/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous" fetchpriority="high"></script><script src="https://s4.zstatic.net/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha384-ZvpUoO&#x2F;+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn&#x2F;6Z&#x2F;hRTt8+pR6L4N2" crossorigin="anonymous" fetchpriority="high"></script><script src="https://s4.zstatic.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha384-Zm+UU4tdcfAm29vg+MTbfu&#x2F;&#x2F;q5B&#x2F;lInMbMCr4T8c9rQFyOv6PlfQYpB5wItcXWe7" crossorigin="anonymous" fetchpriority="high"></script><script src="https://s4.zstatic.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" integrity="sha384-TOxsBplaL96&#x2F;QDWPIUg+ye3v89qSE3s22XNtJMmCeZEep3cVDmXy1zEfZvVv+y2m" crossorigin="anonymous" fetchpriority="high"></script><script src="/js/siteInit.js?v=0.4.20" type="module" fetchpriority="high" defer></script></body></html>